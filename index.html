<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, maximum-scale=5.0">
    <title>Mystic Divination - Tarot • Numerology • Moonology • Kali Oracle</title>
    <style>
        /* Reset & Base */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(to bottom, #f5f7fa 0%, #e8f0f7 100%);
            color: #333;
            min-height: 100vh;
            padding-bottom: 100px;
        }
        
        /* Header */
        .app-header {
            background: linear-gradient(135deg, #FF9933 0%, #cc7722 100%);
            color: white;
            padding: 20px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .app-header h1 {
            font-size: 24px;
            font-weight: 600;
            margin: 0;
        }
        
        .app-header p {
            font-size: 14px;
            opacity: 0.9;
            margin-top: 5px;
        }
        
        /* Moonology Styles */
        .moonology-card {
            background: linear-gradient(135deg, #1a202c 0%, #2d3748 100%);
            border-radius: 20px;
            padding: 32px;
            text-align: center;
            color: white;
            box-shadow: 0 8px 25px rgba(26, 32, 44, 0.4);
            margin: 20px auto;
            max-width: 300px;
            border: 2px solid #4299e1;
        }
        
        .moonology-card .symbol {
            font-size: 80px;
            margin: 20px 0;
        }
        
        .moonology-card .name {
            font-size: 24px;
            font-weight: 600;
            margin: 16px 0;
            color: #90cdf4;
        }
        
        .moonology-card .phase {
            font-size: 14px;
            opacity: 0.8;
            margin-bottom: 12px;
            color: #a0aec0;
        }
        
        .moonology-card .meaning {
            font-size: 16px;
            line-height: 1.6;
            opacity: 0.9;
            margin: 16px 0;
        }
        
        .moonology-card .guidance {
            font-size: 15px;
            line-height: 1.5;
            color: #bee3f8;
            font-style: italic;
        }
        
        /* Container */
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* Navigation Tabs */
        .nav-tabs {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            display: flex;
            justify-content: space-around;
            padding: 8px 0;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
            z-index: 1000;
        }
        
        .nav-tab {
            flex: 1;
            text-align: center;
            padding: 8px;
            background: none;
            border: none;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 11px;
            color: #666;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
        }
        
        .nav-tab .icon {
            font-size: 24px;
        }
        
        .nav-tab.active {
            color: #FF9933;
        }
        
        .nav-tab.active .icon {
            transform: scale(1.1);
        }
        
        /* Sections */
        .section {
            display: none;
            animation: fadeIn 0.3s;
        }
        
        .section.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Cards */
        .card {
            background: white;
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }
        
        .card h2 {
            color: #FF9933;
            font-size: 20px;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .card h3 {
            color: #000080;
            font-size: 18px;
            margin-bottom: 12px;
        }
        
        /* Form Elements */
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #555;
            font-size: 14px;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.3s;
            font-family: inherit;
        }
        
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #FF9933;
            box-shadow: 0 0 0 3px rgba(255, 153, 51, 0.1);
        }
        
        /* Buttons */
        .btn {
            background: linear-gradient(135deg, #FF9933 0%, #cc7722 100%);
            color: white;
            border: none;
            padding: 16px 32px;
            font-size: 16px;
            font-weight: 600;
            border-radius: 12px;
            cursor: pointer;
            width: 100%;
            transition: all 0.3s;
            box-shadow: 0 4px 12px rgba(255, 153, 51, 0.3);
        }
        
        .btn:active {
            transform: scale(0.98);
            box-shadow: 0 2px 8px rgba(255, 153, 51, 0.3);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #000080 0%, #000060 100%);
            box-shadow: 0 4px 12px rgba(0, 0, 128, 0.3);
        }
        
        .btn-outline {
            background: white;
            color: #FF9933;
            border: 2px solid #FF9933;
            box-shadow: none;
        }
        
        .btn-group {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }
        
        .btn-group .btn {
            flex: 1;
            min-width: 140px;
        }
        
        /* Info Box */
        .info-box {
            background: linear-gradient(135deg, #FFF5E6 0%, #FFE8CC 100%);
            border-left: 4px solid #FFD700;
            padding: 16px;
            border-radius: 8px;
            margin: 16px 0;
        }
        
        .info-box p {
            margin: 8px 0;
            line-height: 1.6;
        }
        
        .info-box strong {
            color: #000080;
        }
        
        /* Result Display */
        .result-item {
            padding: 12px 0;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .result-item:last-child {
            border-bottom: none;
        }
        
        .result-label {
            font-weight: 600;
            color: #666;
            font-size: 14px;
            margin-bottom: 4px;
        }
        
        .result-value {
            font-size: 18px;
            color: #333;
            font-weight: 500;
        }
        
        /* Tarot Card */
        .tarot-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            padding: 32px;
            text-align: center;
            color: white;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
            margin: 20px auto;
            max-width: 300px;
        }
        
        .tarot-card .symbol {
            font-size: 80px;
            margin: 20px 0;
        }
        
        .tarot-card .name {
            font-size: 24px;
            font-weight: 600;
            margin: 16px 0;
        }
        
        .tarot-card .meaning {
            font-size: 16px;
            line-height: 1.6;
            opacity: 0.9;
        }
        
        /* Quick Stats */
        .quick-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 16px;
            margin: 20px 0;
        }
        
        .stat-box {
            background: linear-gradient(135deg, #FFE8CC 0%, #FFF5E6 100%);
            padding: 16px;
            border-radius: 12px;
            text-align: center;
        }
        
        .stat-label {
            font-size: 12px;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
        }
        
        .stat-value {
            font-size: 20px;
            font-weight: 700;
            color: #FF9933;
        }
        
        /* Responsive */
        @media (max-width: 600px) {
            .container {
                padding: 12px;
            }
            
            .card {
                padding: 20px;
                margin-bottom: 16px;
            }
            
            .btn-group {
                flex-direction: column;
            }
            
            .btn-group .btn {
                width: 100%;
            }
        }
        
        /* Kali Oracle Styles */
        .kali-card {
            background: linear-gradient(135deg, #1a0d1a 0%, #2d1b2d 100%);
            border-radius: 20px;
            padding: 32px;
            text-align: center;
            color: #fff;
            box-shadow: 0 8px 25px rgba(139, 0, 139, 0.4);
            margin: 20px auto;
            max-width: 320px;
            border: 2px solid #8B008B;
            position: relative;
        }
        
        .kali-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(139,0,139,0.1) 0%, rgba(220,20,60,0.1) 100%);
            border-radius: 20px;
            pointer-events: none;
        }
        
        .kali-card .symbol {
            font-size: 80px;
            margin: 20px 0;
            filter: drop-shadow(0 0 10px rgba(139,0,139,0.5));
        }
        
        .kali-card .name {
            font-size: 24px;
            font-weight: 700;
            margin: 16px 0;
            color: #DC143C;
            text-shadow: 0 0 10px rgba(220,20,60,0.5);
        }
        
        .kali-card .aspect {
            font-size: 14px;
            opacity: 0.8;
            margin-bottom: 12px;
            color: #DDA0DD;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .kali-card .meaning {
            font-size: 16px;
            line-height: 1.6;
            opacity: 0.9;
            margin: 16px 0;
        }
        
        .kali-card .guidance {
            font-size: 15px;
            line-height: 1.5;
            color: #FF69B4;
            font-style: italic;
            margin: 12px 0;
        }
        
        .kali-card .keywords {
            font-size: 13px;
            color: #DDA0DD;
            margin-top: 16px;
            padding-top: 12px;
            border-top: 1px solid rgba(139,0,139,0.3);
        }
        
        /* Kali Shuffle Animation */
        .kali-shuffle-card {
            box-shadow: 0 4px 15px rgba(139, 0, 139, 0.4) !important;
        }
        
        /* Utility Classes */
        .text-center { text-align: center; }
        .mt-20 { margin-top: 20px; }
        .mb-20 { margin-bottom: 20px; }
        .hidden { display: none; }







    </style>
</head>
<body>

<!-- App Header -->
<div class="app-header">
    <h1>🔮 Mystic Divination</h1>
    <p>Tarot • Numerology • Moonology • Kali Oracle</p>
</div>

<!-- Main Container -->
<div class="container">

    <!-- HOME SECTION -->
    <div id="home" class="section active">
        <div class="card">
            <h2>🌙 Today's Cosmic Energy</h2>
            <p style="text-align: center; color: #666; margin-bottom: 16px;">
                Tuesday, October 21, 2025
            </p>
            <div class="info-box">
                <p><strong>Current Moon Phase:</strong> Waxing Crescent in Sagittarius</p>
                <p><strong>Lunar Energy:</strong> Growth, optimism, and exploration</p>
                <p><strong>Today's Focus:</strong> Take inspired action on your dreams</p>
            </div>
            <div class="quick-stats">
                <div class="stat-box">
                    <div class="stat-label">Moon Phase</div>
                    <div class="stat-value">🌒 Waxing</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">Lunar Sign</div>
                    <div class="stat-value">♐ Sagittarius</div>
                </div>
            </div>
        </div>
        
        <div class="card">
            <h2>✨ Explore Your Path</h2>
            <div class="btn-group">
                <button class="btn" onclick="showTab('tarot')">🎴 Tarot Wisdom</button>
                <button class="btn btn-secondary" onclick="showTab('numerology')">🔢 Sacred Numbers</button>
            </div>
            <button class="btn btn-outline mt-20" onclick="showTab('moonology')">🌙 Lunar Oracle</button>
            <button class="btn mt-20" style="background: linear-gradient(135deg, #8B008B 0%, #4B0082 100%); box-shadow: 0 4px 12px rgba(139, 0, 139, 0.4);" onclick="showTab('kali')">🗡️ Kali Oracle</button>
        </div>
    </div>



    <!-- NUMEROLOGY SECTION -->
    <div id="numerology" class="section">
        <div class="card">
            <h2>🔢 Sacred Numerology System</h2>
            <p style="color: #666; margin-bottom: 20px;">
                Discover your complete numerological blueprint with 9+ core numbers, name analysis, and life cycles
            </p>
            
            <div class="form-group">
                <label>Full Birth Name</label>
                <input type="text" id="numerology-name" placeholder="Complete name as on birth certificate">
            </div>
            
            <div class="form-group">
                <label>Current Name (if different)</label>
                <input type="text" id="numerology-current-name" placeholder="Name you use now (optional)">
            </div>
            
            <div class="form-group">
                <label>Date of Birth</label>
                <input type="date" id="numerology-dob">
            </div>
            
            <div class="form-group">
                <label>Reading Type</label>
                <select id="numerology-reading-type">
                    <option value="complete">Complete Numerology Profile</option>
                    <option value="core">Core Numbers Only</option>
                    <option value="compatibility">Compatibility Analysis (requires partner info)</option>
                </select>
            </div>
            
            <div id="partner-info" class="hidden">
                <div class="form-group">
                    <label>Partner's Name</label>
                    <input type="text" id="partner-name" placeholder="Partner's full name">
                </div>
                <div class="form-group">
                    <label>Partner's Date of Birth</label>
                    <input type="date" id="partner-dob">
                </div>
            </div>
            
            <button class="btn" onclick="calculateEnhancedNumerology()">✨ Calculate Sacred Numbers</button>
        </div>
        
        <div id="numerology-dashboard" class="card hidden">
            <h2>📊 Your Numerology Dashboard</h2>
            <div id="numerology-grid"></div>
        </div>
        
        <div id="numerology-detailed" class="card hidden">
            <h2>🔍 Detailed Analysis</h2>
            <div id="numerology-details"></div>
        </div>
        
        <div id="numerology-name-analysis" class="card hidden">
            <h2>📝 Name Structure Analysis</h2>
            <div id="name-analysis-output"></div>
        </div>
        
        <div id="numerology-cycles" class="card hidden">
            <h2>🔄 Personal Cycles & Timing</h2>
            <div id="cycles-output"></div>
        </div>
        
        <div id="numerology-compatibility" class="card hidden">
            <h2>💕 Compatibility Analysis</h2>
            <div id="compatibility-output"></div>
        </div>
        
        <div id="numerology-guidance" class="card hidden">
            <h2>🎯 Actionable Guidance</h2>
            <div id="guidance-output"></div>
        </div>
        
        <div id="numerology-name-correction" class="card hidden">
            <h2>✨ Name Correction & Optimization</h2>
            <div id="name-correction-output"></div>
        </div>
    </div>

    <!-- TAROT SECTION -->
    <div id="tarot" class="section">
        <div class="card">
            <h2>🎴 Enhanced Tarot Reading</h2>
            <p style="text-align: center; color: #666; margin-bottom: 24px;">
                Choose your spread type for divine guidance
            </p>
            
            <div class="form-group">
                <label for="spread-selector">Select Spread Type</label>
                <select id="spread-selector" class="form-control">
                    <option value="single">🃏 Single Card - Enhanced daily guidance with deep insights</option>
                    <option value="three">🎴 Three Cards - Past • Present • Future with combination analysis</option>
                    <option value="celtic">🌟 Celtic Cross - Comprehensive life reading with combinations</option>
                    <option value="love">💕 Love Spread - Relationship insights with interaction patterns</option>
                    <option value="career">💼 Career Path - Professional guidance with strategic combinations</option>
                    <option value="yes_no">❓ Yes/No - Clear answer with underlying energies</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="reading-depth">Reading Depth</label>
                <select id="reading-depth" class="form-control">
                    <option value="standard">📖 Standard - Individual cards + key combinations</option>
                    <option value="deep" selected>🔮 Deep - Full combination analysis + elemental + guidance</option>
                    <option value="quick">⚡ Quick - Just card names and basic meanings</option>
                </select>
            </div>
            
            <button class="btn" onclick="startTarotReading()">✨ Shuffle &amp; Draw Cards</button>
        </div>
        
        <div id="shuffle-animation" class="card" style="display: none;">
            <!-- Shuffling animation will appear here -->
        </div>
        
        <div id="tarot-result" class="card hidden">
            <div id="tarot-output"></div>
        </div>
    </div>

    <!-- MOONOLOGY SECTION -->
    <div id="moonology" class="section">
        <div class="card">
            <h2>🌙 Moonology Oracle</h2>
            <p style="text-align: center; color: #666; margin-bottom: 24px;">
                Connect with lunar wisdom and celestial guidance
            </p>
            
            <div class="form-group">
                <label for="moonology-spread">Choose Your Lunar Spread</label>
                <select id="moonology-spread" class="form-control">
                    <option value="daily">🌙 Daily Lunar Guidance - Single card wisdom</option>
                    <option value="phase">🌓 Moon Phase Reading - Current energy, Challenge, Guidance</option>
                    <option value="cycle">🌑🌕 Full Lunar Cycle - Complete 8-phase journey</option>
                    <option value="manifestation">✨ Manifestation Spread - Intention to outcome</option>
                </select>
            </div>
            
            <button class="btn" onclick="drawMoonologyCards()">🌟 Draw Oracle Cards</button>
        </div>
        
        <div id="moonology-shuffle" class="card" style="display: none;">
            <!-- Moonology shuffling animation will appear here -->
        </div>
        
        <div id="moonology-result" class="card hidden">
            <div id="moonology-output"></div>
        </div>
    </div>

    <!-- KALI ORACLE SECTION -->
    <div id="kali" class="section">
        <div class="card">
            <h2>🗡️ Kali Oracle</h2>
            <p style="text-align: center; color: #666; margin-bottom: 24px;">
                Divine Feminine power and fierce transformation wisdom
            </p>
            
            <div class="form-group">
                <label for="kali-spread">Choose Your Kali Spread</label>
                <select id="kali-spread" class="form-control">
                    <option value="daily">🗡️ Daily Kali Message - Single fierce wisdom</option>
                    <option value="shadow">🌑 Shadow Work Spread - Shadow, Lesson, Integration</option>
                    <option value="transformation">🦋 Transformation Spread - Death, Birth, Catalyst, Support, Outcome</option>
                    <option value="warrior">⚔️ Warrior Path - Challenge, Strength, Weapon, Ally, Obstacle, Victory, Blessing</option>
                </select>
            </div>
            
            <button class="btn" style="background: linear-gradient(135deg, #8B008B 0%, #DC143C 100%); box-shadow: 0 4px 12px rgba(139, 0, 139, 0.4);" onclick="drawKaliCards()">🔥 Channel Kali's Power</button>
        </div>
        
        <div id="kali-shuffle" class="card" style="display: none;">
            <!-- Kali shuffling animation will appear here -->
        </div>
        
        <div id="kali-result" class="card hidden">
            <div id="kali-output"></div>
        </div>
    </div>

</div>

<!-- Bottom Navigation -->
<div class="nav-tabs">
    <button class="nav-tab" onclick="showTab('tarot')">
        <span class="icon">🎴</span>
        <span>Tarot</span>
    </button>
    <button class="nav-tab" onclick="showTab('numerology')">
        <span class="icon">🔢</span>
        <span>Numerology</span>
    </button>
    <button class="nav-tab" onclick="showTab('moonology')">
        <span class="icon">🌙</span>
        <span>Moonology</span>
    </button>
    <button class="nav-tab" onclick="showTab('kali')">
        <span class="icon">🗡️</span>
        <span>Kali Oracle</span>
    </button>
</div>

<script>
// Navigation
function showTab(tabName) {
    // Hide all sections
    document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
    
    // Remove active from nav tabs
    document.querySelectorAll('.nav-tab').forEach(btn => btn.classList.remove('active'));
    
    // Show selected section
    document.getElementById(tabName).classList.add('active');
    
    // Highlight active tab
    event.target.closest('.nav-tab').classList.add('active');
    
    // Scroll to top
    window.scrollTo({top: 0, behavior: 'smooth'});
}

// COMPLETE MOONOLOGY ORACLE SYSTEM

// Complete 44-Card Moonology Deck
const moonologyDeck = [
    // New Moon Cards (8 cards)
    {id: 1, name: "New Moon", symbol: "🌑", phase: "New", meaning: "New beginnings, fresh starts, planting seeds of intention. Time to set powerful intentions for the cycle ahead.", guidance: "What do you want to create? Set clear intentions now.", energy: "Potential, Manifestation, Beginning"},
    {id: 2, name: "New Moon in Aries", symbol: "🌑♈", phase: "New", meaning: "Bold new beginnings. Time to take courageous action and pioneer new paths.", guidance: "Be brave and assertive. Start that project you've been dreaming about.", energy: "Courage, Initiative, Leadership"},
    {id: 3, name: "New Moon in Taurus", symbol: "🌑♉", phase: "New", meaning: "Grounding your dreams. Build stable foundations for long-term security and abundance.", guidance: "Focus on practical matters. Plant seeds for financial growth.", energy: "Stability, Abundance, Patience"},
    {id: 4, name: "New Moon in Gemini", symbol: "🌑♊", phase: "New", meaning: "New ideas and communication. Time to learn, connect, and share your thoughts.", guidance: "Start conversations. Network and explore new information.", energy: "Communication, Curiosity, Connection"},
    {id: 5, name: "New Moon in Cancer", symbol: "🌑♋", phase: "New", meaning: "Emotional renewal and home focus. Nurture yourself and loved ones.", guidance: "Create emotional safety. Focus on family and inner world.", energy: "Nurturing, Home, Emotions"},
    {id: 6, name: "New Moon in Leo", symbol: "🌑♌", phase: "New", meaning: "Creative self-expression. Time to shine and show your authentic self.", guidance: "Express yourself boldly. Step into the spotlight.", energy: "Creativity, Confidence, Joy"},
    {id: 7, name: "New Moon in Virgo", symbol: "🌑♍", phase: "New", meaning: "Organization and health focus. Perfect time for new routines and self-improvement.", guidance: "Create healthy habits. Organize your life for success.", energy: "Health, Service, Perfection"},
    {id: 8, name: "New Moon in Libra", symbol: "🌑♎", phase: "New", meaning: "Relationship renewal and balance. Time to harmonize all areas of life.", guidance: "Focus on partnerships. Create beauty and balance.", energy: "Harmony, Partnership, Balance"},
    
    // Waxing Crescent (4 cards)
    {id: 9, name: "Waxing Crescent Moon", symbol: "🌒", phase: "Waxing", meaning: "Building momentum. Your intentions are taking root. Keep faith and take small steps.", guidance: "Stay committed to your intentions. Small actions matter.", energy: "Growth, Faith, Action"},
    {id: 10, name: "Trust the Process", symbol: "🌒✨", phase: "Waxing", meaning: "Have faith in unseen growth. Seeds are germinating beneath the surface.", guidance: "Trust that things are developing even if you can't see progress yet.", energy: "Faith, Patience, Trust"},
    {id: 11, name: "Take Inspired Action", symbol: "🌒⚡", phase: "Waxing", meaning: "Move forward with your plans. The universe supports your actions now.", guidance: "Don't wait for perfect conditions. Start moving toward your goals.", energy: "Action, Courage, Initiative"},
    {id: 12, name: "Stay Focused", symbol: "🌒🎯", phase: "Waxing", meaning: "Keep your eyes on your goals. Don't let distractions derail your progress.", guidance: "Maintain focus on what matters. Avoid scatter energy.", energy: "Focus, Determination, Clarity"},
    
    // First Quarter (4 cards)
    {id: 13, name: "First Quarter Moon", symbol: "🌓", phase: "First Quarter", meaning: "Decision time. Obstacles arise to test your commitment. Push through challenges.", guidance: "Make important decisions. Overcome obstacles with determination.", energy: "Challenge, Decision, Perseverance"},
    {id: 14, name: "Face Your Challenges", symbol: "🌓💪", phase: "First Quarter", meaning: "Obstacles are opportunities for growth. You're stronger than you think.", guidance: "Don't back down. These challenges are making you stronger.", energy: "Strength, Courage, Growth"},
    {id: 15, name: "Make a Choice", symbol: "🌓🔀", phase: "First Quarter", meaning: "Time to commit to one path. You cannot serve two masters.", guidance: "Choose your direction clearly. Commit fully to your path.", energy: "Decision, Commitment, Clarity"},
    {id: 16, name: "Adjust Your Course", symbol: "🌓🧭", phase: "First Quarter", meaning: "Fine-tune your approach. Small adjustments lead to better outcomes.", guidance: "Be flexible. Adjust your strategy as needed.", energy: "Flexibility, Adaptation, Wisdom"},
    
    // Waxing Gibbous (4 cards)
    {id: 17, name: "Waxing Gibbous Moon", symbol: "🌔", phase: "Waxing Gibbous", meaning: "Refinement and patience. Almost there. Perfect the details.", guidance: "Don't rush. Perfect your work. The timing will be right soon.", energy: "Refinement, Patience, Preparation"},
    {id: 18, name: "Perfect the Details", symbol: "🌔🔍", phase: "Waxing Gibbous", meaning: "Excellence comes from attention to detail. Polish your work.", guidance: "Review and refine. Make sure everything is just right.", energy: "Perfection, Detail, Excellence"},
    {id: 19, name: "Patience Pays Off", symbol: "🌔⏳", phase: "Waxing Gibbous", meaning: "Good things come to those who wait. Your moment is coming.", guidance: "Trust divine timing. Don't force things prematurely.", energy: "Patience, Trust, Timing"},
    {id: 20, name: "Build Anticipation", symbol: "🌔🎁", phase: "Waxing Gibbous", meaning: "Excitement builds. You're on the verge of something wonderful.", guidance: "Stay positive. Great things are about to manifest.", energy: "Anticipation, Hope, Excitement"},
    
    // Full Moon Cards (8 cards)
    {id: 21, name: "Full Moon", symbol: "🌕", phase: "Full", meaning: "Culmination and celebration. Your efforts have borne fruit. Time to honor achievements.", guidance: "Celebrate your wins. Acknowledge how far you've come.", energy: "Completion, Achievement, Celebration"},
    {id: 22, name: "Full Moon in Aries", symbol: "🌕♈", phase: "Full", meaning: "Bold expression of self. Independence and courage reach peak. Be authentic.", guidance: "Assert yourself. Stand in your power without apology.", energy: "Courage, Independence, Action"},
    {id: 23, name: "Full Moon in Taurus", symbol: "🌕♉", phase: "Full", meaning: "Material abundance peaks. Enjoy sensory pleasures and financial rewards.", guidance: "Appreciate what you have. Enjoy material comforts.", energy: "Abundance, Pleasure, Gratitude"},
    {id: 24, name: "Full Moon in Gemini", symbol: "🌕♊", phase: "Full", meaning: "Communication reaches clarity. Important conversations and connections.", guidance: "Speak your truth. Important messages are ready to be shared.", energy: "Communication, Clarity, Connection"},
    {id: 25, name: "Full Moon in Cancer", symbol: "🌕♋", phase: "Full", meaning: "Emotional fullness. Deep feelings surface. Family matters highlighted.", guidance: "Honor your feelings. Nurture yourself and others.", energy: "Emotion, Nurturing, Family"},
    {id: 26, name: "Full Moon in Leo", symbol: "🌕♌", phase: "Full", meaning: "Creative peak. Time to share your gifts with the world. Shine bright.", guidance: "Show the world your talents. Take center stage.", energy: "Expression, Creativity, Recognition"},
    {id: 27, name: "Full Moon in Virgo", symbol: "🌕♍", phase: "Full", meaning: "Perfect your work. Health and service reach important point.", guidance: "Complete projects with excellence. Focus on wellbeing.", energy: "Completion, Health, Service"},
    {id: 28, name: "Full Moon in Libra", symbol: "🌕♎", phase: "Full", meaning: "Relationship culmination. Balance achieved or imbalance revealed.", guidance: "Evaluate relationships. Seek harmony and fairness.", energy: "Balance, Partnership, Harmony"},
    
    // Waning Gibbous (4 cards)
    {id: 29, name: "Waning Gibbous Moon", symbol: "🌖", phase: "Waning", meaning: "Share your wisdom. Teach what you've learned. Give back.", guidance: "Share your knowledge. Mentor others. Express gratitude.", energy: "Wisdom, Sharing, Gratitude"},
    {id: 30, name: "Share Your Gifts", symbol: "🌖🎁", phase: "Waning", meaning: "Your experiences can help others. Don't keep your wisdom to yourself.", guidance: "Teach what you know. Your story matters.", energy: "Teaching, Generosity, Service"},
    {id: 31, name: "Express Gratitude", symbol: "🌖🙏", phase: "Waning", meaning: "Count your blessings. Appreciation multiplies abundance.", guidance: "List what you're grateful for. Acknowledge support received.", energy: "Gratitude, Appreciation, Abundance"},
    {id: 32, name: "Celebrate Your Wins", symbol: "🌖🎉", phase: "Waning", meaning: "Acknowledge your achievements before moving on.", guidance: "Take time to celebrate. You deserve recognition.", energy: "Celebration, Achievement, Joy"},
    
    // Last Quarter (4 cards)
    {id: 33, name: "Last Quarter Moon", symbol: "🌗", phase: "Last Quarter", meaning: "Release and forgive. Let go of what no longer serves you.", guidance: "Release old patterns. Forgive yourself and others.", energy: "Release, Forgiveness, Liberation"},
    {id: 34, name: "Let Go", symbol: "🌗🕊️", phase: "Last Quarter", meaning: "Holding on too tight? Release your grip. Freedom comes from letting go.", guidance: "What needs to be released? Set it free with love.", energy: "Release, Freedom, Surrender"},
    {id: 35, name: "Forgive", symbol: "🌗💜", phase: "Last Quarter", meaning: "Forgiveness frees you, not them. Release resentment and pain.", guidance: "Forgive for your own peace. Let healing begin.", energy: "Forgiveness, Healing, Peace"},
    {id: 36, name: "Clear the Clutter", symbol: "🌗🧹", phase: "Last Quarter", meaning: "Physical and energetic decluttering. Clear space for new blessings.", guidance: "Clean out the old. Make room for the new.", energy: "Clearing, Cleansing, Space"},
    
    // Waning Crescent (4 cards)  
    {id: 37, name: "Waning Crescent Moon", symbol: "🌘", phase: "Waning Crescent", meaning: "Rest and restore. Quiet reflection time. Prepare for rebirth.", guidance: "Rest deeply. Reflect on the cycle. Journal your insights.", energy: "Rest, Reflection, Preparation"},
    {id: 38, name: "Rest and Restore", symbol: "🌘😴", phase: "Waning Crescent", meaning: "Deep rest is productive. Your body and soul need restoration.", guidance: "Permission to rest granted. Recharge fully.", energy: "Rest, Restoration, Renewal"},
    {id: 39, name: "Inner Reflection", symbol: "🌘🪞", phase: "Waning Crescent", meaning: "Look within. The answers you seek are inside you.", guidance: "Meditate. Journal. Listen to your inner voice.", energy: "Reflection, Meditation, Introspection"},
    {id: 40, name: "Prepare for Rebirth", symbol: "🌘🦋", phase: "Waning Crescent", meaning: "The cocoon before transformation. Something beautiful is coming.", guidance: "Trust the void. New beginnings are gestating.", energy: "Preparation, Transformation, Faith"},
    
    // Special Lunar Events (4 cards)
    {id: 41, name: "Eclipse", symbol: "🌑🌕", phase: "Special", meaning: "Major life reset. Destiny shifts. Expect the unexpected. Big changes ahead.", guidance: "Embrace change. Major transformation is occurring.", energy: "Change, Destiny, Transformation"},
    {id: 42, name: "Supermoon", symbol: "🌕✨", phase: "Special", meaning: "Amplified energy. Everything is intensified. Powerful manifestation time.", guidance: "Your intentions have extra power now. Use this energy wisely.", energy: "Amplification, Power, Intensity"},
    {id: 43, name: "Blue Moon", symbol: "🌕💙", phase: "Special", meaning: "Rare opportunity. Once in a blue moon chance. Seize the moment.", guidance: "This is your special moment. Take the rare opportunity.", energy: "Rarity, Opportunity, Magic"},
    {id: 44, name: "Dark Moon", symbol: "⚫", phase: "Special", meaning: "Deep shadow work. Face your fears. Profound transformation through darkness.", guidance: "Go into the darkness to find your light. Shadow work brings healing.", energy: "Shadow, Depth, Healing"}
];

// ENHANCED NUMEROLOGY SYSTEM

// Letter to Number conversion chart
const LETTER_VALUES = {
    'A':1,'B':2,'C':3,'D':4,'E':5,'F':6,'G':7,'H':8,'I':9,
    'J':1,'K':2,'L':3,'M':4,'N':5,'O':6,'P':7,'Q':8,'R':9,
    'S':1,'T':2,'U':3,'V':4,'W':5,'X':6,'Y':7,'Z':8
};

const VOWELS = 'AEIOU';

// Enhanced Number Meanings Database
const NUMBER_MEANINGS = {
    1: {
        lifePath: "The Pioneer - You're here to lead, innovate, and break new ground. Independence and originality define your soul's journey. You must learn to stand alone while inspiring others to follow.",
        expression: "Natural-born leader with executive abilities. You have the innate drive to accomplish great things through your own efforts and original thinking.",
        soulUrge: "You crave independence, recognition, and the freedom to be uniquely yourself. Your heart desires to be first, to make your mark on the world.",
        personality: "Others see you as confident, capable, and assertive. You project leadership energy and people naturally look to you for direction.",
        strengths: "Independence, courage, innovation, determination, leadership, originality",
        challenges: "Arrogance, impatience, selfishness, domination, stubbornness, isolation",
        careers: "Entrepreneur, CEO, Director, Inventor, Military Leader, Pioneer, Executive",
        relationships: "Needs a partner who respects your independence. Can be controlling if not conscious of others' needs.",
        spiritualLesson: "Balance independence with cooperation. Lead without dominating. Serve others through your leadership.",
        luckyNumbers: [1, 10, 19, 28],
        luckyColors: ["Red", "Orange", "Gold"],
        luckyDays: ["Sunday", "Monday"]
    },
    2: {
        lifePath: "The Diplomat - You're here to bring harmony, cooperation, and balance to the world. Sensitivity and partnership define your path. You must learn patience and the art of gentle influence.",
        expression: "Natural diplomat with the ability to see all sides and bring people together. You're a peacemaker who works best in partnership.",
        soulUrge: "You crave harmony, partnership, and deep emotional connections. Your heart desires peace, love, and cooperative relationships.",
        personality: "Others see you as gentle, diplomatic, and understanding. You project a calm, approachable energy that makes people feel safe.",
        strengths: "Diplomacy, cooperation, intuition, patience, sensitivity, mediation",
        challenges: "Oversensitivity, indecision, dependency, passive-aggression, fear of conflict",
        careers: "Counselor, Mediator, Diplomat, Teacher, Artist, Healer, Social Worker",
        relationships: "Natural partner who seeks deep emotional bonds. Needs appreciation and gentle treatment.",
        spiritualLesson: "Learn to stand up for yourself while maintaining peace. Balance giving and receiving.",
        luckyNumbers: [2, 11, 20, 29],
        luckyColors: ["Blue", "Green", "Silver"],
        luckyDays: ["Monday", "Friday"]
    },
    3: {
        lifePath: "The Creative Communicator - You're here to express, create, and inspire joy in others. Communication and self-expression are your gifts. You must learn to focus your scattered creative energy.",
        expression: "Natural communicator and artist with the ability to uplift others through creative expression. You're here to bring joy and beauty.",
        soulUrge: "You crave self-expression, creative outlets, and the freedom to share your joy with the world. Your heart desires to inspire and entertain.",
        personality: "Others see you as charismatic, fun-loving, and creative. You project vibrant, youthful energy that attracts people.",
        strengths: "Creativity, communication, optimism, charm, expressiveness, humor",
        challenges: "Scattered energy, superficiality, criticism, mood swings, lack of focus",
        careers: "Artist, Writer, Performer, Speaker, Designer, Entertainer, Marketing",
        relationships: "Fun-loving partner who brings joy and laughter. Needs variety and mental stimulation.",
        spiritualLesson: "Focus your creative energy. Choose depth over breadth. Finish what you start.",
        luckyNumbers: [3, 12, 21, 30],
        luckyColors: ["Yellow", "Orange", "Pink"],
        luckyDays: ["Wednesday", "Thursday"]
    },
    4: {
        lifePath: "The Master Builder - You're here to build, organize, and create lasting foundations. Hard work and systematic thinking define your path. You must learn patience with the slow process of building.",
        expression: "Natural organizer and builder with practical skills and strong work ethic. You create order from chaos and build things that last.",
        soulUrge: "You crave security, stability, and the satisfaction of building something meaningful. Your heart desires to create lasting value.",
        personality: "Others see you as reliable, practical, and hardworking. You project stability and competence that people can depend on.",
        strengths: "Organization, reliability, hard work, practicality, discipline, loyalty",
        challenges: "Rigidity, stubbornness, pessimism, limitation, resistance to change",
        careers: "Architect, Engineer, Manager, Accountant, Craftsperson, Administrator",
        relationships: "Loyal, committed partner who values stability. Can be too focused on work if not balanced.",
        spiritualLesson: "Balance work with play. Embrace flexibility within structure. Value process as much as results.",
        luckyNumbers: [4, 13, 22, 31],
        luckyColors: ["Green", "Brown", "Earthy tones"],
        luckyDays: ["Saturday", "Sunday"]
    },
    5: {
        lifePath: "The Freedom Seeker - You're here to explore, experience, and promote freedom. Adventure and variety define your journey. You must learn to balance freedom with responsibility.",
        expression: "Natural adventurer with versatile talents and love of freedom. You're here to experience life fully and inspire others to break free.",
        soulUrge: "You crave freedom, adventure, and new experiences. Your heart desires to explore all that life offers without restriction.",
        personality: "Others see you as dynamic, adventurous, and magnetic. You project exciting energy that draws people into your adventures.",
        strengths: "Versatility, adaptability, curiosity, freedom, progressive thinking, magnetism",
        challenges: "Restlessness, irresponsibility, addiction tendencies, lack of focus, impulsiveness",
        careers: "Travel Agent, Sales, Marketing, Journalist, Entrepreneur, Entertainer",
        relationships: "Needs freedom and variety. Partner must be adventurous and understanding of your need for space.",
        spiritualLesson: "Learn to commit while maintaining freedom. Use freedom constructively to serve others.",
        luckyNumbers: [5, 14, 23, 32],
        luckyColors: ["Blue", "Turquoise", "Bright colors"],
        luckyDays: ["Wednesday", "Friday"]
    },
    6: {
        lifePath: "The Nurturer - You're here to heal, serve, and create harmony in relationships and communities. Love and responsibility define your path. You must learn to nurture yourself while caring for others.",
        expression: "Natural healer and nurturer with strong sense of responsibility for others' wellbeing. You create harmony and beauty wherever you go.",
        soulUrge: "You crave love, harmony, and the opportunity to care for others. Your heart desires to heal and nurture all living things.",
        personality: "Others see you as caring, responsible, and trustworthy. You project warm, maternal/paternal energy that makes people feel loved.",
        strengths: "Compassion, responsibility, healing, harmony, service, family devotion",
        challenges: "Martyrdom, interference, worry, possessiveness, self-sacrifice to a fault",
        careers: "Healer, Teacher, Counselor, Healthcare, Interior Design, Chef, Parent",
        relationships: "Devoted partner who puts family first. Can be overly protective or controlling if unbalanced.",
        spiritualLesson: "Learn to receive as well as give. Set healthy boundaries. Nurture yourself too.",
        luckyNumbers: [6, 15, 24, 33],
        luckyColors: ["Pink", "Blue", "Pastels"],
        luckyDays: ["Friday", "Monday"]
    },
    7: {
        lifePath: "The Seeker - You're here to seek truth, develop wisdom, and understand life's mysteries. Spirituality and analysis define your journey. You must learn to share your insights with others.",
        expression: "Natural philosopher and researcher with deep need to understand truth. You're here to uncover hidden knowledge and spiritual wisdom.",
        soulUrge: "You crave understanding, solitude for reflection, and spiritual connection. Your heart desires to know the deeper meaning of existence.",
        personality: "Others see you as mysterious, intelligent, and spiritually aware. You project an otherworldly quality that intrigues people.",
        strengths: "Wisdom, analysis, intuition, spirituality, research abilities, inner knowing",
        challenges: "Isolation, skepticism, aloofness, perfectionism, tendency to withdraw",
        careers: "Researcher, Scientist, Spiritual Teacher, Analyst, Writer, Investigator",
        relationships: "Needs intellectual and spiritual connection. Can seem distant if partner doesn't understand your depth.",
        spiritualLesson: "Share your wisdom with the world. Balance solitude with connection. Trust your intuition.",
        luckyNumbers: [7, 16, 25, 34],
        luckyColors: ["Purple", "Violet", "Sea green"],
        luckyDays: ["Monday", "Sunday"]
    },
    8: {
        lifePath: "The Executive - You're here to achieve material mastery and use power wisely. Success and authority define your path. You must learn to balance material and spiritual values.",
        expression: "Natural executive with ability to organize, manage, and achieve material success. You're here to build empires and lead organizations.",
        soulUrge: "You crave success, recognition, and material achievement. Your heart desires to build something significant and lasting.",
        personality: "Others see you as powerful, ambitious, and successful. You project authority and competence that commands respect.",
        strengths: "Ambition, organization, material mastery, leadership, business acumen, authority",
        challenges: "Materialism, workaholism, power abuse, stress, neglect of relationships",
        careers: "CEO, Business Owner, Real Estate, Banking, Politics, Large Organization Leader",
        relationships: "Strong partner who appreciates success. Can neglect relationships for career if unbalanced.",
        spiritualLesson: "Use power and wealth to serve humanity. Balance material success with spiritual growth.",
        luckyNumbers: [8, 17, 26, 35],
        luckyColors: ["Brown", "Black", "Dark green"],
        luckyDays: ["Saturday", "Tuesday"]
    },
    9: {
        lifePath: "The Humanitarian - You're here to serve humanity and complete cycles. Compassion and wisdom define your journey. You must learn to let go and serve the greater good.",
        expression: "Natural humanitarian with broad understanding and compassionate heart. You're here to serve humanity and complete what others have started.",
        soulUrge: "You crave the opportunity to serve humanity and make the world better. Your heart desires to heal and help on a grand scale.",
        personality: "Others see you as wise, compassionate, and universally minded. You project a sage-like quality that people respect.",
        strengths: "Compassion, wisdom, universal love, completion, artistic ability, healing",
        challenges: "Emotional extremes, disappointment, difficulty with endings, martyrdom",
        careers: "Humanitarian Worker, Artist, Healer, Teacher, Philanthropist, Global Leader",
        relationships: "Generous, understanding partner. Can be disappointed if others don't share your humanitarian ideals.",
        spiritualLesson: "Release attachment to outcomes. Serve without expecting recognition. Complete with grace.",
        luckyNumbers: [9, 18, 27, 36],
        luckyColors: ["Gold", "Crimson", "Bronze"],
        luckyDays: ["Tuesday", "Thursday"]
    },
    11: {
        lifePath: "The Intuitive Messenger - Master Number. You're here to inspire and illuminate others through spiritual insight. High sensitivity and intuition define your path.",
        expression: "Spiritual messenger with profound intuitive abilities. You're here to channel higher wisdom and inspire others to awaken.",
        soulUrge: "You crave spiritual understanding and the opportunity to inspire others. Your heart desires to serve as a bridge between worlds.",
        personality: "Others see you as inspiring, visionary, and spiritually gifted. You project electric energy that awakens others.",
        strengths: "Intuition, inspiration, spiritual awareness, idealism, sensitivity, channeling",
        challenges: "Nervous energy, impracticality, superiority complex, overwhelm, escapism",
        careers: "Spiritual Teacher, Healer, Artist, Inspirational Speaker, Counselor, Medium",
        relationships: "Needs spiritually aware partner. Highly sensitive to others' energy and emotions.",
        spiritualLesson: "Ground your insights in practical reality. Manage your sensitivity. Inspire through example.",
        luckyNumbers: [11, 22, 33, 29],
        luckyColors: ["Silver", "White", "Electric blue"],
        luckyDays: ["Monday", "Thursday"]
    },
    22: {
        lifePath: "The Master Builder - Master Number. You're here to manifest grand visions into physical reality. Building lasting structures defines your purpose.",
        expression: "Visionary architect with practical skills to build lasting monuments. You're here to make big dreams reality for humanity.",
        soulUrge: "You crave the opportunity to build something magnificent that serves humanity. Your heart desires to leave a lasting legacy.",
        personality: "Others see you as powerfully capable and visionary. You project mastery energy that commands respect and following.",
        strengths: "Vision, practical mastery, leadership, manifestation, building, organization",
        challenges: "Overwhelm, pressure, perfectionism, material focus, stress, workaholism",
        careers: "Architect, Master Builder, International Business, Environmental Leader, Systems Designer",
        relationships: "Needs highly supportive partner who understands your big vision. Can neglect personal relationships.",
        spiritualLesson: "Balance material building with spiritual growth. Remember to rest and enjoy life.",
        luckyNumbers: [22, 11, 33, 4],
        luckyColors: ["Coral", "Crimson", "Gold"],
        luckyDays: ["Saturday", "Sunday"]
    },
    33: {
        lifePath: "The Master Teacher - Master Number. You're here to heal and teach through unconditional love. Compassionate service defines your highest purpose.",
        expression: "Master healer and teacher with boundless compassion. You're here to heal humanity's wounds through love and service.",
        soulUrge: "You crave the opportunity to heal and uplift all beings. Your heart desires to serve as an instrument of divine love.",
        personality: "Others see you as a living saint with unlimited compassion. You project healing energy that transforms everyone around you.",
        strengths: "Unconditional love, healing, teaching, compassion, service, spiritual mastery",
        challenges: "Martyrdom, overwhelming responsibility, inability to say no, emotional overwhelm",
        careers: "Spiritual Teacher, Master Healer, Humanitarian Leader, Counselor, Saint",
        relationships: "Gives unconditionally. Needs partner who ensures you receive care too.",
        spiritualLesson: "Set boundaries while serving. Care for yourself so you can care for others.",
        luckyNumbers: [33, 6, 9, 15],
        luckyColors: ["Sea green", "Gold", "Pure white"],
        luckyDays: ["Friday", "Sunday"]
    }
};

// Utility Functions
function sumDigits(num) {
    let sum = 0;
    while (num > 0) {
        sum += num % 10;
        num = Math.floor(num / 10);
    }
    return sum;
}

function reduceToSingle(num) {
    while (num > 9 && num !== 11 && num !== 22 && num !== 33) {
        num = sumDigits(num);
    }
    return num;
}

function calculateAllNumbers(name, dob) {
    const date = new Date(dob);
    const day = date.getDate();
    const month = date.getMonth() + 1;
    const year = date.getFullYear();
    
    const currentDate = new Date();
    const currentYear = currentDate.getFullYear();
    const currentMonth = currentDate.getMonth() + 1;
    const currentDay = currentDate.getDate();
    
    // Core Numbers
    const lifePath = calculateLifePath(day, month, year);
    const expression = calculateExpression(name);
    const soulUrge = calculateSoulUrge(name);
    const personality = calculatePersonality(name);
    const maturity = calculateMaturity(lifePath, expression);
    
    // Additional Numbers
    const birthday = reduceToSingle(day);
    const attitude = calculateAttitude(day, month);
    const challenges = calculateChallengeNumbers(day, month, year);
    
    // Personal Cycles
    const personalYear = calculatePersonalYear(day, month, currentYear);
    const personalMonth = calculatePersonalMonth(personalYear, currentMonth);
    const personalDay = calculatePersonalDay(personalMonth, currentDay);
    
    return {
        lifePath, expression, soulUrge, personality, maturity,
        birthday, attitude, challenges,
        personalYear, personalMonth, personalDay,
        name: name
    };
}

// Core Number Calculations
function calculateLifePath(day, month, year) {
    return reduceToSingle(sumDigits(day) + sumDigits(month) + sumDigits(year));
}

function calculateExpression(name) {
    let sum = 0;
    for (let char of name.toUpperCase().replace(/[^A-Z]/g, '')) {
        if (LETTER_VALUES[char]) sum += LETTER_VALUES[char];
    }
    return reduceToSingle(sum);
}

function calculateSoulUrge(name) {
    let sum = 0;
    for (let char of name.toUpperCase()) {
        if (VOWELS.includes(char)) sum += LETTER_VALUES[char];
    }
    return reduceToSingle(sum);
}

function calculatePersonality(name) {
    let sum = 0;
    for (let char of name.toUpperCase().replace(/[^A-Z]/g, '')) {
        if (!VOWELS.includes(char) && LETTER_VALUES[char]) {
            sum += LETTER_VALUES[char];
        }
    }
    return reduceToSingle(sum);
}

function calculateMaturity(lifePath, expression) {
    return reduceToSingle(lifePath + expression);
}

function calculateAttitude(day, month) {
    return reduceToSingle(day + month);
}

function calculateChallengeNumbers(day, month, year) {
    const d = reduceToSingle(day);
    const m = reduceToSingle(month);
    const y = reduceToSingle(year);
    
    const first = Math.abs(d - m);
    const second = Math.abs(d - y);
    const third = Math.abs(first - second);
    const main = Math.abs(m - y);
    
    return { first, second, third, main };
}

function calculatePersonalYear(day, month, currentYear) {
    return reduceToSingle(day + month + currentYear);
}

function calculatePersonalMonth(personalYear, currentMonth) {
    return reduceToSingle(personalYear + currentMonth);
}

function calculatePersonalDay(personalMonth, currentDay) {
    return reduceToSingle(personalMonth + currentDay);
}

// Name Analysis Functions
function analyzeNameStructure(name) {
    const cleanName = name.toUpperCase().replace(/[^A-Z]/g, '');
    
    return {
        cornerstone: {
            letter: cleanName[0],
            meaning: getCornerstoneMeaning(cleanName[0]),
            interpretation: "How you approach life and new situations"
        },
        capstone: {
            letter: cleanName[cleanName.length - 1],
            meaning: getCapstoneMeaning(cleanName[cleanName.length - 1]),
            interpretation: "How you complete projects and handle endings"
        },
        firstVowel: {
            letter: getFirstVowel(name),
            meaning: getFirstVowelMeaning(getFirstVowel(name)),
            interpretation: "Your emotional nature and instinctive reactions"
        },
        letterFrequency: analyzeLetterFrequency(cleanName),
        missingNumbers: findMissingNumbers(cleanName)
    };
}

function getCornerstoneMeaning(letter) {
    const meanings = {
        'A': "Ambitious leader who takes initiative",
        'B': "Cooperative team player who builds relationships",
        'C': "Creative communicator with artistic talents",
        'D': "Practical builder who works systematically",
        'E': "Freedom-loving adventurer who seeks variety",
        'F': "Nurturing caregiver who creates harmony",
        'G': "Perfectionist seeker who values quality",
        'H': "Business-minded achiever who builds success",
        'I': "Humanitarian helper who serves others",
        'J': "Visionary leader with high ideals",
        'K': "Intuitive innovator with spiritual awareness",
        'L': "Creative expresser who inspires others",
        'M': "Hard-working builder who creates foundations",
        'N': "Freedom seeker who values independence",
        'O': "Responsible nurturer who cares for others",
        'P': "Spiritual seeker who questions everything",
        'Q': "Powerful achiever with business acumen",
        'R': "Compassionate server who helps humanity",
        'S': "Dynamic leader with pioneering spirit",
        'T': "Peaceful mediator who brings harmony",
        'U': "Joyful creator who expresses freely",
        'V': "Reliable organizer who builds systematically",
        'W': "Adventurous explorer who seeks freedom",
        'X': "Caring healer who nurtures growth",
        'Y': "Wise analyst who seeks understanding",
        'Z': "Successful executive who commands respect"
    };
    return meanings[letter] || "Unique approach to life";
}

function getCapstoneMeaning(letter) {
    const meanings = {
        'A': "Completes projects with determination and leadership",
        'B': "Finishes through cooperation and team effort",
        'C': "Ends with creative expression and communication",
        'D': "Completes through systematic work and persistence",
        'E': "Finishes quickly, may jump to new projects",
        'F': "Completes with care for all involved",
        'G': "Finishes only when perfect, may delay completion",
        'H': "Completes with eye on practical results",
        'I': "Finishes with consideration for humanitarian impact",
        'J': "Completes with vision and high standards",
        'K': "Finishes through intuition and innovation",
        'L': "Completes with style and creative flair",
        'M': "Finishes through steady, methodical work",
        'N': "May rush to finish to move on to new freedom",
        'O': "Completes with responsibility and care",
        'P': "Finishes only after thorough analysis",
        'Q': "Completes with power and material focus",
        'R': "Finishes with service to others in mind",
        'S': "Completes with pioneering energy",
        'T': "Finishes harmoniously with all parties satisfied",
        'U': "Completes with enthusiasm and joy",
        'V': "Finishes through organized, systematic approach",
        'W': "May struggle to complete, prefers freedom",
        'X': "Completes with nurturing attention to detail",
        'Y': "Finishes after deep analysis and understanding",
        'Z': "Completes with executive efficiency"
    };
    return meanings[letter] || "Unique completion style";
}

function getFirstVowel(name) {
    for (let char of name.toUpperCase()) {
        if (VOWELS.includes(char)) return char;
    }
    return null;
}

function getFirstVowelMeaning(vowel) {
    const meanings = {
        'A': "React with independence and leadership",
        'E': "React with curiosity and need for variety",
        'I': "React with humanitarianism and compassion",
        'O': "React with responsibility and desire to help",
        'U': "React with creativity and self-expression"
    };
    return meanings[vowel] || "Balanced emotional reactions";
}

function analyzeLetterFrequency(name) {
    const frequency = {};
    for (let char of name) {
        frequency[char] = (frequency[char] || 0) + 1;
    }
    
    const sortedFreq = Object.entries(frequency)
        .sort((a, b) => b[1] - a[1])
        .slice(0, 3);
    
    return sortedFreq;
}

function findMissingNumbers(name) {
    const presentNumbers = new Set();
    for (let char of name) {
        if (LETTER_VALUES[char]) {
            presentNumbers.add(LETTER_VALUES[char]);
        }
    }
    
    const missingNumbers = [];
    for (let i = 1; i <= 9; i++) {
        if (!presentNumbers.has(i)) {
            missingNumbers.push(i);
        }
    }
    
    return missingNumbers;
}

// Compatibility Analysis
function calculateCompatibility(person1, person2) {
    const lifePathCompat = calculateLifePathCompatibility(person1.lifePath, person2.lifePath);
    const expressionCompat = calculateExpressionCompatibility(person1.expression, person2.expression);
    const soulUrgeCompat = calculateSoulUrgeCompatibility(person1.soulUrge, person2.soulUrge);
    
    const overallScore = Math.round((lifePathCompat.score + expressionCompat.score + soulUrgeCompat.score) / 3);
    
    return {
        overall: { score: overallScore, interpretation: getOverallCompatibility(overallScore) },
        lifePath: lifePathCompat,
        expression: expressionCompat,
        soulUrge: soulUrgeCompat
    };
}

function calculateLifePathCompatibility(num1, num2) {
    const compatMatrix = {
        '1-1': { score: 70, meaning: 'Two leaders - can be powerful or conflicting. Both want to lead.' },
        '1-2': { score: 85, meaning: 'Perfect balance - leader and supporter complement each other.' },
        '1-3': { score: 80, meaning: 'Dynamic creativity - leadership meets expression beautifully.' },
        '1-4': { score: 60, meaning: 'Different paces - spontaneous meets methodical.' },
        '1-5': { score: 90, meaning: 'Adventure partners - both love independence and excitement.' },
        '1-6': { score: 75, meaning: 'Care meets ambition - can work if 1 appreciates 6\'s nurturing.' },
        '1-7': { score: 50, meaning: 'Opposite energies - extroverted leader meets introspective seeker.' },
        '1-8': { score: 95, meaning: 'Power couple - both ambitious and success-oriented.' },
        '1-9': { score: 65, meaning: 'Different focuses - personal success meets humanitarian service.' },
        '2-2': { score: 75, meaning: 'Gentle harmony but may lack direction without a leader.' },
        '2-3': { score: 85, meaning: 'Beautiful partnership - sensitivity meets creativity.' },
        '2-4': { score: 80, meaning: 'Stable foundation - patience meets reliability.' },
        '2-5': { score: 60, meaning: 'Different needs - stability meets freedom-seeking.' },
        '2-6': { score: 90, meaning: 'Loving partnership - both nurturing and caring.' },
        '2-7': { score: 70, meaning: 'Quiet understanding - both appreciate depth and reflection.' },
        '2-8': { score: 55, meaning: 'Different energies - gentle meets powerful and ambitious.' },
        '2-9': { score: 85, meaning: 'Compassionate union - both serve others with love.' },
        '3-3': { score: 80, meaning: 'Creative explosion - lots of fun but may lack focus.' },
        '3-4': { score: 55, meaning: 'Different rhythms - spontaneous creativity meets methodical work.' },
        '3-5': { score: 95, meaning: 'Fun and freedom - both love variety and adventure.' },
        '3-6': { score: 85, meaning: 'Creative harmony - expression meets nurturing support.' },
        '3-7': { score: 65, meaning: 'Surface meets depth - social butterfly meets introspective soul.' },
        '3-8': { score: 70, meaning: 'Creative success - artistic talent meets business acumen.' },
        '3-9': { score: 90, meaning: 'Artistic service - creativity meets humanitarian ideals.' },
        '4-4': { score: 85, meaning: 'Solid foundation - both reliable and hardworking.' },
        '4-5': { score: 45, meaning: 'Opposite needs - security meets freedom and change.' },
        '4-6': { score: 90, meaning: 'Home and hearth - both value security and family.' },
        '4-7': { score: 75, meaning: 'Thoughtful building - practical meets analytical wisdom.' },
        '4-8': { score: 95, meaning: 'Material success - organized work meets business ambition.' },
        '4-9': { score: 70, meaning: 'Service structure - practical building meets humanitarian goals.' },
        '5-5': { score: 75, meaning: 'Double adventure - exciting but may lack stability.' },
        '5-6': { score: 60, meaning: 'Freedom meets responsibility - different life priorities.' },
        '5-7': { score: 65, meaning: 'Explorer meets seeker - both value independence differently.' },
        '5-8': { score: 70, meaning: 'Free spirit meets ambition - can work if 8 allows 5 freedom.' },
        '5-9': { score: 80, meaning: 'Worldly service - freedom to serve humanity together.' },
        '6-6': { score: 90, meaning: 'Pure love and nurturing - may become overly protective.' },
        '6-7': { score: 75, meaning: 'Caring wisdom - nurturing meets spiritual seeking.' },
        '6-8': { score: 70, meaning: 'Home meets ambition - family values meet material success.' },
        '6-9': { score: 95, meaning: 'Service and love - both dedicated to helping others.' },
        '7-7': { score: 80, meaning: 'Deep understanding - both seek truth and wisdom.' },
        '7-8': { score: 55, meaning: 'Different worlds - spiritual seeking meets material ambition.' },
        '7-9': { score: 85, meaning: 'Wisdom and service - analytical depth meets humanitarian heart.' },
        '8-8': { score: 85, meaning: 'Power partnership - both ambitious but may compete.' },
        '8-9': { score: 75, meaning: 'Success and service - material power meets humanitarian ideals.' },
        '9-9': { score: 90, meaning: 'Universal love - both serve humanity with compassion.' }
    };
    
    const key1 = `${num1}-${num2}`;
    const key2 = `${num2}-${num1}`;
    
    return compatMatrix[key1] || compatMatrix[key2] || { score: 70, meaning: 'Unique combination with its own gifts and challenges.' };
}

function calculateExpressionCompatibility(num1, num2) {
    // Simplified expression compatibility
    const diff = Math.abs(num1 - num2);
    if (diff === 0) return { score: 90, meaning: 'Identical talents and approaches to life.' };
    if (diff === 1) return { score: 85, meaning: 'Complementary abilities that enhance each other.' };
    if (diff === 2) return { score: 80, meaning: 'Different but harmonious expression styles.' };
    if (diff <= 4) return { score: 70, meaning: 'Some differences but can work well together.' };
    return { score: 60, meaning: 'Very different expression styles requiring understanding.' };
}

function calculateSoulUrgeCompatibility(num1, num2) {
    // Simplified soul urge compatibility
    const compatible = [num1, num2].sort().join('-');
    const highCompat = ['1-8', '2-6', '3-9', '4-8', '5-7', '6-9'];
    const medCompat = ['1-3', '1-5', '2-4', '2-9', '3-6', '4-6', '5-9', '7-9'];
    
    if (num1 === num2) return { score: 95, meaning: 'Identical heart desires create deep understanding.' };
    if (highCompat.includes(compatible)) return { score: 85, meaning: 'Highly compatible heart desires.' };
    if (medCompat.includes(compatible)) return { score: 75, meaning: 'Moderately compatible heart desires.' };
    return { score: 65, meaning: 'Different heart desires requiring compromise.' };
}

function getOverallCompatibility(score) {
    if (score >= 85) return 'Excellent Match - Natural harmony and deep understanding.';
    if (score >= 75) return 'Very Good Match - Strong compatibility with minor adjustments needed.';
    if (score >= 65) return 'Good Match - Compatible with effort and understanding from both sides.';
    if (score >= 55) return 'Challenging Match - Requires significant work but can succeed with commitment.';
    return 'Difficult Match - Major differences requiring exceptional understanding and compromise.';
}

// Personal Year Interpretations
const PERSONAL_YEAR_MEANINGS = {
    1: { theme: "New Beginnings", focus: "Start new projects, take leadership, be independent", energy: "Pioneering and ambitious" },
    2: { theme: "Cooperation & Patience", focus: "Work in partnerships, be diplomatic, pay attention to details", energy: "Gentle and collaborative" },
    3: { theme: "Creative Expression", focus: "Express yourself, socialize, develop talents", energy: "Joyful and communicative" },
    4: { theme: "Hard Work & Building", focus: "Work systematically, build foundations, be practical", energy: "Steady and disciplined" },
    5: { theme: "Freedom & Change", focus: "Embrace change, travel, seek variety and adventure", energy: "Dynamic and exploratory" },
    6: { theme: "Love & Responsibility", focus: "Focus on family, home, and community service", energy: "Nurturing and caring" },
    7: { theme: "Spiritual Development", focus: "Study, reflect, develop inner wisdom", energy: "Introspective and analytical" },
    8: { theme: "Material Success", focus: "Focus on career, money, and material achievement", energy: "Ambitious and organized" },
    9: { theme: "Completion & Service", focus: "Complete projects, serve others, prepare for new cycle", energy: "Humanitarian and wise" }
};

// Main Enhanced Numerology Function
function calculateEnhancedNumerology() {
    const name = document.getElementById('numerology-name').value.trim();
    const currentName = document.getElementById('numerology-current-name').value.trim();
    const dob = document.getElementById('numerology-dob').value;
    const readingType = document.getElementById('numerology-reading-type').value;
    
    if (!name || !dob) {
        alert('Please enter your full name and date of birth');
        return;
    }
    
    // Show reading type specific sections
    const readingTypeSelect = document.getElementById('numerology-reading-type');
    const partnerInfo = document.getElementById('partner-info');
    
    if (readingType === 'compatibility') {
        partnerInfo.classList.remove('hidden');
        const partnerName = document.getElementById('partner-name').value.trim();
        const partnerDob = document.getElementById('partner-dob').value;
        
        if (!partnerName || !partnerDob) {
            alert('Please enter partner information for compatibility analysis');
            return;
        }
        
        // Calculate compatibility
        const person1 = calculateAllNumbers(name, dob);
        const person2 = calculateAllNumbers(partnerName, partnerDob);
        const compatibility = calculateCompatibility(person1, person2);
        
        displayCompatibilityAnalysis(person1, person2, compatibility);
    } else {
        partnerInfo.classList.add('hidden');
        
        // Calculate main person's numbers
        const numbers = calculateAllNumbers(name, dob);
        const currentNumbers = currentName ? calculateAllNumbers(currentName, dob) : null;
        
        // Display results based on reading type
        if (readingType === 'complete') {
            displayCompleteNumerologyProfile(numbers, currentNumbers);
        } else {
            displayCoreNumbers(numbers);
        }
    }
}

// Display Functions
function displayCompleteNumerologyProfile(numbers, currentNumbers) {
    displayNumerologyDashboard(numbers);
    displayDetailedAnalysis(numbers);
    displayNameAnalysis(numbers.name);
    displayPersonalCycles(numbers);
    displayActionableGuidance(numbers);
    displayNameCorrection(numbers, currentNumbers);
    
    // Show all result sections
    document.getElementById('numerology-dashboard').classList.remove('hidden');
    document.getElementById('numerology-detailed').classList.remove('hidden');
    document.getElementById('numerology-name-analysis').classList.remove('hidden');
    document.getElementById('numerology-cycles').classList.remove('hidden');
    document.getElementById('numerology-guidance').classList.remove('hidden');
    document.getElementById('numerology-name-correction').classList.remove('hidden');
    
    // Scroll to results
    document.getElementById('numerology-dashboard').scrollIntoView({behavior: 'smooth', block: 'start'});
}

function displayCoreNumbers(numbers) {
    displayNumerologyDashboard(numbers);
    displayDetailedAnalysis(numbers);
    
    // Show only core sections
    document.getElementById('numerology-dashboard').classList.remove('hidden');
    document.getElementById('numerology-detailed').classList.remove('hidden');
    
    // Hide other sections
    document.getElementById('numerology-name-analysis').classList.add('hidden');
    document.getElementById('numerology-cycles').classList.add('hidden');
    document.getElementById('numerology-guidance').classList.add('hidden');
    document.getElementById('numerology-compatibility').classList.add('hidden');
    document.getElementById('numerology-name-correction').classList.add('hidden');
    
    document.getElementById('numerology-dashboard').scrollIntoView({behavior: 'smooth', block: 'start'});
}

function displayNumerologyDashboard(numbers) {
    const coreNumbers = [
        { name: 'Life Path', value: numbers.lifePath, description: 'Your soul\'s journey' },
        { name: 'Expression', value: numbers.expression, description: 'Your natural talents' },
        { name: 'Soul Urge', value: numbers.soulUrge, description: 'Your heart\'s desire' },
        { name: 'Personality', value: numbers.personality, description: 'How others see you' },
        { name: 'Maturity', value: numbers.maturity, description: 'Who you become' },
        { name: 'Birthday', value: numbers.birthday, description: 'Your special gift' },
        { name: 'Attitude', value: numbers.attitude, description: 'Your outlook' },
        { name: 'Personal Year', value: numbers.personalYear, description: 'Current cycle' }
    ];
    
    let html = '<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 16px; margin: 20px 0;">';
    
    coreNumbers.forEach((num, index) => {
        const bgColors = [
            'linear-gradient(135deg, #FF6B6B 0%, #FF8E53 100%)',
            'linear-gradient(135deg, #4ECDC4 0%, #45B7AF 100%)',
            'linear-gradient(135deg, #A8E6CF 0%, #7FCDCD 100%)',
            'linear-gradient(135deg, #FFD93D 0%, #FF6B6B 100%)',
            'linear-gradient(135deg, #6C5CE7 0%, #A29BFE 100%)',
            'linear-gradient(135deg, #FD79A8 0%, #E17055 100%)',
            'linear-gradient(135deg, #00CEC9 0%, #55A3FF 100%)',
            'linear-gradient(135deg, #FDCB6E 0%, #E17055 100%)'
        ];
        
        html += `
            <div style="text-align: center; padding: 20px; background: ${bgColors[index % 8]}; border-radius: 16px; color: white; box-shadow: 0 4px 15px rgba(0,0,0,0.1); cursor: pointer;" onclick="showNumberDetail('${num.name.toLowerCase()}', ${num.value})">
                <div style="font-size: 36px; font-weight: bold; margin-bottom: 8px;">${num.value}</div>
                <div style="font-size: 14px; font-weight: 600; margin-bottom: 4px;">${num.name}</div>
                <div style="font-size: 12px; opacity: 0.9;">${num.description}</div>
            </div>
        `;
    });
    
    html += '</div>';
    
    document.getElementById('numerology-grid').innerHTML = html;
}

function displayDetailedAnalysis(numbers) {
    const coreNumbers = ['lifePath', 'expression', 'soulUrge', 'personality'];
    
    let html = '';
    
    coreNumbers.forEach((numberType) => {
        const number = numbers[numberType];
        const meaning = NUMBER_MEANINGS[number];
        
        if (meaning) {
            const typeName = numberType.charAt(0).toUpperCase() + numberType.slice(1).replace(/([A-Z])/g, ' $1');
            
            html += `
                <div style="background: linear-gradient(135deg, #F8F9FA 0%, #E9ECEF 100%); padding: 24px; border-radius: 16px; margin: 20px 0; border-left: 6px solid #FF9933;">
                    <h3 style="color: #FF9933; margin-bottom: 16px; font-size: 20px;">${typeName} Number ${number}</h3>
                    <p style="color: #374151; line-height: 1.6; margin-bottom: 16px; font-size: 16px;">${meaning[numberType] || meaning.lifePath}</p>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-top: 16px;">
                        <div style="background: rgba(34, 197, 94, 0.1); padding: 16px; border-radius: 12px;">
                            <h4 style="color: #16A085; margin-bottom: 8px; font-size: 14px;">💪 Strengths</h4>
                            <p style="color: #374151; font-size: 13px; line-height: 1.5;">${meaning.strengths}</p>
                        </div>
                        <div style="background: rgba(239, 68, 68, 0.1); padding: 16px; border-radius: 12px;">
                            <h4 style="color: #E74C3C; margin-bottom: 8px; font-size: 14px;">⚠️ Challenges</h4>
                            <p style="color: #374151; font-size: 13px; line-height: 1.5;">${meaning.challenges}</p>
                        </div>
                    </div>
                </div>
            `;
        }
    });
    
    document.getElementById('numerology-details').innerHTML = html;
}

function displayNameAnalysis(name) {
    const analysis = analyzeNameStructure(name);
    
    let html = `
        <div style="background: linear-gradient(135deg, #E8F4FD 0%, #B8E6B8 100%); padding: 20px; border-radius: 16px; margin: 20px 0; border-left: 6px solid #3498DB;">
            <h3 style="color: #2980B9; margin-bottom: 16px;">📝 Name Blueprint Analysis</h3>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 16px;">
                <div style="background: white; padding: 16px; border-radius: 12px;">
                    <h4 style="color: #E74C3C; margin-bottom: 8px;">🚀 Cornerstone: ${analysis.cornerstone.letter}</h4>
                    <p style="color: #374151; font-size: 13px; margin-bottom: 8px;">${analysis.cornerstone.interpretation}</p>
                    <p style="color: #374151; font-size: 12px;">${analysis.cornerstone.meaning}</p>
                </div>
                
                <div style="background: white; padding: 16px; border-radius: 12px;">
                    <h4 style="color: #8E44AD; margin-bottom: 8px;">🏁 Capstone: ${analysis.capstone.letter}</h4>
                    <p style="color: #374151; font-size: 13px; margin-bottom: 8px;">${analysis.capstone.interpretation}</p>
                    <p style="color: #374151; font-size: 12px;">${analysis.capstone.meaning}</p>
                </div>
                
                <div style="background: white; padding: 16px; border-radius: 12px;">
                    <h4 style="color: #E67E22; margin-bottom: 8px;">💖 First Vowel: ${analysis.firstVowel.letter}</h4>
                    <p style="color: #374151; font-size: 13px; margin-bottom: 8px;">${analysis.firstVowel.interpretation}</p>
                    <p style="color: #374151; font-size: 12px;">${analysis.firstVowel.meaning}</p>
                </div>
            </div>
        </div>
    `;
    
    // Letter Frequency Analysis
    if (analysis.letterFrequency.length > 0) {
        html += `
            <div style="background: linear-gradient(135deg, #FFF3E0 0%, #FFE0B2 100%); padding: 20px; border-radius: 16px; margin: 20px 0; border-left: 6px solid #FF9800;">
                <h3 style="color: #F57C00; margin-bottom: 16px;">📤 Letter Frequency Emphasis</h3>
                <div style="display: flex; gap: 16px; flex-wrap: wrap;">
        `;
        
        analysis.letterFrequency.forEach(([letter, count]) => {
            html += `
                <div style="background: white; padding: 12px; border-radius: 8px; text-align: center; min-width: 80px;">
                    <div style="font-size: 24px; font-weight: bold; color: #FF9800;">${letter}</div>
                    <div style="font-size: 12px; color: #666;">appears ${count}x</div>
                    <div style="font-size: 10px; color: #999;">Number ${LETTER_VALUES[letter]}</div>
                </div>
            `;
        });
        
        html += '</div></div>';
    }
    
    // Missing Numbers (Karmic Lessons)
    if (analysis.missingNumbers.length > 0) {
        html += `
            <div style="background: linear-gradient(135deg, #FFEBEE 0%, #FFCDD2 100%); padding: 20px; border-radius: 16px; margin: 20px 0; border-left: 6px solid #F44336;">
                <h3 style="color: #D32F2F; margin-bottom: 16px;">🎯 Karmic Lessons (Missing Numbers)</h3>
                <p style="color: #374151; margin-bottom: 12px;">These numbers are absent from your name, representing areas for growth:</p>
                <div style="display: flex; gap: 12px; flex-wrap: wrap;">
        `;
        
        analysis.missingNumbers.forEach(num => {
            const lessons = {
                1: "Learn independence and leadership",
                2: "Develop cooperation and patience", 
                3: "Express creativity and communicate",
                4: "Build discipline and organization",
                5: "Embrace freedom and adventure",
                6: "Cultivate nurturing and responsibility",
                7: "Develop spirituality and analysis",
                8: "Learn material mastery and authority",
                9: "Practice compassion and service"
            };
            
            html += `
                <div style="background: white; padding: 12px; border-radius: 8px; flex: 1; min-width: 200px;">
                    <div style="font-size: 18px; font-weight: bold; color: #F44336; margin-bottom: 4px;">${num}</div>
                    <div style="font-size: 12px; color: #374151;">${lessons[num]}</div>
                </div>
            `;
        });
        
        html += '</div></div>';
    }
    
    document.getElementById('name-analysis-output').innerHTML = html;
}

function displayPersonalCycles(numbers) {
    const currentYear = new Date().getFullYear();
    const personalYearMeaning = PERSONAL_YEAR_MEANINGS[numbers.personalYear];
    
    let html = `
        <div style="background: linear-gradient(135deg, #F3E5F5 0%, #E1BEE7 100%); padding: 24px; border-radius: 16px; margin: 20px 0; border-left: 6px solid #9C27B0;">
            <h3 style="color: #7B1FA2; margin-bottom: 20px; font-size: 22px;">🔄 Your Current Life Cycle</h3>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">
                <div style="background: white; padding: 20px; border-radius: 12px; text-align: center;">
                    <div style="font-size: 42px; font-weight: bold; color: #9C27B0; margin-bottom: 8px;">${numbers.personalYear}</div>
                    <div style="font-size: 16px; font-weight: 600; color: #7B1FA2; margin-bottom: 8px;">Personal Year ${currentYear}</div>
                    <div style="font-size: 14px; color: #374151; margin-bottom: 8px;">${personalYearMeaning.theme}</div>
                    <div style="font-size: 12px; color: #666;">${personalYearMeaning.energy}</div>
                </div>
                
                <div style="background: white; padding: 20px; border-radius: 12px; text-align: center;">
                    <div style="font-size: 42px; font-weight: bold; color: #673AB7; margin-bottom: 8px;">${numbers.personalMonth}</div>
                    <div style="font-size: 16px; font-weight: 600; color: #512DA8; margin-bottom: 8px;">Personal Month</div>
                    <div style="font-size: 14px; color: #374151;">Current monthly cycle energy</div>
                </div>
                
                <div style="background: white; padding: 20px; border-radius: 12px; text-align: center;">
                    <div style="font-size: 42px; font-weight: bold; color: #3F51B5; margin-bottom: 8px;">${numbers.personalDay}</div>
                    <div style="font-size: 16px; font-weight: 600; color: #303F9F; margin-bottom: 8px;">Personal Day</div>
                    <div style="font-size: 14px; color: #374151;">Today's vibration energy</div>
                </div>
            </div>
        </div>
        
        <div style="background: linear-gradient(135deg, #E0F2F1 0%, #B2DFDB 100%); padding: 20px; border-radius: 16px; margin: 20px 0; border-left: 6px solid #009688;">
            <h3 style="color: #00695C; margin-bottom: 12px;">🎯 ${currentYear} Personal Year Focus</h3>
            <p style="color: #374151; line-height: 1.6; margin-bottom: 12px; font-size: 15px;">${personalYearMeaning.focus}</p>
            <p style="color: #00695C; font-weight: 600; font-size: 14px;">Key Energy: ${personalYearMeaning.energy}</p>
        </div>
    `;
    
    // Challenge Numbers
    html += `
        <div style="background: linear-gradient(135deg, #FFF8E1 0%, #FFECB3 100%); padding: 20px; border-radius: 16px; margin: 20px 0; border-left: 6px solid #FFC107;">
            <h3 style="color: #FF8F00; margin-bottom: 16px;">⛰️ Life Challenge Numbers</h3>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 12px;">
                <div style="background: white; padding: 12px; border-radius: 8px; text-align: center;">
                    <div style="font-size: 24px; font-weight: bold; color: #FF8F00;">${numbers.challenges.first}</div>
                    <div style="font-size: 12px; color: #666;">First Challenge</div>
                    <div style="font-size: 10px; color: #999;">Youth (0-35)</div>
                </div>
                <div style="background: white; padding: 12px; border-radius: 8px; text-align: center;">
                    <div style="font-size: 24px; font-weight: bold; color: #FF8F00;">${numbers.challenges.second}</div>
                    <div style="font-size: 12px; color: #666;">Second Challenge</div>
                    <div style="font-size: 10px; color: #999;">Maturity (28-55)</div>
                </div>
                <div style="background: white; padding: 12px; border-radius: 8px; text-align: center;">
                    <div style="font-size: 24px; font-weight: bold; color: #FF8F00;">${numbers.challenges.main}</div>
                    <div style="font-size: 12px; color: #666;">Main Challenge</div>
                    <div style="font-size: 10px; color: #999;">Lifetime Lesson</div>
                </div>
                <div style="background: white; padding: 12px; border-radius: 8px; text-align: center;">
                    <div style="font-size: 24px; font-weight: bold; color: #FF8F00;">${numbers.challenges.third}</div>
                    <div style="font-size: 12px; color: #666;">Third Challenge</div>
                    <div style="font-size: 10px; color: #999;">Later Life (55+)</div>
                </div>
            </div>
        </div>
    `;
    
    document.getElementById('cycles-output').innerHTML = html;
}

function displayCompatibilityAnalysis(person1, person2, compatibility) {
    let html = `
        <div style="background: linear-gradient(135deg, #FCE4EC 0%, #F8BBD9 100%); padding: 24px; border-radius: 16px; margin: 20px 0; border-left: 6px solid #E91E63;">
            <h3 style="color: #AD1457; margin-bottom: 20px; font-size: 22px;">💕 Relationship Compatibility Analysis</h3>
            
            <div style="text-align: center; margin-bottom: 20px;">
                <div style="font-size: 48px; font-weight: bold; color: #E91E63; margin-bottom: 8px;">${compatibility.overall.score}%</div>
                <div style="font-size: 18px; color: #AD1457; font-weight: 600;">${compatibility.overall.interpretation}</div>
            </div>
        </div>
        
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin: 20px 0;">
            <div style="background: linear-gradient(135deg, #E3F2FD 0%, #BBDEFB 100%); padding: 20px; border-radius: 16px; border-left: 6px solid #2196F3;">
                <h4 style="color: #1565C0; margin-bottom: 12px;">${person1.name}</h4>
                <div style="font-size: 14px; color: #374151; line-height: 1.5;">
                    <p><strong>Life Path:</strong> ${person1.lifePath} - ${NUMBER_MEANINGS[person1.lifePath] ? NUMBER_MEANINGS[person1.lifePath].lifePath.substring(0, 100) + '...' : 'Unique path'}</p>
                    <p><strong>Expression:</strong> ${person1.expression}</p>
                    <p><strong>Soul Urge:</strong> ${person1.soulUrge}</p>
                </div>
            </div>
            
            <div style="background: linear-gradient(135deg, #F3E5F5 0%, #E1BEE7 100%); padding: 20px; border-radius: 16px; border-left: 6px solid #9C27B0;">
                <h4 style="color: #7B1FA2; margin-bottom: 12px;">${person2.name}</h4>
                <div style="font-size: 14px; color: #374151; line-height: 1.5;">
                    <p><strong>Life Path:</strong> ${person2.lifePath} - ${NUMBER_MEANINGS[person2.lifePath] ? NUMBER_MEANINGS[person2.lifePath].lifePath.substring(0, 100) + '...' : 'Unique path'}</p>
                    <p><strong>Expression:</strong> ${person2.expression}</p>
                    <p><strong>Soul Urge:</strong> ${person2.soulUrge}</p>
                </div>
            </div>
        </div>
        
        <div style="background: linear-gradient(135deg, #FFF3E0 0%, #FFE0B2 100%); padding: 20px; border-radius: 16px; margin: 20px 0; border-left: 6px solid #FF9800;">
            <h4 style="color: #F57C00; margin-bottom: 16px;">🔍 Detailed Compatibility Breakdown</h4>
            
            <div style="margin-bottom: 16px;">
                <h5 style="color: #E65100; margin-bottom: 8px;">💫 Life Path Compatibility (${compatibility.lifePath.score}%)</h5>
                <p style="color: #374151; font-size: 14px; line-height: 1.5;">${compatibility.lifePath.meaning}</p>
            </div>
            
            <div style="margin-bottom: 16px;">
                <h5 style="color: #E65100; margin-bottom: 8px;">🎨 Expression Compatibility (${compatibility.expression.score}%)</h5>
                <p style="color: #374151; font-size: 14px; line-height: 1.5;">${compatibility.expression.meaning}</p>
            </div>
            
            <div>
                <h5 style="color: #E65100; margin-bottom: 8px;">💖 Soul Urge Compatibility (${compatibility.soulUrge.score}%)</h5>
                <p style="color: #374151; font-size: 14px; line-height: 1.5;">${compatibility.soulUrge.meaning}</p>
            </div>
        </div>
    `;
    
    document.getElementById('compatibility-output').innerHTML = html;
    document.getElementById('numerology-compatibility').classList.remove('hidden');
    
    // Hide other sections for compatibility reading
    document.getElementById('numerology-dashboard').classList.add('hidden');
    document.getElementById('numerology-detailed').classList.add('hidden');
    document.getElementById('numerology-name-analysis').classList.add('hidden');
    document.getElementById('numerology-cycles').classList.add('hidden');
    document.getElementById('numerology-guidance').classList.add('hidden');
    document.getElementById('numerology-name-correction').classList.add('hidden');
    
    document.getElementById('numerology-compatibility').scrollIntoView({behavior: 'smooth', block: 'start'});
}

function displayActionableGuidance(numbers) {
    const lifePath = NUMBER_MEANINGS[numbers.lifePath];
    const personalYearMeaning = PERSONAL_YEAR_MEANINGS[numbers.personalYear];
    
    let html = `
        <div style="background: linear-gradient(135deg, #E8F5E8 0%, #C8E6C9 100%); padding: 24px; border-radius: 16px; margin: 20px 0; border-left: 6px solid #4CAF50;">
            <h3 style="color: #2E7D32; margin-bottom: 20px; font-size: 22px;">🎯 Your Personal Action Plan</h3>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 16px;">
                <div style="background: white; padding: 20px; border-radius: 12px;">
                    <h4 style="color: #388E3C; margin-bottom: 12px; font-size: 16px;">💪 Strengths to Leverage</h4>
                    <p style="color: #374151; font-size: 14px; line-height: 1.5;">${lifePath ? lifePath.strengths : 'Natural abilities and talents'}</p>
                </div>
                
                <div style="background: white; padding: 20px; border-radius: 12px;">
                    <h4 style="color: #F57C00; margin-bottom: 12px; font-size: 16px;">⚠️ Challenges to Overcome</h4>
                    <p style="color: #374151; font-size: 14px; line-height: 1.5;">${lifePath ? lifePath.challenges : 'Areas for growth and development'}</p>
                </div>
                
                <div style="background: white; padding: 20px; border-radius: 12px;">
                    <h4 style="color: #7B1FA2; margin-bottom: 12px; font-size: 16px;">💼 Career Paths</h4>
                    <p style="color: #374151; font-size: 14px; line-height: 1.5;">${lifePath ? lifePath.careers : 'Suitable professional directions'}</p>
                </div>
                
                <div style="background: white; padding: 20px; border-radius: 12px;">
                    <h4 style="color: #E91E63; margin-bottom: 12px; font-size: 16px;">💕 Relationship Patterns</h4>
                    <p style="color: #374151; font-size: 14px; line-height: 1.5;">${lifePath ? lifePath.relationships : 'How you relate to others'}</p>
                </div>
            </div>
        </div>
        
        <div style="background: linear-gradient(135deg, #E1F5FE 0%, #B3E5FC 100%); padding: 20px; border-radius: 16px; margin: 20px 0; border-left: 6px solid #03A9F4;">
            <h4 style="color: #0277BD; margin-bottom: 16px;">🌟 Your Life Purpose</h4>
            <p style="color: #374151; font-size: 15px; line-height: 1.6; margin-bottom: 12px;">${lifePath ? lifePath.spiritualLesson : 'Your unique spiritual journey and lessons'}</p>
        </div>
    `;
    
    // Lucky Elements
    if (lifePath && lifePath.luckyNumbers) {
        html += `
            <div style="background: linear-gradient(135deg, #FFF9C4 0%, #F0F4C3 100%); padding: 20px; border-radius: 16px; margin: 20px 0; border-left: 6px solid #CDDC39;">
                <h4 style="color: #827717; margin-bottom: 16px;">🍀 Your Lucky Elements</h4>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 12px;">
                    <div style="background: white; padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 14px; font-weight: 600; color: #827717; margin-bottom: 4px;">Numbers</div>
                        <div style="font-size: 12px; color: #374151;">${lifePath.luckyNumbers.join(', ')}</div>
                    </div>
                    
                    <div style="background: white; padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 14px; font-weight: 600; color: #827717; margin-bottom: 4px;">Colors</div>
                        <div style="font-size: 12px; color: #374151;">${lifePath.luckyColors.join(', ')}</div>
                    </div>
                    
                    <div style="background: white; padding: 12px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 14px; font-weight: 600; color: #827717; margin-bottom: 4px;">Days</div>
                        <div style="font-size: 12px; color: #374151;">${lifePath.luckyDays.join(', ')}</div>
                    </div>
                </div>
            </div>
        `;
    }
    
    // Current Year Action Steps
    html += `
        <div style="background: linear-gradient(135deg, #FFEBEE 0%, #FFCDD2 100%); padding: 20px; border-radius: 16px; margin: 20px 0; border-left: 6px solid #F44336;">
            <h4 style="color: #C62828; margin-bottom: 16px;">🎯 ${new Date().getFullYear()} Action Steps</h4>
            <p style="color: #374151; font-size: 15px; line-height: 1.6; margin-bottom: 12px;"><strong>Focus Area:</strong> ${personalYearMeaning.theme}</p>
            <p style="color: #374151; font-size: 14px; line-height: 1.6;"><strong>Key Actions:</strong> ${personalYearMeaning.focus}</p>
        </div>
    `;
    
    document.getElementById('guidance-output').innerHTML = html;
}

// Show reading type selection handler
document.getElementById('numerology-reading-type').addEventListener('change', function() {
    const partnerInfo = document.getElementById('partner-info');
    if (this.value === 'compatibility') {
        partnerInfo.classList.remove('hidden');
    } else {
        partnerInfo.classList.add('hidden');
    }
});

// Number detail popup (simplified)
function showNumberDetail(type, number) {
    const meaning = NUMBER_MEANINGS[number];
    if (meaning) {
        alert(`${type.charAt(0).toUpperCase() + type.slice(1)} ${number}\n\n${meaning[type] || meaning.lifePath}`);
    }
}

// NAME CORRECTION & OPTIMIZATION SYSTEM

// Analyze current name vibration and identify issues
function analyzeNameVibration(birthName, currentName, lifePath) {
    const currentExpression = calculateExpression(currentName || birthName);
    const birthExpression = calculateExpression(birthName);
    const alignment = checkNameAlignment(currentExpression, lifePath);
    const issues = identifyNameIssues(currentName || birthName, lifePath);
    const missingNumbers = findMissingNumbers(currentName || birthName);
    const karmicDebt = checkKarmicDebt(currentExpression);
    const harmonyScore = calculateHarmonyScore(currentName || birthName, lifePath);
    
    return {
        currentExpression,
        birthExpression,
        alignment,
        issues,
        missingNumbers,
        karmicDebt,
        harmonyScore
    };
}

// Check if name aligns with life path
function checkNameAlignment(expression, lifePath) {
    const compatible = {
        1: [1, 3, 5, 9],
        2: [2, 4, 6, 8],
        3: [1, 3, 5, 6, 9],
        4: [2, 4, 6, 7, 8],
        5: [1, 3, 5, 7, 9],
        6: [2, 3, 4, 6, 8, 9],
        7: [4, 5, 7],
        8: [2, 4, 6, 8],
        9: [1, 3, 5, 6, 9],
        11: [1, 2, 7, 9, 11],
        22: [4, 6, 8, 22],
        33: [6, 9, 33]
    };
    
    if (compatible[lifePath] && compatible[lifePath].includes(expression)) {
        return {
            status: "Aligned",
            message: "Your name supports your life path beautifully! Good harmony between name and destiny.",
            score: 85 + Math.floor(Math.random() * 15)
        };
    } else {
        return {
            status: "Misaligned", 
            message: "Your name creates friction with your life path. Correction recommended for better flow.",
            score: 35 + Math.floor(Math.random() * 20)
        };
    }
}

// Identify specific name issues
function identifyNameIssues(name, lifePath) {
    const issues = [];
    const expression = calculateExpression(name);
    const missingNumbers = findMissingNumbers(name);
    
    // Check for karmic debt numbers (13, 14, 16, 19)
    const karmicNumbers = [13, 14, 16, 19];
    const nameValue = calculateNameValue(name);
    if (karmicNumbers.includes(nameValue)) {
        issues.push(`Karmic debt number ${nameValue} present - requires extra effort to overcome past-life lessons`);
    }
    
    // Check for missing important numbers
    if (missingNumbers.includes(8)) {
        issues.push("Missing number 8 - may struggle with material success and authority");
    }
    if (missingNumbers.includes(1)) {
        issues.push("Missing number 1 - may lack leadership confidence and independence");
    }
    if (missingNumbers.includes(6)) {
        issues.push("Missing number 6 - may struggle with responsibility and nurturing");
    }
    
    // Check for vowel-consonant imbalance
    const soulUrge = calculateSoulUrge(name);
    const personality = calculatePersonality(name);
    const diff = Math.abs(soulUrge - personality);
    
    if (diff > 5) {
        issues.push("Imbalance between inner desires and outer personality - may feel misunderstood");
    }
    
    // Check for name length issues
    const cleanName = name.replace(/[^A-Za-z]/g, '');
    if (cleanName.length < 6) {
        issues.push("Name may be too short - consider adding middle name or initial for more power");
    }
    
    return issues.length > 0 ? issues : ['Your name has good energy flow with minor optimization possible'];
}

// Calculate name value for karmic debt check
function calculateNameValue(name) {
    let sum = 0;
    for (let char of name.toUpperCase().replace(/[^A-Z]/g, '')) {
        if (LETTER_VALUES[char]) sum += LETTER_VALUES[char];
    }
    return sum;
}

// Check for karmic debt in expression number
function checkKarmicDebt(expression) {
    const karmicNumbers = [13, 14, 16, 19];
    return {
        hasKarmicDebt: karmicNumbers.includes(expression),
        debt: karmicNumbers.includes(expression) ? expression : null,
        meaning: getKarmicDebtMeaning(expression)
    };
}

// Get karmic debt meanings
function getKarmicDebtMeaning(number) {
    const meanings = {
        13: "Karmic debt of laziness and selfishness in past lives. Must work hard and help others.",
        14: "Karmic debt of abuse of freedom. Must learn moderation and responsibility.", 
        16: "Karmic debt of destructive love affairs. Must learn humble service and spiritual growth.",
        19: "Karmic debt of abuse of power. Must learn to serve humanity rather than dominate."
    };
    return meanings[number] || null;
}

// Calculate harmony score between name and life path
function calculateHarmonyScore(name, lifePath) {
    const expression = calculateExpression(name);
    const alignment = checkNameAlignment(expression, lifePath);
    const missingNumbers = findMissingNumbers(name);
    const issues = identifyNameIssues(name, lifePath);
    
    let score = alignment.score;
    
    // Deduct for missing important numbers
    score -= missingNumbers.length * 3;
    
    // Deduct for issues
    score -= issues.length * 5;
    
    // Ensure score is between 0-100
    score = Math.max(0, Math.min(100, score));
    
    return score;
}

// Generate intelligent name suggestions
function generateNameSuggestions(currentName, lifePath, desiredOutcome) {
    const suggestions = [];
    
    // Goal-based target numbers
    const targetNumbers = {
        'wealth': [8, 6, 4, 22],
        'success': [1, 8, 22, 3],
        'creativity': [3, 5, 6, 33],
        'spirituality': [7, 9, 11, 33],
        'leadership': [1, 8, 22, 10],
        'harmony': [2, 6, 9, 11],
        'communication': [3, 5, 14],
        'stability': [4, 6, 8, 13]
    };
    
    const targets = targetNumbers[desiredOutcome] || [lifePath];
    
    // Generate different types of suggestions
    for (let target of targets.slice(0, 2)) { // Limit to 2 target numbers
        // Spelling variations
        const spellingVariations = generateSpellingVariations(currentName, target);
        suggestions.push(...spellingVariations.slice(0, 2));
        
        // Letter additions
        const letterAdditions = generateLetterAdditions(currentName, target);
        suggestions.push(...letterAdditions.slice(0, 2));
        
        // Middle name suggestions
        const middleNameSuggestions = generateMiddleNameSuggestions(currentName, target);
        suggestions.push(...middleNameSuggestions.slice(0, 1));
    }
    
    // Rank and return top suggestions
    return rankSuggestions(suggestions, lifePath).slice(0, 5);
}

// Generate spelling variations
function generateSpellingVariations(name, targetNumber) {
    const variations = [];
    const parts = name.split(' ');
    const firstName = parts[0];
    const lastName = parts.slice(1).join(' ');
    
    // Try common spelling changes
    const spellingMap = {
        'V': 'W', 'W': 'V', 'C': 'K', 'K': 'C', 'PH': 'F', 'F': 'PH',
        'S': 'Z', 'Z': 'S', 'I': 'Y', 'Y': 'I', 'A': 'AA', 'E': 'EE'
    };
    
    for (let [from, to] of Object.entries(spellingMap)) {
        if (firstName.includes(from)) {
            const newFirstName = firstName.replace(from, to);
            const newName = newFirstName + (lastName ? ' ' + lastName : '');
            const newExpression = calculateExpression(newName);
            
            if (newExpression === targetNumber) {
                variations.push({
                    name: newName,
                    expression: targetNumber,
                    change: `Change "${from}" to "${to}" in first name`,
                    impact: "Medium",
                    type: "Spelling Change",
                    benefits: getNumberBenefits(targetNumber),
                    effort: "Low - just spelling change",
                    effectiveness: calculateEffectiveness(newName, targetNumber)
                });
            }
        }
    }
    
    return variations;
}

// Generate letter additions
function generateLetterAdditions(name, targetNumber) {
    const additions = [];
    const parts = name.split(' ');
    const addLetters = ['A', 'I', 'K', 'R', 'S', 'T', 'H', 'N', 'M'];
    
    for (let letter of addLetters) {
        // Try adding to end of first name
        const newName = parts[0] + letter + (parts.slice(1).length > 0 ? ' ' + parts.slice(1).join(' ') : '');
        const newExpression = calculateExpression(newName);
        
        if (newExpression === targetNumber) {
            additions.push({
                name: newName,
                expression: targetNumber,
                change: `Add "${letter}" to end of first name`,
                impact: "Medium",
                type: "Letter Addition",
                benefits: getNumberBenefits(targetNumber),
                effort: "Low - minor addition",
                effectiveness: calculateEffectiveness(newName, targetNumber)
            });
        }
        
        // Try adding to beginning of first name
        const newName2 = letter + parts[0] + (parts.slice(1).length > 0 ? ' ' + parts.slice(1).join(' ') : '');
        const newExpression2 = calculateExpression(newName2);
        
        if (newExpression2 === targetNumber) {
            additions.push({
                name: newName2,
                expression: targetNumber,
                change: `Add "${letter}" to beginning of first name`, 
                impact: "High",
                type: "Letter Addition",
                benefits: getNumberBenefits(targetNumber),
                effort: "Medium - changes pronunciation",
                effectiveness: calculateEffectiveness(newName2, targetNumber)
            });
        }
    }
    
    return additions;
}

// Generate middle name suggestions
function generateMiddleNameSuggestions(name, targetNumber) {
    const suggestions = [];
    const middleInitials = ['A', 'K', 'R', 'S', 'M', 'N', 'D', 'J', 'L', 'V'];
    const parts = name.split(' ');
    
    for (let initial of middleInitials) {
        const newName = parts[0] + ' ' + initial + (parts.slice(1).length > 0 ? ' ' + parts.slice(1).join(' ') : '');
        const newExpression = calculateExpression(newName);
        
        if (newExpression === targetNumber) {
            suggestions.push({
                name: newName,
                expression: targetNumber,
                change: `Add "${initial}" as middle initial`,
                impact: "High",
                type: "Middle Initial",
                benefits: getNumberBenefits(targetNumber),
                effort: "Medium - signature change",
                effectiveness: calculateEffectiveness(newName, targetNumber)
            });
        }
    }
    
    return suggestions;
}

// Get benefits for target numbers
function getNumberBenefits(number) {
    const benefits = {
        1: ["Enhanced leadership", "Greater independence", "Pioneering opportunities"],
        2: ["Better cooperation", "Enhanced diplomacy", "Stronger partnerships"],
        3: ["Increased creativity", "Better communication", "More joy and optimism"],
        4: ["Greater stability", "Enhanced organization", "Stronger foundation"],
        5: ["More freedom", "Enhanced adaptability", "Greater adventure"],
        6: ["Stronger nurturing", "Better relationships", "Enhanced responsibility"],
        7: ["Deeper wisdom", "Enhanced intuition", "Spiritual growth"],
        8: ["Material success", "Enhanced authority", "Business achievements"],
        9: ["Humanitarian service", "Universal love", "Completion energy"],
        11: ["Spiritual inspiration", "Intuitive gifts", "Higher consciousness"],
        22: ["Master building", "Manifestation power", "Global influence"],
        33: ["Master healing", "Unconditional love", "Spiritual teaching"]
    };
    return benefits[number] || ["Balanced energy", "Harmonious vibration", "Personal growth"];
}

// Calculate effectiveness score
function calculateEffectiveness(name, targetNumber) {
    const score = 60 + Math.floor(Math.random() * 30); // 60-90
    return score;
}

// Rank suggestions by effectiveness
function rankSuggestions(suggestions, lifePath) {
    return suggestions.sort((a, b) => {
        // Prioritize by effectiveness score
        if (a.effectiveness !== b.effectiveness) {
            return b.effectiveness - a.effectiveness;
        }
        // Then by impact level
        const impactOrder = {"High": 3, "Medium": 2, "Low": 1};
        return impactOrder[b.impact] - impactOrder[a.impact];
    });
}

// Generate goal-specific name recommendations
function generateGoalSpecificName(name, goal) {
    const goalTargets = {
        wealth: { number: 8, description: "Material success and authority" },
        success: { number: 1, description: "Leadership and achievement" },
        spirituality: { number: 7, description: "Wisdom and spiritual growth" },
        creativity: { number: 3, description: "Creative expression and joy" },
        relationships: { number: 6, description: "Love and harmony" },
        stability: { number: 4, description: "Security and foundation" }
    };
    
    const target = goalTargets[goal];
    if (!target) return null;
    
    const suggestions = generateNameSuggestions(name, target.number, goal);
    return {
        goal: goal,
        targetNumber: target.number,
        description: target.description,
        suggestions: suggestions.slice(0, 3)
    };
}

// Main name correction display function
function displayNameCorrection(numbers, currentNumbers) {
    const birthName = numbers.name;
    const currentName = currentNumbers ? currentNumbers.name : null;
    const nameToAnalyze = currentName || birthName;
    
    // Analyze current name vibration
    const analysis = analyzeNameVibration(birthName, nameToAnalyze, numbers.lifePath);
    
    // Generate suggestions for different goals
    const wealthSuggestions = generateGoalSpecificName(nameToAnalyze, 'wealth');
    const successSuggestions = generateGoalSpecificName(nameToAnalyze, 'success');
    const spiritualSuggestions = generateGoalSpecificName(nameToAnalyze, 'spirituality');
    
    let html = `
        <div style="background: linear-gradient(135deg, #E8F4FD 0%, #B8E6B8 100%); padding: 24px; border-radius: 16px; margin: 20px 0; border-left: 6px solid #2196F3;">
            <h3 style="color: #1565C0; margin-bottom: 16px; font-size: 22px;">🔍 Current Name Analysis</h3>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 20px;">
                <div style="background: white; padding: 16px; border-radius: 12px; text-align: center;">
                    <div style="font-size: 32px; font-weight: bold; color: ${analysis.alignment.status === 'Aligned' ? '#4CAF50' : '#F44336'}; margin-bottom: 8px;">${analysis.harmonyScore}%</div>
                    <div style="font-size: 14px; color: #666;">Harmony Score</div>
                    <div style="font-size: 12px; color: #999; margin-top: 4px;">${analysis.alignment.status}</div>
                </div>
                
                <div style="background: white; padding: 16px; border-radius: 12px; text-align: center;">
                    <div style="font-size: 32px; font-weight: bold; color: #2196F3; margin-bottom: 8px;">${analysis.currentExpression}</div>
                    <div style="font-size: 14px; color: #666;">Expression Number</div>
                    <div style="font-size: 12px; color: #999; margin-top: 4px;">Current vibration</div>
                </div>
                
                <div style="background: white; padding: 16px; border-radius: 12px; text-align: center;">
                    <div style="font-size: 32px; font-weight: bold; color: ${analysis.issues.length > 2 ? '#F44336' : '#FF9800'}; margin-bottom: 8px;">${analysis.issues.length}</div>
                    <div style="font-size: 14px; color: #666;">Issues Found</div>
                    <div style="font-size: 12px; color: #999; margin-top: 4px;">Areas to improve</div>
                </div>
            </div>
            
            <div style="background: rgba(33, 150, 243, 0.1); padding: 16px; border-radius: 12px;">
                <h4 style="color: #1976D2; margin-bottom: 12px; font-size: 16px;">📊 Alignment Status</h4>
                <p style="color: #1565C0; line-height: 1.6; margin: 0;">${analysis.alignment.message}</p>
            </div>
        </div>
    `;
    
    // Current Name Issues
    if (analysis.issues.length > 0) {
        html += `
            <div style="background: linear-gradient(135deg, #FFF3E0 0%, #FFE0B2 100%); padding: 20px; border-radius: 16px; margin: 20px 0; border-left: 6px solid #FF9800;">
                <h3 style="color: #F57C00; margin-bottom: 16px; font-size: 20px;">⚠️ Current Name Issues</h3>
                <ul style="margin: 0; padding-left: 20px;">
        `;
        
        analysis.issues.forEach(issue => {
            html += `<li style="color: #E65100; line-height: 1.6; margin-bottom: 8px;">${issue}</li>`;
        });
        
        html += `</ul></div>`;
    }
    
    // Goal-Based Name Suggestions
    html += `
        <div style="background: linear-gradient(135deg, #F3E5F5 0%, #E1BEE7 100%); padding: 24px; border-radius: 16px; margin: 20px 0; border-left: 6px solid #9C27B0;">
            <h3 style="color: #7B1FA2; margin-bottom: 20px; font-size: 22px;">✨ Name Optimization Suggestions</h3>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
    `;
    
    // Wealth Suggestions
    if (wealthSuggestions && wealthSuggestions.suggestions.length > 0) {
        html += createGoalSuggestionCard('💰 For Wealth & Success', wealthSuggestions, '#4CAF50');
    }
    
    // Success Suggestions  
    if (successSuggestions && successSuggestions.suggestions.length > 0) {
        html += createGoalSuggestionCard('🏆 For Leadership & Achievement', successSuggestions, '#FF9800');
    }
    
    // Spiritual Suggestions
    if (spiritualSuggestions && spiritualSuggestions.suggestions.length > 0) {
        html += createGoalSuggestionCard('🧘 For Spiritual Growth', spiritualSuggestions, '#9C27B0');
    }
    
    html += `</div></div>`;
    
    // Before/After Comparison
    if (wealthSuggestions && wealthSuggestions.suggestions.length > 0) {
        const topSuggestion = wealthSuggestions.suggestions[0];
        html += createBeforeAfterComparison(nameToAnalyze, topSuggestion, analysis);
    }
    
    // Implementation Guide
    html += createImplementationGuide();
    
    document.getElementById('name-correction-output').innerHTML = html;
}

// Create goal suggestion card
function createGoalSuggestionCard(title, goalData, color) {
    let cardHtml = `
        <div style="background: white; padding: 20px; border-radius: 16px; border: 2px solid ${color};">
            <h4 style="color: ${color}; margin-bottom: 16px; font-size: 18px;">${title}</h4>
            <p style="color: #666; margin-bottom: 16px; font-size: 14px;">Target: Expression ${goalData.targetNumber} - ${goalData.description}</p>
    `;
    
    goalData.suggestions.forEach((suggestion, index) => {
        if (index < 2) { // Show only top 2 suggestions per goal
            cardHtml += `
                <div style="background: rgba(${getColorRGB(color)}, 0.1); padding: 12px; border-radius: 8px; margin-bottom: 12px;">
                    <div style="font-weight: 600; color: ${color}; margin-bottom: 8px;">${suggestion.name}</div>
                    <div style="font-size: 12px; color: #666; margin-bottom: 4px;">${suggestion.change}</div>
                    <div style="font-size: 11px; color: #999;">Effectiveness: ${suggestion.effectiveness}% • ${suggestion.effort}</div>
                </div>
            `;
        }
    });
    
    cardHtml += `</div>`;
    return cardHtml;
}

// Get color RGB values
function getColorRGB(color) {
    const colorMap = {
        '#4CAF50': '76, 175, 80',
        '#FF9800': '255, 152, 0', 
        '#9C27B0': '156, 39, 176',
        '#2196F3': '33, 150, 243',
        '#F44336': '244, 67, 54'
    };
    return colorMap[color] || '128, 128, 128';
}

// Create before/after comparison
function createBeforeAfterComparison(currentName, suggestion, analysis) {
    let html = '<div style="background: linear-gradient(135deg, #E8F5E8 0%, #C8E6C9 100%); padding: 24px; border-radius: 16px; margin: 20px 0; border-left: 6px solid #4CAF50;">';
    html += '<h3 style="color: #2E7D32; margin-bottom: 20px; font-size: 22px;">📊 Before &amp; After Comparison</h3>';
    
    html += '<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">';
    html += '<div style="background: white; padding: 20px; border-radius: 12px; border: 2px solid #F44336;">';
    html += '<h4 style="color: #D32F2F; margin-bottom: 12px; text-align: center;">❌ BEFORE</h4>';
    html += '<div style="text-align: center; margin-bottom: 16px;">';
    html += '<div style="font-size: 18px; font-weight: 600; margin-bottom: 4px;">' + currentName + '</div>';
    html += '<div style="font-size: 14px; color: #666;">Expression: ' + analysis.currentExpression + '</div>';
    html += '</div>';
    html += '<div style="font-size: 12px; color: #D32F2F; text-align: center;">';
    html += 'Harmony Score: ' + analysis.harmonyScore + '%<br>';
    html += 'Status: ' + analysis.alignment.status;
    html += '</div></div>';
    
    html += '<div style="background: white; padding: 20px; border-radius: 12px; border: 2px solid #4CAF50;">';
    html += '<h4 style="color: #2E7D32; margin-bottom: 12px; text-align: center;">✅ AFTER</h4>';
    html += '<div style="text-align: center; margin-bottom: 16px;">';
    html += '<div style="font-size: 18px; font-weight: 600; margin-bottom: 4px;">' + suggestion.name + '</div>';
    html += '<div style="font-size: 14px; color: #666;">Expression: ' + suggestion.expression + '</div>';
    html += '</div>';
    html += '<div style="font-size: 12px; color: #2E7D32; text-align: center;">';
    html += 'Effectiveness: ' + suggestion.effectiveness + '%<br>';
    html += 'Change: ' + suggestion.change;
    html += '</div></div></div>';
    
    html += '<div style="background: rgba(76, 175, 80, 0.1); padding: 16px; border-radius: 12px; margin-top: 20px;">';
    html += '<h4 style="color: #2E7D32; margin-bottom: 8px; font-size: 16px;">📈 Expected Benefits</h4>';
    html += '<ul style="margin: 0; padding-left: 20px; color: #1B5E20;">';
    
    suggestion.benefits.forEach(benefit => {
        html += '<li style="line-height: 1.5; margin-bottom: 4px;">' + benefit + '</li>';
    });
    
    html += '</ul></div></div>';
    
    return html;
}

// Create implementation guide
function createImplementationGuide() {
    let html = '<div style="background: linear-gradient(135deg, #FDF4FF 0%, #E0E7FF 100%); padding: 24px; border-radius: 16px; margin: 20px 0; border-left: 6px solid #8B5CF6;">';
    html += '<h3 style="color: #7C3AED; margin-bottom: 20px; font-size: 22px;">🎯 Implementation Steps</h3>';
    
    html += '<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 20px;">';
    html += '<div style="background: white; padding: 16px; border-radius: 12px;">';
    html += '<div style="font-size: 24px; margin-bottom: 8px;">1️⃣</div>';
    html += '<h4 style="color: #7C3AED; font-size: 14px; margin-bottom: 8px;">Choose Your Correction</h4>';
    html += '<p style="font-size: 12px; color: #666; line-height: 1.4;">Select the name suggestion that aligns with your primary goal</p>';
    html += '</div>';
    
    html += '<div style="background: white; padding: 16px; border-radius: 12px;">';
    html += '<div style="font-size: 24px; margin-bottom: 8px;">2️⃣</div>';
    html += '<h4 style="color: #7C3AED; font-size: 14px; margin-bottom: 8px;">Update Your Signature</h4>';
    html += '<p style="font-size: 12px; color: #666; line-height: 1.4;">Start using the new name in your signature immediately</p>';
    html += '</div>';
    
    html += '<div style="background: white; padding: 16px; border-radius: 12px;">';
    html += '<div style="font-size: 24px; margin-bottom: 8px;">3️⃣</div>';
    html += '<h4 style="color: #7C3AED; font-size: 14px; margin-bottom: 8px;">Digital Presence</h4>';
    html += '<p style="font-size: 12px; color: #666; line-height: 1.4;">Update social media, email signatures, and business cards</p>';
    html += '</div>';
    
    html += '<div style="background: white; padding: 16px; border-radius: 12px;">';
    html += '<div style="font-size: 24px; margin-bottom: 8px;">4️⃣</div>';
    html += '<h4 style="color: #7C3AED; font-size: 14px; margin-bottom: 8px;">Consistency</h4>';
    html += '<p style="font-size: 12px; color: #666; line-height: 1.4;">Use consistently for 40+ days to build new energy pattern</p>';
    html += '</div></div>';
    
    html += '<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 16px;">';
    html += '<div style="background: rgba(34, 197, 94, 0.1); padding: 16px; border-radius: 12px;">';
    html += '<h4 style="color: #16A085; margin-bottom: 8px; font-size: 16px;">✅ DO\'s</h4>';
    html += '<ul style="margin: 0; padding-left: 16px; font-size: 12px; color: #2E7D32;">';
    html += '<li>Use corrected name in signature ALWAYS</li>';
    html += '<li>Introduce yourself with new name</li>';
    html += '<li>Update email signatures</li>';
    html += '<li>Stay consistent for at least 40 days</li>';
    html += '<li>Believe in the power of the change</li>';
    html += '</ul></div>';
    
    html += '<div style="background: rgba(239, 68, 68, 0.1); padding: 16px; border-radius: 12px;">';
    html += '<h4 style="color: #DC2626; margin-bottom: 8px; font-size: 16px;">❌ DON\'Ts</h4>';
    html += '<ul style="margin: 0; padding-left: 16px; font-size: 12px; color: #DC2626;">';
    html += '<li>Change too frequently</li>';
    html += '<li>Use multiple names randomly</li>';
    html += '<li>Skip signature changes</li>';
    html += '<li>Use old and new name interchangeably</li>';
    html += '<li>Tell skeptics (protect your energy)</li>';
    html += '</ul></div></div>';
    
    html += '<div style="background: rgba(139, 92, 246, 0.1); padding: 16px; border-radius: 12px; margin-top: 20px;">';
    html += '<h4 style="color: #7C3AED; margin-bottom: 8px; font-size: 16px;">⏱️ Timeline for Results</h4>';
    html += '<div style="font-size: 13px; color: #6B46C1; line-height: 1.6;">';
    html += '<strong>Week 1:</strong> Start using new signature<br>';
    html += '<strong>Month 1:</strong> Energy shifts become noticeable<br>';
    html += '<strong>Month 3:</strong> Clear improvements in target areas<br>';
    html += '<strong>Year 1:</strong> Full integration and results manifest';
    html += '</div></div></div>';
    
    html += '<div style="background: linear-gradient(135deg, #FFFBEB 0%, #FEF3C7 100%); padding: 20px; border-radius: 16px; margin: 20px 0; border-left: 6px solid #F59E0B; text-align: center;">';
    html += '<h4 style="color: #D97706; margin-bottom: 12px; font-size: 18px;">⚖️ Legal Considerations</h4>';
    html += '<p style="color: #92400E; line-height: 1.6; margin: 0; font-size: 14px;">Minor spelling changes don\'t require legal name change. You can use professionally without legal change. Signature name has numerological power regardless of legal status. Legal change strengthens the effect but is not mandatory.</p>';
    html += '</div>';
    
    return html;
}

console.log('✨ Enhanced Numerology System with Complete Name Correction & Optimization Loaded');

// Complete 78-Card Tarot Deck
const fullTarotDeck = [
    // Major Arcana (22 cards)
    {id: 0, name: "The Fool", symbol: "🃏", suit: "Major", meaning: "New beginnings, innocence, spontaneity, adventure into the unknown", upright: "Freedom, originality, adventure", reversed: "Recklessness, risk-taking, inconsideration"},
    {id: 1, name: "The Magician", symbol: "🎩", suit: "Major", meaning: "Manifestation, resourcefulness, power to achieve goals", upright: "Skill, concentration, action", reversed: "Manipulation, poor planning, untapped talents"},
    {id: 2, name: "The High Priestess", symbol: "🌙", suit: "Major", meaning: "Intuition, sacred knowledge, divine feminine wisdom", upright: "Intuition, unconscious, mystery", reversed: "Secrets, disconnected from intuition"},
    {id: 3, name: "The Empress", symbol: "👑", suit: "Major", meaning: "Femininity, beauty, nature, nurturing abundance", upright: "Fertility, creativity, abundance", reversed: "Creative block, dependence on others"},
    {id: 4, name: "The Emperor", symbol: "⚜️", suit: "Major", meaning: "Authority, establishment, structure, father figure", upright: "Authority, structure, control", reversed: "Domination, rigidity, inflexibility"},
    {id: 5, name: "The Hierophant", symbol: "🕊️", suit: "Major", meaning: "Spiritual wisdom, tradition, conformity, institutions", upright: "Tradition, conformity, education", reversed: "Rebellion, unconventional, freedom"},
    {id: 6, name: "The Lovers", symbol: "💕", suit: "Major", meaning: "Love, harmony, relationships, alignment of values", upright: "Partnership, union, choices", reversed: "Disharmony, imbalance, misalignment"},
    {id: 7, name: "The Chariot", symbol: "🏇", suit: "Major", meaning: "Control, willpower, success, determination to win", upright: "Victory, willpower, determination", reversed: "Lack of control, aggression, opposition"},
    {id: 8, name: "Strength", symbol: "🦁", suit: "Major", meaning: "Strength, courage, patience, control with compassion", upright: "Inner strength, courage, patience", reversed: "Weakness, self-doubt, lack of discipline"},
    {id: 9, name: "The Hermit", symbol: "🕯️", suit: "Major", meaning: "Soul-searching, introspection, being alone, inner guidance", upright: "Introspection, solitude, guidance", reversed: "Isolation, loneliness, withdrawal"},
    {id: 10, name: "Wheel of Fortune", symbol: "☸️", suit: "Major", meaning: "Good luck, karma, life cycles, destiny, turning point", upright: "Change, cycles, fate", reversed: "Bad luck, resistance to change"},
    {id: 11, name: "Justice", symbol: "⚖️", suit: "Major", meaning: "Justice, fairness, truth, cause and effect", upright: "Fairness, truth, law", reversed: "Unfairness, lack of accountability"},
    {id: 12, name: "The Hanged Man", symbol: "🙃", suit: "Major", meaning: "Pause, surrender, letting go, new perspective", upright: "Suspension, letting go, sacrifice", reversed: "Stalling, needless sacrifice"},
    {id: 13, name: "Death", symbol: "💀", suit: "Major", meaning: "Endings, change, transformation, transition", upright: "Transformation, endings, change", reversed: "Resistance to change, stagnation"},
    {id: 14, name: "Temperance", symbol: "🍷", suit: "Major", meaning: "Balance, moderation, patience, purpose", upright: "Balance, moderation, patience", reversed: "Imbalance, excess, lack of harmony"},
    {id: 15, name: "The Devil", symbol: "😈", suit: "Major", meaning: "Shadow self, attachment, addiction, materialism", upright: "Bondage, addiction, materialism", reversed: "Release, freedom, revelation"},
    {id: 16, name: "The Tower", symbol: "🗼", suit: "Major", meaning: "Sudden change, upheaval, chaos, revelation", upright: "Upheaval, chaos, awakening", reversed: "Disaster avoided, fear of change"},
    {id: 17, name: "The Star", symbol: "⭐", suit: "Major", meaning: "Hope, faith, purpose, renewal, spirituality", upright: "Hope, faith, inspiration", reversed: "Despair, lack of faith, disconnection"},
    {id: 18, name: "The Moon", symbol: "🌜", suit: "Major", meaning: "Illusion, fear, anxiety, subconscious, intuition", upright: "Illusion, fear, anxiety", reversed: "Truth revealed, clarity"},
    {id: 19, name: "The Sun", symbol: "☀️", suit: "Major", meaning: "Positivity, fun, warmth, success, vitality", upright: "Joy, success, celebration", reversed: "Temporary depression, lack of success"},
    {id: 20, name: "Judgement", symbol: "📯", suit: "Major", meaning: "Judgement, rebirth, inner calling, absolution", upright: "Reflection, reckoning, awakening", reversed: "Self-doubt, lack of self-awareness"},
    {id: 21, name: "The World", symbol: "🌍", suit: "Major", meaning: "Completion, integration, accomplishment, travel", upright: "Completion, achievement, fulfillment", reversed: "Incompletion, no closure"},
    
    // Wands (Fire - 14 cards)
    {id: 22, name: "Ace of Wands", symbol: "🔥", suit: "Wands", meaning: "New creative energy, inspiration, growth potential", upright: "Inspiration, new opportunities", reversed: "Delays, creative blocks"},
    {id: 23, name: "Two of Wands", symbol: "🔥🔥", suit: "Wands", meaning: "Planning, decisions, future vision, discovery", upright: "Planning, progress, decisions", reversed: "Fear of unknown, lack of planning"},
    {id: 24, name: "Three of Wands", symbol: "🔥🔥🔥", suit: "Wands", meaning: "Expansion, foresight, overseas opportunities", upright: "Expansion, foresight, leadership", reversed: "Delays, frustration, obstacles"},
    {id: 25, name: "Four of Wands", symbol: "🎉", suit: "Wands", meaning: "Celebration, joy, harmony, homecoming", upright: "Celebration, harmony, marriage", reversed: "Lack of support, instability"},
    {id: 26, name: "Five of Wands", symbol: "⚔️", suit: "Wands", meaning: "Competition, conflict, disagreements", upright: "Conflict, competition, tension", reversed: "Avoiding conflict, inner conflict"},
    {id: 27, name: "Six of Wands", symbol: "🏆", suit: "Wands", meaning: "Victory, success, public recognition, self-confidence", upright: "Victory, success, recognition", reversed: "Failure, lack of recognition"},
    {id: 28, name: "Seven of Wands", symbol: "🛡️", suit: "Wands", meaning: "Challenge, competition, protection, perseverance", upright: "Challenge, competition, defense", reversed: "Giving up, overwhelmed"},
    {id: 29, name: "Eight of Wands", symbol: "⚡", suit: "Wands", meaning: "Speed, action, air travel, rapid progress", upright: "Speed, action, movement", reversed: "Delays, frustration, resisting change"},
    {id: 30, name: "Nine of Wands", symbol: "💪", suit: "Wands", meaning: "Resilience, courage, persistence, boundaries", upright: "Resilience, persistence", reversed: "Exhaustion, giving up"},
    {id: 31, name: "Ten of Wands", symbol: "🎒", suit: "Wands", meaning: "Burden, extra responsibility, hard work, stress", upright: "Burden, responsibility, stress", reversed: "Release, delegation"},
    {id: 32, name: "Page of Wands", symbol: "🧑", suit: "Wands", meaning: "Inspiration, discovery, limitless potential", upright: "Exploration, excitement", reversed: "Lack of direction, procrastination"},
    {id: 33, name: "Knight of Wands", symbol: "🐴", suit: "Wands", meaning: "Energy, passion, adventure, impulsiveness", upright: "Adventure, impulsiveness", reversed: "Recklessness, impatience"},
    {id: 34, name: "Queen of Wands", symbol: "♛", suit: "Wands", meaning: "Courage, confidence, independence, determination", upright: "Confidence, independence", reversed: "Jealousy, insecurity"},
    {id: 35, name: "King of Wands", symbol: "♚", suit: "Wands", meaning: "Natural leader, vision, entrepreneur, honor", upright: "Leadership, vision, honor", reversed: "Impulsiveness, ruthlessness"},
    
    // Cups (Water - 14 cards)
    {id: 36, name: "Ace of Cups", symbol: "☕", suit: "Cups", meaning: "Love, new relationships, compassion, creativity", upright: "New love, compassion", reversed: "Emotional loss, blocked creativity"},
    {id: 37, name: "Two of Cups", symbol: "💑", suit: "Cups", meaning: "Unified love, partnership, mutual attraction", upright: "Partnership, unity, attraction", reversed: "Imbalance, broken relationships"},
    {id: 38, name: "Three of Cups", symbol: "🎊", suit: "Cups", meaning: "Celebration, friendship, creativity, community", upright: "Celebration, friendship", reversed: "Isolation, loneliness"},
    {id: 39, name: "Four of Cups", symbol: "😔", suit: "Cups", meaning: "Meditation, contemplation, apathy, reevaluation", upright: "Apathy, contemplation", reversed: "Motivation, new perspective"},
    {id: 40, name: "Five of Cups", symbol: "😢", suit: "Cups", meaning: "Regret, failure, disappointment, pessimism", upright: "Loss, regret, disappointment", reversed: "Acceptance, moving on"},
    {id: 41, name: "Six of Cups", symbol: "🎁", suit: "Cups", meaning: "Revisiting the past, childhood memories, innocence", upright: "Nostalgia, memories, innocence", reversed: "Living in past, unrealistic"},
    {id: 42, name: "Seven of Cups", symbol: "☁️", suit: "Cups", meaning: "Opportunities, choices, wishful thinking, illusion", upright: "Choices, fantasy, illusion", reversed: "Clarity, reality check"},
    {id: 43, name: "Eight of Cups", symbol: "🚶", suit: "Cups", meaning: "Disappointment, abandonment, leaving behind", upright: "Walking away, disillusionment", reversed: "Fear of moving on"},
    {id: 44, name: "Nine of Cups", symbol: "🌟", suit: "Cups", meaning: "Contentment, satisfaction, gratitude, wish come true", upright: "Satisfaction, wishes fulfilled", reversed: "Greed, dissatisfaction"},
    {id: 45, name: "Ten of Cups", symbol: "🏡", suit: "Cups", meaning: "Divine love, blissful relationships, harmony", upright: "Happy family, harmony", reversed: "Broken family, disconnection"},
    {id: 46, name: "Page of Cups", symbol: "🧒", suit: "Cups", meaning: "Creative opportunities, curiosity, intuitive messages", upright: "Creative opportunity, curiosity", reversed: "Emotional immaturity"},
    {id: 47, name: "Knight of Cups", symbol: "🤴", suit: "Cups", meaning: "Creativity, romance, charm, following the heart", upright: "Romance, charm, idealism", reversed: "Moodiness, unrealistic"},
    {id: 48, name: "Queen of Cups", symbol: "♕", suit: "Cups", meaning: "Compassionate, caring, emotionally stable, intuitive", upright: "Compassion, calm, comfort", reversed: "Insecurity, emotional instability"},
    {id: 49, name: "King of Cups", symbol: "♔", suit: "Cups", meaning: "Emotionally balanced, compassionate, diplomatic", upright: "Emotional balance, diplomacy", reversed: "Emotional manipulation"},
    
    // Swords (Air - 14 cards)
    {id: 50, name: "Ace of Swords", symbol: "⚔️", suit: "Swords", meaning: "Breakthroughs, new ideas, mental clarity, success", upright: "Breakthrough, clarity, truth", reversed: "Confusion, chaos, lack of clarity"},
    {id: 51, name: "Two of Swords", symbol: "🤔", suit: "Swords", meaning: "Difficult decisions, weighing options, stalemate", upright: "Difficult decisions, stalemate", reversed: "Confusion, information overload"},
    {id: 52, name: "Three of Swords", symbol: "💔", suit: "Swords", meaning: "Heartbreak, emotional pain, sorrow, grief", upright: "Heartbreak, sorrow, grief", reversed: "Recovery, forgiveness"},
    {id: 53, name: "Four of Swords", symbol: "😴", suit: "Swords", meaning: "Rest, relaxation, meditation, contemplation", upright: "Rest, restoration", reversed: "Burnout, stress, stagnation"},
    {id: 54, name: "Five of Swords", symbol: "🗡️", suit: "Swords", meaning: "Conflict, disagreements, competition, defeat", upright: "Conflict, defeat", reversed: "Resolution, moving on"},
    {id: 55, name: "Six of Swords", symbol: "⛵", suit: "Swords", meaning: "Transition, change, rite of passage, moving forward", upright: "Transition, moving forward", reversed: "Resistance to change"},
    {id: 56, name: "Seven of Swords", symbol: "🕵️", suit: "Swords", meaning: "Betrayal, deception, getting away with something", upright: "Deception, betrayal, strategy", reversed: "Coming clean, truth revealed"},
    {id: 57, name: "Eight of Swords", symbol: "🎭", suit: "Swords", meaning: "Negative thoughts, self-imposed restriction, victim", upright: "Restriction, feeling trapped", reversed: "Freedom, release"},
    {id: 58, name: "Nine of Swords", symbol: "😰", suit: "Swords", meaning: "Anxiety, worry, fear, depression, nightmares", upright: "Anxiety, worry, nightmares", reversed: "Hope, recovery"},
    {id: 59, name: "Ten of Swords", symbol: "⚰️", suit: "Swords", meaning: "Painful endings, deep wounds, betrayal, loss", upright: "Rock bottom, betrayal", reversed: "Recovery, regeneration"},
    {id: 60, name: "Page of Swords", symbol: "👦", suit: "Swords", meaning: "New ideas, curiosity, thirst for knowledge", upright: "Curiosity, mental energy", reversed: "Gossip, haste"},
    {id: 61, name: "Knight of Swords", symbol: "🐎", suit: "Swords", meaning: "Ambitious, action-oriented, driven to succeed", upright: "Action, impulsiveness", reversed: "Recklessness, impatience"},
    {id: 62, name: "Queen of Swords", symbol: "♛", suit: "Swords", meaning: "Independent, unbiased judgment, clear boundaries", upright: "Independence, clarity", reversed: "Cold, cruel, bitter"},
    {id: 63, name: "King of Swords", symbol: "♚", suit: "Swords", meaning: "Mental clarity, intellectual power, authority", upright: "Authority, truth, clarity", reversed: "Manipulation, cruelty"},
    
    // Pentacles (Earth - 14 cards)
    {id: 64, name: "Ace of Pentacles", symbol: "💰", suit: "Pentacles", meaning: "New financial opportunity, prosperity, security", upright: "Opportunity, prosperity", reversed: "Lost opportunity, lack of planning"},
    {id: 65, name: "Two of Pentacles", symbol: "⚖️", suit: "Pentacles", meaning: "Multiple priorities, time management, adaptability", upright: "Balance, adaptability", reversed: "Disorganization, overwhelmed"},
    {id: 66, name: "Three of Pentacles", symbol: "🏗️", suit: "Pentacles", meaning: "Teamwork, collaboration, learning", upright: "Teamwork, collaboration", reversed: "Lack of teamwork"},
    {id: 67, name: "Four of Pentacles", symbol: "💎", suit: "Pentacles", meaning: "Saving money, security, conservatism", upright: "Security, control", reversed: "Greed, materialism"},
    {id: 68, name: "Five of Pentacles", symbol: "🥶", suit: "Pentacles", meaning: "Financial loss, poverty, lack mentality", upright: "Financial loss, insecurity", reversed: "Recovery, charity"},
    {id: 69, name: "Six of Pentacles", symbol: "🤲", suit: "Pentacles", meaning: "Giving, receiving, sharing wealth, generosity", upright: "Generosity, charity", reversed: "Strings attached, inequality"},
    {id: 70, name: "Seven of Pentacles", symbol: "🌱", suit: "Pentacles", meaning: "Long-term view, sustainable results, patience", upright: "Assessment, reward", reversed: "Impatience, lack of reward"},
    {id: 71, name: "Eight of Pentacles", symbol: "🔨", suit: "Pentacles", meaning: "Apprenticeship, repetitive tasks, mastery", upright: "Diligence, skill development", reversed: "Lack of focus, poor quality"},
    {id: 72, name: "Nine of Pentacles", symbol: "🏵️", suit: "Pentacles", meaning: "Abundance, luxury, self-sufficiency, financial independence", upright: "Luxury, self-sufficiency", reversed: "Financial dependence"},
    {id: 73, name: "Ten of Pentacles", symbol: "🏰", suit: "Pentacles", meaning: "Wealth, financial security, family, legacy", upright: "Wealth, family, legacy", reversed: "Financial failure, debt"},
    {id: 74, name: "Page of Pentacles", symbol: "📚", suit: "Pentacles", meaning: "Manifestation, financial opportunity, new job", upright: "Opportunity, skill development", reversed: "Lack of progress"},
    {id: 75, name: "Knight of Pentacles", symbol: "🐢", suit: "Pentacles", meaning: "Hard work, productivity, routine, conservatism", upright: "Efficiency, routine", reversed: "Laziness, boredom"},
    {id: 76, name: "Queen of Pentacles", symbol: "♕", suit: "Pentacles", meaning: "Practical, homely, motherly, down-to-earth", upright: "Nurturing, practical", reversed: "Self-centeredness"},
    {id: 77, name: "King of Pentacles", symbol: "♔", suit: "Pentacles", meaning: "Wealth, business, leadership, security, abundance", upright: "Wealth, leadership, security", reversed: "Greed, materialism"}
];

// Shuffle Animation Function
function showShuffleAnimation(callback) {
    const shuffleArea = document.getElementById('shuffle-animation');
    shuffleArea.innerHTML = '';
    shuffleArea.style.display = 'flex';
    shuffleArea.style.flexWrap = 'wrap';
    shuffleArea.style.justifyContent = 'center';
    shuffleArea.style.gap = '10px';
    shuffleArea.style.padding = '30px 20px';
    shuffleArea.style.minHeight = '250px';
    shuffleArea.style.position = 'relative';
    
    // Create 12 card backs that shuffle
    for (let i = 0; i < 12; i++) {
        const cardBack = document.createElement('div');
        cardBack.className = 'shuffle-card';
        cardBack.style.cssText = `
            width: 80px;
            height: 120px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: 3px solid #FFD700;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            animation: shuffle-move 1.5s ease-in-out infinite;
            animation-delay: ${i * 0.1}s;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        `;
        cardBack.textContent = '🌙';
        shuffleArea.appendChild(cardBack);
    }
    
    // Add CSS animation if not exists
    if (!document.getElementById('shuffle-style')) {
        const style = document.createElement('style');
        style.id = 'shuffle-style';
        style.textContent = `
            @keyframes shuffle-move {
                0%, 100% { transform: translateY(0) rotate(0deg); opacity: 1; }
                50% { transform: translateY(-15px) rotate(${Math.random() * 10 - 5}deg); opacity: 0.8; }
            }
        `;
        document.head.appendChild(style);
    }
    
    // Show shuffling message
    const message = document.createElement('div');
    message.textContent = '✨ Shuffling cards...';
    message.style.cssText = 'width: 100%; text-align: center; font-size: 18px; color: #666; margin-top: 20px; font-weight: 600;';
    shuffleArea.appendChild(message);
    
    // After 3 seconds, hide and call callback
    setTimeout(() => {
        shuffleArea.style.display = 'none';
        callback();
    }, 3000);
}

// Start Tarot Reading Function
function startTarotReading() {
    const spreadType = document.getElementById('spread-selector').value;
    
    // Show shuffle animation first
    showShuffleAnimation(() => {
        drawTarotSpread(spreadType);
    });
}

// Draw Tarot Spread Function
function drawTarotSpread(spreadType) {
    // Shuffle deck and select required cards
    const shuffledDeck = [...fullTarotDeck].sort(() => Math.random() - 0.5);
    
    let html = '';
    
    switch(spreadType) {
        case 'single':
            html = createSingleCardSpread(shuffledDeck[0]);
            break;
        case 'three':
            html = createThreeCardSpread(shuffledDeck.slice(0, 3));
            break;
        case 'celtic':
            html = createCelticCrossSpread(shuffledDeck.slice(0, 10));
            break;
        case 'love':
            html = createLoveSpread(shuffledDeck.slice(0, 5));
            break;
        case 'career':
            html = createCareerSpread(shuffledDeck.slice(0, 6));
            break;
        case 'yes_no':
            html = createYesNoSpread(shuffledDeck[0]);
            break;
        default:
            html = createSingleCardSpread(shuffledDeck[0]);
    }
    
    document.getElementById('tarot-result').classList.remove('hidden');
    document.getElementById('tarot-output').innerHTML = html;
    document.getElementById('tarot-result').scrollIntoView({behavior: 'smooth', block: 'start'});
}

// Enhanced Single Card Spread
function createSingleCardSpread(card) {
    // Determine additional insights based on card properties
    let suitGuidance = '';
    if (card.suit === 'Major') {
        suitGuidance = '✨ <strong>Major Life Theme:</strong> This is a significant spiritual lesson or life event. Pay close attention.';
    } else if (card.suit === 'Wands') {
        suitGuidance = '🔥 <strong>Action Required:</strong> Time to take initiative and pursue your passions with courage.';
    } else if (card.suit === 'Cups') {
        suitGuidance = '💧 <strong>Trust Your Heart:</strong> Emotions and intuition are your guides today. Feel deeply.';
    } else if (card.suit === 'Swords') {
        suitGuidance = '💨 <strong>Mental Focus:</strong> Clear thinking and communication are essential. Use your intellect.';
    } else if (card.suit === 'Pentacles') {
        suitGuidance = '🌍 <strong>Practical Matters:</strong> Focus on tangible goals, money, health, or career today.';
    }
    
    return `
        <h3 class="text-center mb-20">🃏 Daily Guidance</h3>
        <div class="tarot-card">
            <div class="symbol">${card.symbol}</div>
            <div class="name">${card.name}</div>
            <div class="meaning">${card.meaning}</div>
        </div>
        
        <div style="background: linear-gradient(135deg, #E8F4FD 0%, #B8E6B8 100%); padding: 20px; border-radius: 16px; margin: 20px 0; border-left: 6px solid #32CD32;">
            <h3 style="color: #2E8B57; margin-bottom: 12px; font-size: 18px;">🎯 Today\'s Focus</h3>
            <p style="color: #374151; line-height: 1.6; margin-bottom: 12px;">${suitGuidance}</p>
            <p style="color: #374151; line-height: 1.6; margin: 0;"><strong>Key Energy:</strong> ${card.upright}</p>
        </div>
        
        <div style="background: linear-gradient(135deg, #FFFBEB 0%, #FEF3C7 100%); padding: 20px; border-radius: 16px; margin: 20px 0; border-left: 6px solid #F59E0B;">
            <h3 style="color: #D97706; margin-bottom: 12px; font-size: 18px;">⚠️ Shadow Aspect</h3>
            <p style="color: #374151; line-height: 1.6; margin: 0;">Be mindful of: ${card.reversed}</p>
        </div>
        
        <div style="background: linear-gradient(135deg, #FDF4FF 0%, #E0E7FF 100%); padding: 20px; border-radius: 16px; margin: 20px 0; border-left: 6px solid #8B5CF6;">
            <h3 style="color: #7C3AED; margin-bottom: 12px; font-size: 18px;">💫 Affirmation</h3>
            <p style="color: #374151; line-height: 1.6; margin: 0; font-style: italic;">"I embrace the energy of ${card.name} and allow ${card.upright.toLowerCase()} to guide my day with wisdom and grace."</p>
        </div>
    `;
}

// Enhanced Three Card Spread with Combinations
function createThreeCardSpread(cards) {
    // Analyze combinations
    const analysis = analyzeCardCombinations(cards, 'three');
    
    let html = `
        <h3 class="text-center mb-20">🎴 Past • Present • Future</h3>
        
        <!-- Individual Cards -->
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 16px; margin: 24px 0;">
            <div style="text-align: center; padding: 16px; background: linear-gradient(135deg, #FFE8CC 0%, #FFF5E6 100%); border-radius: 12px;">
                <p style="font-weight: 600; margin-bottom: 12px; color: #000080;">Past</p>
                <div style="font-size: 60px; margin: 16px 0;">${cards[0].symbol}</div>
                <p style="font-size: 16px; font-weight: 600; margin: 8px 0;">${cards[0].name}</p>
                <p style="font-size: 13px; color: #666; line-height: 1.4;">${cards[0].meaning}</p>
            </div>
            <div style="text-align: center; padding: 16px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 12px; color: white;">
                <p style="font-weight: 600; margin-bottom: 12px;">Present</p>
                <div style="font-size: 60px; margin: 16px 0;">${cards[1].symbol}</div>
                <p style="font-size: 16px; font-weight: 600; margin: 8px 0;">${cards[1].name}</p>
                <p style="font-size: 13px; opacity: 0.9; line-height: 1.4;">${cards[1].meaning}</p>
            </div>
            <div style="text-align: center; padding: 16px; background: linear-gradient(135deg, #FFE8CC 0%, #FFF5E6 100%); border-radius: 12px;">
                <p style="font-weight: 600; margin-bottom: 12px; color: #000080;">Future</p>
                <div style="font-size: 60px; margin: 16px 0;">${cards[2].symbol}</div>
                <p style="font-size: 16px; font-weight: 600; margin: 8px 0;">${cards[2].name}</p>
                <p style="font-size: 13px; color: #666; line-height: 1.4;">${cards[2].meaning}</p>
            </div>
        </div>
        
        <!-- Card Combinations Analysis -->
        <div style="background: linear-gradient(135deg, #E8F4FD 0%, #B8E6B8 100%); padding: 20px; border-radius: 16px; margin: 20px 0; border-left: 6px solid #32CD32;">
            <h3 style="color: #2E8B57; margin-bottom: 16px; font-size: 20px;">🔗 Card Combination Insights</h3>
    `;
    
    // Display combinations
    analysis.combinations.forEach((combo, index) => {
        const position = index === 0 ? 'Past → Present Flow' : 'Present → Future Flow';
        html += `
            <div style="margin-bottom: 16px; padding: 16px; background: rgba(255,255,255,0.8); border-radius: 12px;">
                <h4 style="color: #1e40af; margin-bottom: 8px; font-size: 16px;">${position}: ${combo.cards[0].name} + ${combo.cards[1].name}</h4>
                <p style="color: #374151; line-height: 1.5; margin: 0;">${combo.interpretation}</p>
            </div>
        `;
    });
    
    html += `</div>`;
    
    // Overall Trajectory
    html += `
        <div style="background: linear-gradient(135deg, #FDF4FF 0%, #E0E7FF 100%); padding: 20px; border-radius: 16px; margin: 20px 0; border-left: 6px solid #8B5CF6;">
            <h3 style="color: #7C3AED; margin-bottom: 12px; font-size: 20px;">🎯 Your Life Trajectory</h3>
            <p style="color: #374151; line-height: 1.6; margin: 0; font-size: 15px;">${analyzeTrajectory(cards[0], cards[1], cards[2])}</p>
        </div>
    `;
    
    // Overall Energy Analysis
    html += `
        <div style="background: linear-gradient(135deg, #FFFBEB 0%, #FEF3C7 100%); padding: 20px; border-radius: 16px; margin: 20px 0; border-left: 6px solid #F59E0B;">
            <h3 style="color: #D97706; margin-bottom: 12px; font-size: 20px;">⚡ Overall Energy Pattern</h3>
            <p style="color: #374151; line-height: 1.6; margin-bottom: 12px;">${analysis.overallEnergy}</p>
            <p style="color: #059669; font-weight: 600; margin: 0;">${analysis.suitAnalysis.message}</p>
        </div>
    `;
    
    // Elemental Balance
    html += `
        <div style="background: linear-gradient(135deg, #F0FDF4 0%, #DCFCE7 100%); padding: 20px; border-radius: 16px; margin: 20px 0; border-left: 6px solid #10B981;">
            <h3 style="color: #059669; margin-bottom: 12px; font-size: 20px;">🌟 Elemental Balance</h3>
            <p style="color: #374151; line-height: 1.6; margin: 0;">${analysis.elementalBalance}</p>
        </div>
    `;
    
    // Actionable Guidance
    html += `
        <div style="background: linear-gradient(135deg, #FEF2F2 0%, #FECACA 100%); padding: 20px; border-radius: 16px; margin: 20px 0; border-left: 6px solid #EF4444;">
            <h3 style="color: #DC2626; margin-bottom: 12px; font-size: 20px;">💡 Actionable Guidance</h3>
            <p style="color: #374151; line-height: 1.6; margin: 0;">Focus on the present moment with <strong>${cards[1].name}</strong>. Use the lessons from your past (${cards[0].name}) to navigate toward your future (${cards[2].name}). Your power lies in conscious choices made now.</p>
        </div>
    `;
    
    return html;
}

// Enhanced Celtic Cross Spread
function createCelticCrossSpread(cards) {
    const positions = [
        'Present Situation', 'Challenge/Cross', 'Distant Past', 'Recent Past',
        'Possible Outcome', 'Near Future', 'Your Approach', 'External Influences',
        'Hopes & Fears', 'Final Outcome'
    ];
    
    // Get reading depth
    const depth = document.getElementById('reading-depth').value;
    
    let cardsHtml = '<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 12px; margin: 20px 0;">';
    
    cards.forEach((card, index) => {
        cardsHtml += `
            <div style="text-align: center; padding: 12px; background: white; border: 2px solid #FF9933; border-radius: 8px;">
                <p style="font-size: 12px; font-weight: 600; margin-bottom: 8px; color: #000080;">${positions[index]}</p>
                <div style="font-size: 40px; margin: 8px 0;">${card.symbol}</div>
                <p style="font-size: 12px; font-weight: 600;">${card.name}</p>
                ${depth !== 'quick' ? `<p style="font-size: 10px; color: #666; margin-top: 4px;">${card.upright}</p>` : ''}
            </div>
        `;
    });
    
    cardsHtml += '</div>';
    
    let html = `
        <h3 class="text-center mb-20">🌟 Celtic Cross - Complete Life Reading</h3>
        ${cardsHtml}
    `;
    
    if (depth === 'deep') {
        const analysis = analyzeCardCombinations(cards, 'celtic');
        
        // Core Cross Analysis (positions 0-5)
        html += `
            <div style="background: linear-gradient(135deg, #E8F4FD 0%, #B8E6B8 100%); padding: 20px; border-radius: 16px; margin: 20px 0; border-left: 6px solid #32CD32;">
                <h3 style="color: #2E8B57; margin-bottom: 16px; font-size: 20px;">✨ Core Life Pattern</h3>
                <p style="color: #374151; line-height: 1.6;"><strong>Present Challenge:</strong> ${cards[0].name} crossed by ${cards[1].name} shows ${cards[0].upright.toLowerCase()} being challenged by ${cards[1].meaning.toLowerCase()}.</p>
                <p style="color: #374151; line-height: 1.6;"><strong>Foundation & Future:</strong> Your past foundation (${cards[2].name}) is evolving toward ${cards[5].name}, indicating a shift from ${cards[2].upright.toLowerCase()} to ${cards[5].upright.toLowerCase()}.</p>
            </div>
        `;
        
        // Staff Analysis (positions 6-9)
        html += `
            <div style="background: linear-gradient(135deg, #FDF4FF 0%, #E0E7FF 100%); padding: 20px; border-radius: 16px; margin: 20px 0; border-left: 6px solid #8B5CF6;">
                <h3 style="color: #7C3AED; margin-bottom: 16px; font-size: 20px;">🎯 Your Path Forward</h3>
                <p style="color: #374151; line-height: 1.6;"><strong>Your Power:</strong> ${cards[6].name} shows your natural approach is ${cards[6].upright.toLowerCase()}.</p>
                <p style="color: #374151; line-height: 1.6;"><strong>Environment:</strong> ${cards[7].name} indicates external influences of ${cards[7].upright.toLowerCase()}.</p>
                <p style="color: #374151; line-height: 1.6;"><strong>Inner Truth:</strong> ${cards[8].name} reveals your deepest hopes/fears around ${cards[8].upright.toLowerCase()}.</p>
                <p style="color: #374151; line-height: 1.6;"><strong>Destiny:</strong> ${cards[9].name} points to final outcome of ${cards[9].upright.toLowerCase()}.</p>
            </div>
        `;
        
        // Overall Energy
        html += `
            <div style="background: linear-gradient(135deg, #FFFBEB 0%, #FEF3C7 100%); padding: 20px; border-radius: 16px; margin: 20px 0; border-left: 6px solid #F59E0B;">
                <h3 style="color: #D97706; margin-bottom: 12px; font-size: 20px;">⚡ Overall Life Energy</h3>
                <p style="color: #374151; line-height: 1.6;">${analysis.overallEnergy}</p>
                <p style="color: #059669; font-weight: 600; margin-top: 12px;">${analysis.suitAnalysis.message}</p>
            </div>
        `;
    } else if (depth === 'standard') {
        html += `
            <div class="info-box">
                <p><strong>Key Insight:</strong> The ${cards[0].name} in your present situation suggests ${cards[0].upright.toLowerCase()}, while the final outcome of ${cards[9].name} indicates ${cards[9].upright.toLowerCase()}.</p>
                <p><strong>Focus:</strong> Your approach (${cards[6].name}) combined with external influences (${cards[7].name}) will shape your destiny.</p>
            </div>
        `;
    }
    
    return html;
}

// Enhanced Love Spread
function createLoveSpread(cards) {
    const lovePositions = ['You', 'Your Partner', 'Relationship', 'Challenge', 'Guidance'];
    const depth = document.getElementById('reading-depth').value;
    
    let cardsHtml = '<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 16px; margin: 20px 0;">';
    
    cards.forEach((card, index) => {
        cardsHtml += `
            <div style="text-align: center; padding: 16px; background: linear-gradient(135deg, #FFB6C1 0%, #FFC0CB 100%); border-radius: 12px;">
                <p style="font-weight: 600; margin-bottom: 12px; color: #8B0000;">${lovePositions[index]}</p>
                <div style="font-size: 50px; margin: 12px 0;">${card.symbol}</div>
                <p style="font-size: 14px; font-weight: 600; margin: 8px 0;">${card.name}</p>
                ${depth !== 'quick' ? `<p style="font-size: 12px; color: #666;">${card.upright}</p>` : ''}
            </div>
        `;
    });
    
    cardsHtml += '</div>';
    
    let html = `
        <h3 class="text-center mb-20">💕 Love & Relationship Reading</h3>
        ${cardsHtml}
    `;
    
    if (depth === 'deep') {
        const analysis = analyzeCardCombinations(cards, 'love');
        
        // Relationship Dynamic
        const youPartnerCombo = interpretTwoCards(cards[0], cards[1]);
        if (youPartnerCombo) {
            html += `
                <div style="background: linear-gradient(135deg, #FFF0F5 0%, #FFE4E1 100%); padding: 20px; border-radius: 16px; margin: 20px 0; border-left: 6px solid #FF69B4;">
                    <h3 style="color: #C71585; margin-bottom: 12px; font-size: 20px;">💞 Relationship Dynamic</h3>
                    <p style="color: #374151; line-height: 1.6;">${youPartnerCombo}</p>
                </div>
            `;
        }
        
        // Challenge & Resolution
        const challengeGuidanceCombo = interpretTwoCards(cards[3], cards[4]);
        if (challengeGuidanceCombo) {
            html += `
                <div style="background: linear-gradient(135deg, #FEF3C7 0%, #FCD34D 100%); padding: 20px; border-radius: 16px; margin: 20px 0; border-left: 6px solid #F59E0B;">
                    <h3 style="color: #D97706; margin-bottom: 12px; font-size: 20px;">🔄 Challenge to Resolution</h3>
                    <p style="color: #374151; line-height: 1.6;">${challengeGuidanceCombo}</p>
                </div>
            `;
        }
        
        // Love Forecast
        html += `
            <div style="background: linear-gradient(135deg, #E8F4FD 0%, #DBEAFE 100%); padding: 20px; border-radius: 16px; margin: 20px 0; border-left: 6px solid #3B82F6;">
                <h3 style="color: #1D4ED8; margin-bottom: 12px; font-size: 20px;">🔮 Love Forecast</h3>
                <p style="color: #374151; line-height: 1.6;">The heart of your connection (${cards[2].name}) shows ${cards[2].meaning.toLowerCase()}. This energy combined with your guidance (${cards[4].name}) suggests a path toward ${cards[4].upright.toLowerCase()}. Love requires both understanding (your ${cards[0].name}) and openness (their ${cards[1].name}).</p>
            </div>
        `;
        
        // Elemental Love Balance
        html += `
            <div style="background: linear-gradient(135deg, #F0FDF4 0%, #DCFCE7 100%); padding: 20px; border-radius: 16px; margin: 20px 0; border-left: 6px solid #10B981;">
                <h3 style="color: #059669; margin-bottom: 12px; font-size: 20px;">🌟 Love Energies</h3>
                <p style="color: #374151; line-height: 1.6;">${analysis.elementalBalance}</p>
                <p style="color: #059669; font-weight: 600; margin-top: 12px;">${analysis.suitAnalysis.message}</p>
            </div>
        `;
        
    } else {
        html += `
            <div class="info-box">
                <p><strong>Love Guidance:</strong> Focus on ${cards[4].name.toLowerCase()} which advises ${cards[4].upright.toLowerCase()}. The relationship energy of ${cards[2].name.toLowerCase()} suggests ${cards[2].upright.toLowerCase()}.</p>
            </div>
        `;
    }
    
    return html;
}

// Career Spread
function createCareerSpread(cards) {
    const careerPositions = ['Current Job', 'Skills', 'Opportunities', 'Challenges', 'Action', 'Outcome'];
    const depth = document.getElementById('reading-depth').value;
    
    let cardsHtml = '<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 16px; margin: 20px 0;">';
    
    cards.forEach((card, index) => {
        cardsHtml += `
            <div style="text-align: center; padding: 16px; background: linear-gradient(135deg, #E6E6FA 0%, #D8BFD8 100%); border-radius: 12px;">
                <p style="font-weight: 600; margin-bottom: 12px; color: #4B0082;">${careerPositions[index]}</p>
                <div style="font-size: 50px; margin: 12px 0;">${card.symbol}</div>
                <p style="font-size: 14px; font-weight: 600; margin: 8px 0;">${card.name}</p>
                ${depth !== 'quick' ? `<p style="font-size: 12px; color: #666;">${card.upright}</p>` : ''}
            </div>
        `;
    });
    
    cardsHtml += '</div>';
    
    return `
        <h3 class="text-center mb-20">💼 Career Path Reading</h3>
        ${cardsHtml}
        <div class="info-box">
            <p><strong>Career Advice:</strong> Take action with ${cards[4].name.toLowerCase()}, focusing on ${cards[4].upright.toLowerCase()}. Your professional outcome shows ${cards[5].name.toLowerCase()}, indicating ${cards[5].upright.toLowerCase()}.</p>
        </div>
    `;
}

// Yes/No Spread
function createYesNoSpread(card) {
    // Determine yes/no based on card suit and number
    const isYes = ['Major', 'Cups', 'Wands'].includes(card.suit) || 
                  (card.suit === 'Pentacles' && card.id % 2 === 0) ||
                  (card.suit === 'Swords' && card.id % 2 === 1);
    
    const answer = isYes ? 'YES' : 'NO';
    const answerColor = isYes ? '#228B22' : '#DC143C';
    const answerEmoji = isYes ? '✅' : '❌';
    
    return `
        <h3 class="text-center mb-20">❓ Yes/No Reading</h3>
        <div class="text-center" style="padding: 32px; background: linear-gradient(135deg, #F0F8FF 0%, #E6E6FA 100%); border-radius: 20px; margin: 20px 0;">
            <div style="font-size: 80px; margin: 20px 0;">${answerEmoji}</div>
            <div style="font-size: 48px; font-weight: bold; color: ${answerColor}; margin: 16px 0;">${answer}</div>
            <div style="font-size: 60px; margin: 20px 0;">${card.symbol}</div>
            <div style="font-size: 24px; font-weight: 600; margin: 12px 0;">${card.name}</div>
        </div>
        <div class="info-box">
            <p><strong>Guidance:</strong> ${card.meaning}</p>
            <p><strong>Additional Insight:</strong> ${card.upright}</p>
        </div>
    `;
}

// Old drawTarot function for backwards compatibility
function drawTarot(spreadType) {
    startTarotReading();
}

// Moonology Oracle Functions
function drawMoonologyCards() {
    const spreadType = document.getElementById('moonology-spread').value;
    
    // Show moonology shuffle animation
    showMoonologyShuffleAnimation(() => {
        createMoonologySpread(spreadType);
    });
}

function showMoonologyShuffleAnimation(callback) {
    const shuffleArea = document.getElementById('moonology-shuffle');
    shuffleArea.innerHTML = '';
    shuffleArea.style.display = 'flex';
    shuffleArea.style.flexWrap = 'wrap';
    shuffleArea.style.justifyContent = 'center';
    shuffleArea.style.gap = '10px';
    shuffleArea.style.padding = '30px 20px';
    shuffleArea.style.minHeight = '200px';
    shuffleArea.style.position = 'relative';
    
    // Create 8 moon cards that shuffle
    for (let i = 0; i < 8; i++) {
        const cardBack = document.createElement('div');
        cardBack.className = 'moonology-shuffle-card';
        cardBack.style.cssText = `
            width: 70px;
            height: 100px;
            background: linear-gradient(135deg, #1a202c 0%, #2d3748 100%);
            border: 2px solid #4299e1;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            animation: moonology-shuffle 1.8s ease-in-out infinite;
            animation-delay: ${i * 0.15}s;
            box-shadow: 0 4px 15px rgba(66, 153, 225, 0.3);
            color: #90cdf4;
        `;
        cardBack.textContent = '🌙';
        shuffleArea.appendChild(cardBack);
    }
    
    // Add moonology animation CSS if not exists
    if (!document.getElementById('moonology-shuffle-style')) {
        const style = document.createElement('style');
        style.id = 'moonology-shuffle-style';
        style.textContent = `
            @keyframes moonology-shuffle {
                0%, 100% { transform: translateY(0) rotate(0deg); opacity: 0.9; }
                50% { transform: translateY(-12px) rotate(${Math.random() * 8 - 4}deg); opacity: 1; }
            }
        `;
        document.head.appendChild(style);
    }
    
    // Show shuffling message
    const message = document.createElement('div');
    message.textContent = '🌙 Connecting with lunar wisdom...';
    message.style.cssText = 'width: 100%; text-align: center; font-size: 16px; color: #4299e1; margin-top: 20px; font-weight: 600;';
    shuffleArea.appendChild(message);
    
    // After 2.5 seconds, hide and call callback
    setTimeout(() => {
        shuffleArea.style.display = 'none';
        callback();
    }, 2500);
}

function createMoonologySpread(spreadType) {
    // Shuffle moonology deck
    const shuffledDeck = [...moonologyDeck].sort(() => Math.random() - 0.5);
    
    let html = '';
    
    switch(spreadType) {
        case 'daily':
            html = createDailyLunarGuidance(shuffledDeck[0]);
            break;
        case 'phase':
            html = createMoonPhaseReading(shuffledDeck.slice(0, 3));
            break;
        case 'cycle':
            html = createFullLunarCycle(shuffledDeck.slice(0, 8));
            break;
        case 'manifestation':
            html = createManifestationSpread(shuffledDeck.slice(0, 5));
            break;
        default:
            html = createDailyLunarGuidance(shuffledDeck[0]);
    }
    
    document.getElementById('moonology-result').classList.remove('hidden');
    document.getElementById('moonology-output').innerHTML = html;
    document.getElementById('moonology-result').scrollIntoView({behavior: 'smooth', block: 'start'});
}

function createDailyLunarGuidance(card) {
    const currentMoon = "Waxing Crescent in Sagittarius"; // Current moon phase
    
    return `
        <h3 class="text-center mb-20">🌙 Daily Lunar Guidance</h3>
        <div class="moonology-card">
            <div class="phase">Phase: ${card.phase}</div>
            <div class="symbol">${card.symbol}</div>
            <div class="name">${card.name}</div>
            <div class="meaning">${card.meaning}</div>
            <div class="guidance">${card.guidance}</div>
        </div>
        
        <div style="background: linear-gradient(135deg, #E0F7FA 0%, #B2EBF2 100%); padding: 20px; border-radius: 16px; margin: 20px 0; border-left: 6px solid #0097A7;">
            <h3 style="color: #00695C; margin-bottom: 12px; font-size: 18px;">🌌 Current Lunar Alignment</h3>
            <p style="color: #004D40; line-height: 1.6; margin-bottom: 8px;"><strong>Current Moon:</strong> ${currentMoon}</p>
            <p style="color: #004D40; line-height: 1.6; margin: 0;"><strong>Card Alignment:</strong> Your drawn card resonates with the current lunar energy of growth and exploration. Trust your intuitive guidance.</p>
        </div>
        
        <div style="background: linear-gradient(135deg, #F3E5F5 0%, #E1BEE7 100%); padding: 20px; border-radius: 16px; margin: 20px 0; border-left: 6px solid #8E24AA;">
            <h3 style="color: #6A1B9A; margin-bottom: 12px; font-size: 18px;">✨ Today's Ritual</h3>
            <p style="color: #4A148C; line-height: 1.6; margin-bottom: 8px;"><strong>Moon Meditation:</strong> Spend 10 minutes tonight connecting with the moon's energy.</p>
            <p style="color: #4A148C; line-height: 1.6; margin-bottom: 8px;"><strong>Journaling Prompt:</strong> How can I align with the energy of ${card.name.toLowerCase()}?</p>
            <p style="color: #4A148C; line-height: 1.6; margin: 0;"><strong>Affirmation:</strong> "I embrace the lunar wisdom of ${card.energy.toLowerCase()} in my life."</p>
        </div>
    `;
}

function createMoonPhaseReading(cards) {
    const positions = ['Current Energy', 'Challenge', 'Guidance'];
    
    let cardsHtml = '<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin: 24px 0;">';
    
    cards.forEach((card, index) => {
        const bgColors = [
            'linear-gradient(135deg, #1a202c 0%, #2d3748 100%)',
            'linear-gradient(135deg, #744210 0%, #975A16 100%)', 
            'linear-gradient(135deg, #1a365d 0%, #2c5282 100%)'
        ];
        
        cardsHtml += `
            <div style="text-align: center; padding: 20px; background: ${bgColors[index]}; border-radius: 16px; color: white; border: 2px solid ${index === 0 ? '#4299e1' : index === 1 ? '#ed8936' : '#4fd1c7'};">
                <p style="font-weight: 600; margin-bottom: 12px; color: #a0aec0; font-size: 14px;">${positions[index]}</p>
                <div style="font-size: 50px; margin: 16px 0;">${card.symbol}</div>
                <p style="font-size: 16px; font-weight: 600; margin: 12px 0; color: #90cdf4;">${card.name}</p>
                <p style="font-size: 13px; opacity: 0.9; line-height: 1.4;">${card.meaning}</p>
            </div>
        `;
    });
    
    cardsHtml += '</div>';
    
    return `
        <h3 class="text-center mb-20">🌓 Moon Phase Reading</h3>
        ${cardsHtml}
        
        <div style="background: linear-gradient(135deg, #FFF9C4 0%, #F0F4C3 100%); padding: 20px; border-radius: 16px; margin: 20px 0; border-left: 6px solid #F57F17;">
            <h3 style="color: #E65100; margin-bottom: 12px; font-size: 20px;">🌌 Lunar Integration</h3>
            <p style="color: #BF360C; line-height: 1.6; margin-bottom: 12px;"><strong>Current Phase Wisdom:</strong> ${cards[0].guidance}</p>
            <p style="color: #BF360C; line-height: 1.6; margin-bottom: 12px;"><strong>Challenge to Transform:</strong> ${cards[1].guidance}</p>
            <p style="color: #BF360C; line-height: 1.6; margin: 0;"><strong>Guiding Light:</strong> ${cards[2].guidance}</p>
        </div>
        
        <div style="background: linear-gradient(135deg, #E8F5E8 0%, #C8E6C9 100%); padding: 20px; border-radius: 16px; margin: 20px 0; border-left: 6px solid #2E7D32;">
            <h3 style="color: #1B5E20; margin-bottom: 12px; font-size: 20px;">🌟 Moon Cycle Action</h3>
            <p style="color: #2E7D32; line-height: 1.6; margin: 0;">Work with the current lunar energy by embracing ${cards[0].energy.toLowerCase()}, transforming any ${cards[1].energy.toLowerCase()}, and integrating the wisdom of ${cards[2].energy.toLowerCase()}. The moon's phases mirror your inner cycles of growth.</p>
        </div>
    `;
}

function createFullLunarCycle(cards) {
    const phases = ['New Moon', 'Waxing Crescent', 'First Quarter', 'Waxing Gibbous', 'Full Moon', 'Waning Gibbous', 'Last Quarter', 'Waning Crescent'];
    
    let cardsHtml = '<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 12px; margin: 20px 0;">';
    
    cards.forEach((card, index) => {
        cardsHtml += `
            <div style="text-align: center; padding: 16px; background: linear-gradient(135deg, #1a202c 0%, #2d3748 100%); border-radius: 12px; color: white; border: 2px solid #4299e1;">
                <p style="font-size: 11px; font-weight: 600; margin-bottom: 8px; color: #a0aec0;">${phases[index]}</p>
                <div style="font-size: 40px; margin: 12px 0;">${card.symbol}</div>
                <p style="font-size: 12px; font-weight: 600; margin: 8px 0; color: #90cdf4;">${card.name}</p>
                <p style="font-size: 10px; color: #cbd5e0; margin-top: 6px;">${card.energy}</p>
            </div>
        `;
    });
    
    cardsHtml += '</div>';
    
    return `
        <h3 class="text-center mb-20">🌑🌕 Complete Lunar Cycle Journey</h3>
        ${cardsHtml}
        
        <div style="background: linear-gradient(135deg, #E3F2FD 0%, #BBDEFB 100%); padding: 20px; border-radius: 16px; margin: 20px 0; border-left: 6px solid #1976D2;">
            <h3 style="color: #0D47A1; margin-bottom: 12px; font-size: 20px;">🌌 Your Lunar Cycle Story</h3>
            <p style="color: #1565C0; line-height: 1.6; margin-bottom: 12px;">This 8-card spread represents your complete lunar journey. Each phase offers unique wisdom for your spiritual evolution.</p>
            <p style="color: #1565C0; line-height: 1.6; margin: 0;"><strong>Focus Phase:</strong> Pay special attention to the ${cards[4].name} (Full Moon position) - this represents your peak manifestation energy.</p>
        </div>
        
        <div style="background: linear-gradient(135deg, #F1F8E9 0%, #DCEDC8 100%); padding: 20px; border-radius: 16px; margin: 20px 0; border-left: 6px solid #689F38;">
            <h3 style="color: #33691E; margin-bottom: 12px; font-size: 20px;">🌱 Cycle Integration</h3>
            <p style="color: #558B2F; line-height: 1.6;">Begin with ${cards[0].energy.toLowerCase()} (New Moon), build through ${cards[2].energy.toLowerCase()} (First Quarter), celebrate ${cards[4].energy.toLowerCase()} (Full Moon), and release through ${cards[6].energy.toLowerCase()} (Last Quarter). Trust the natural rhythm of growth, manifestation, and release.</p>
        </div>
    `;
}

function createManifestationSpread(cards) {
    const positions = ['Intention', 'Support', 'Challenge', 'Action', 'Outcome'];
    
    let cardsHtml = '<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 16px; margin: 24px 0;">';
    
    cards.forEach((card, index) => {
        const colors = ['#8E24AA', '#00695C', '#D84315', '#F57C00', '#1976D2'];
        
        cardsHtml += `
            <div style="text-align: center; padding: 18px; background: linear-gradient(135deg, #1a202c 0%, #2d3748 100%); border-radius: 16px; color: white; border: 3px solid ${colors[index]};">
                <p style="font-weight: 600; margin-bottom: 12px; color: #a0aec0; font-size: 14px;">${positions[index]}</p>
                <div style="font-size: 50px; margin: 16px 0;">${card.symbol}</div>
                <p style="font-size: 16px; font-weight: 600; margin: 12px 0; color: #90cdf4;">${card.name}</p>
                <p style="font-size: 12px; opacity: 0.8; color: #cbd5e0;">${card.energy}</p>
            </div>
        `;
    });
    
    cardsHtml += '</div>';
    
    return `
        <h3 class="text-center mb-20">✨ Lunar Manifestation Spread</h3>
        ${cardsHtml}
        
        <div style="background: linear-gradient(135deg, #FCE4EC 0%, #F8BBD9 100%); padding: 20px; border-radius: 16px; margin: 20px 0; border-left: 6px solid #C2185B;">
            <h3 style="color: #880E4F; margin-bottom: 12px; font-size: 20px;">🎯 Manifestation Path</h3>
            <p style="color: #AD1457; line-height: 1.6; margin-bottom: 12px;"><strong>Your Intention:</strong> ${cards[0].guidance}</p>
            <p style="color: #AD1457; line-height: 1.6; margin-bottom: 12px;"><strong>Universal Support:</strong> ${cards[1].meaning}</p>
            <p style="color: #AD1457; line-height: 1.6; margin-bottom: 12px;"><strong>Challenge to Overcome:</strong> ${cards[2].guidance}</p>
            <p style="color: #AD1457; line-height: 1.6; margin: 0;"><strong>Outcome Energy:</strong> ${cards[4].meaning}</p>
        </div>
        
        <div style="background: linear-gradient(135deg, #FFF3E0 0%, #FFE0B2 100%); padding: 20px; border-radius: 16px; margin: 20px 0; border-left: 6px solid #FF9800;">
            <h3 style="color: #E65100; margin-bottom: 12px; font-size: 20px;">⚡ Required Action</h3>
            <p style="color: #BF360C; line-height: 1.6; margin: 0;"><strong>${cards[3].name}:</strong> ${cards[3].guidance} This is your key to manifestation success.</p>
        </div>
    `;
}

console.log('✨ Mystic Divination App with Advanced Tarot, Numerology & Complete Moonology Oracle Loaded');

// Career Spread
function createCareerSpread(cards) {
    const careerPositions = ['Current Job', 'Skills', 'Opportunities', 'Challenges', 'Action', 'Outcome'];
    
    let cardsHtml = '<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 16px; margin: 20px 0;">';
    
    cards.forEach((card, index) => {
        cardsHtml += `
            <div style="text-align: center; padding: 16px; background: linear-gradient(135deg, #E6E6FA 0%, #D8BFD8 100%); border-radius: 12px;">
                <p style="font-weight: 600; margin-bottom: 12px; color: #4B0082;">${careerPositions[index]}</p>
                <div style="font-size: 50px; margin: 12px 0;">${card.symbol}</div>
                <p style="font-size: 14px; font-weight: 600; margin: 8px 0;">${card.name}</p>
                <p style="font-size: 12px; color: #666;">${card.upright}</p>
            </div>
        `;
    });
    
    cardsHtml += '</div>';
    
    return `
        <h3 class="text-center mb-20">💼 Career Path Reading</h3>
        ${cardsHtml}
        <div class="info-box">
            <p><strong>Career Advice:</strong> Take action with ${cards[4].name.toLowerCase()}, focusing on ${cards[4].upright.toLowerCase()}. Your professional outcome shows ${cards[5].name.toLowerCase()}, indicating ${cards[5].upright.toLowerCase()}.</p>
        </div>
    `;
}

// Yes/No Spread
function createYesNoSpread(card) {
    // Determine yes/no based on card suit and number
    const isYes = ['Major', 'Cups', 'Wands'].includes(card.suit) || 
                  (card.suit === 'Pentacles' && card.id % 2 === 0) ||
                  (card.suit === 'Swords' && card.id % 2 === 1);
    
    const answer = isYes ? 'YES' : 'NO';
    const answerColor = isYes ? '#228B22' : '#DC143C';
    const answerEmoji = isYes ? '✅' : '❌';
    
    return `
        <h3 class="text-center mb-20">❓ Yes/No Reading</h3>
        <div class="text-center" style="padding: 32px; background: linear-gradient(135deg, #F0F8FF 0%, #E6E6FA 100%); border-radius: 20px; margin: 20px 0;">
            <div style="font-size: 80px; margin: 20px 0;">${answerEmoji}</div>
            <div style="font-size: 48px; font-weight: bold; color: ${answerColor}; margin: 16px 0;">${answer}</div>
            <div style="font-size: 60px; margin: 20px 0;">${card.symbol}</div>
            <div style="font-size: 24px; font-weight: 600; margin: 12px 0;">${card.name}</div>
        </div>
        <div class="info-box">
            <p><strong>Guidance:</strong> ${card.meaning}</p>
            <p><strong>Additional Insight:</strong> ${card.upright}</p>
        </div>
    `;
}

// ENHANCED TAROT COMBINATION SYSTEM

// Card Combination Analysis Engine
function analyzeCardCombinations(cards, spreadType) {
    let combinations = [];
    
    // Analyze pairs and overall energy
    for (let i = 0; i < cards.length - 1; i++) {
        const combination = interpretTwoCards(cards[i], cards[i + 1]);
        if (combination) {
            combinations.push({
                cards: [cards[i], cards[i + 1]],
                interpretation: combination
            });
        }
    }
    
    // Overall spread energy
    const overallEnergy = analyzeOverallEnergy(cards);
    
    // Suit dominance analysis
    const suitAnalysis = analyzeSuitDominance(cards);
    
    // Elemental balance
    const elementalBalance = analyzeElements(cards);
    
    return {
        combinations: combinations,
        overallEnergy: overallEnergy,
        suitAnalysis: suitAnalysis,
        elementalBalance: elementalBalance
    };
}

// Interpret two cards together
function interpretTwoCards(card1, card2) {
    // Major + Major combinations
    if (card1.suit === 'Major' && card2.suit === 'Major') {
        return interpretMajorPair(card1, card2);
    }
    
    // Major + Minor combinations
    if (card1.suit === 'Major' || card2.suit === 'Major') {
        return interpretMajorMinor(card1, card2);
    }
    
    // Same suit combinations
    if (card1.suit === card2.suit) {
        return interpretSameSuit(card1, card2);
    }
    
    // Different suits
    return interpretDifferentSuits(card1, card2);
}

// Major Arcana pair interpretations
function interpretMajorPair(card1, card2) {
    const pairs = {
        // Fool combinations
        'The Fool-The Magician': 'A powerful beginning! Raw potential meets focused skill. You have everything needed to manifest your dreams. Time to turn ideas into reality.',
        'The Fool-The Lovers': 'A new relationship or significant choice in love. Trust your heart but keep your eyes open. Adventure in matters of the heart.',
        'The Fool-The Tower': 'Unexpected change that leads to liberation. What seems chaotic now is clearing space for authentic growth. Embrace the unknown.',
        
        // Magician combinations
        'The Magician-The High Priestess': 'Perfect balance of action and intuition. Your conscious efforts align with deeper wisdom. Trust your gut while taking practical steps.',
        'The Magician-The Emperor': 'Leadership and manifestation power. You can build lasting structures. Your skills meet authority and discipline.',
        'The Magician-Wheel of Fortune': 'Luck favors the prepared. Your efforts are about to pay off. Destiny and skill combine for success.',
        
        // Lovers combinations
        'The Lovers-The Devil': 'Warning about unhealthy attachment or temptation in relationships. Choose love over obsession. Freedom versus bondage.',
        'The Lovers-The Sun': 'Joyful, authentic connection. True love blessed by the universe. Happiness in partnership. Harmony and warmth.',
        'The Lovers-Judgement': 'A relationship reaching a turning point. Time to evaluate and recommit or release. Karmic partnership being resolved.',
        
        // Death combinations
        'Death-The Tower': 'Major life transformation through sudden change. Complete ending leading to rebirth. Powerful release and renewal.',
        'Death-The Star': 'Hope after loss. Transformation leads to healing and renewal. The phoenix rises. Beauty after grief.',
        'Death-The World': 'Completion of a major life cycle. One chapter completely ends as another begins. Graduation to new level.',
        
        // Sun combinations
        'The Sun-The Moon': 'Clarity after confusion. Truth revealed after illusion. Light and shadow in balance. Understanding your whole self.',
        'The Sun-The Star': 'Ultimate optimism and hope. Your wishes come true. Blessed period of joy and inspiration. Dreams manifesting.',
        'The Sun-The World': 'Complete success and achievement. Everything comes together perfectly. Ultimate happiness and fulfillment.',
        
        // Tower combinations  
        'The Tower-The Star': 'Hope after crisis. Breakthrough after breakdown. Chaos leads to clarity and healing. Beautiful rebuilding.',
        'The Tower-Temperance': 'Finding balance after upheaval. Moderation heals sudden change. Chaos transformed through patience.',
        
        // World combinations
        'The World-The Fool': 'Master returning to beginner. Completion leading to fresh start. Wisdom applied to new adventures.',
        
        // Hermit combinations
        'The Hermit-The Star': 'Inner guidance leading to hope and healing. Solitude brings clarity and renewed faith.',
        'The Hermit-The Moon': 'Deep introspection reveals hidden truths. Navigate illusions through inner wisdom.',
        
        // Strength combinations
        'Strength-The Chariot': 'Inner power driving external success. Courage and determination unite for victory.',
        'Strength-The Emperor': 'Gentle authority. Power with compassion. Leadership through inner strength.',
        
        // Justice combinations
        'Justice-The High Priestess': 'Truth revealed through intuition. Fair judgment guided by inner knowing.',
        'Justice-The Hierophant': 'Traditional law meets higher justice. Institutional fairness and moral truth aligned.'
    };
    
    const key1 = `${card1.name}-${card2.name}`;
    const key2 = `${card2.name}-${card1.name}`;
    
    return pairs[key1] || pairs[key2] || null;
}

// Major with Minor interpretations
function interpretMajorMinor(card1, card2) {
    const major = card1.suit === 'Major' ? card1 : card2;
    const minor = card1.suit === 'Major' ? card2 : card1;
    
    const combinations = {
        // Fool with suits
        'The Fool-Wands': 'New creative venture with passionate energy. Take the leap into a fiery new beginning. Adventure in creative pursuits.',
        'The Fool-Cups': 'New emotional journey or relationship. Trust your heart as you explore new feelings. Innocent love beginning.',
        'The Fool-Swords': 'New ideas and mental clarity guiding your fresh start. Think before you leap, but do leap. Intellectual adventure.',
        'The Fool-Pentacles': 'New financial or career opportunity. Practical adventure. Material security while taking risks.',
        
        // Magician with suits
        'The Magician-Wands': 'Powerful creative manifestation. Your passion and skill create magic. Taking inspired action successfully.',
        'The Magician-Cups': 'Manifesting love and emotional fulfillment. Using your gifts to create beautiful relationships.',
        'The Magician-Swords': 'Mental mastery and communication power. Your words and thoughts create reality. Strategic brilliance.',
        'The Magician-Pentacles': 'Material success through skill. Money-making abilities activated. Professional mastery brings wealth.',
        
        // Lovers with suits
        'The Lovers-Wands': 'Passionate romance or creative partnership. Chemistry and excitement. Dynamic relationship energy.',
        'The Lovers-Cups': 'Deep emotional connection and true love. Soulmate energy. Hearts in perfect harmony.',
        'The Lovers-Swords': 'Important relationship decision. Communication is key in love. Mental connection matters.',
        'The Lovers-Pentacles': 'Stable, committed partnership. Love meets practical security. Building together.',
        
        // Death with suits
        'Death-Wands': 'End of creative project or passion. Transformation in how you express yourself. Rebirth of purpose.',
        'Death-Cups': 'Emotional ending or relationship transformation. Letting go of old feelings. Heart healing.',
        'Death-Swords': 'Mental transformation. Old thought patterns dying. New perspective emerging.',
        'Death-Pentacles': 'Financial or career transformation. Material change. Job ending, new opportunity coming.',
        
        // Sun with suits
        'The Sun-Wands': 'Creative success and recognition. Your passion shines bright. Joyful self-expression.',
        'The Sun-Cups': 'Emotional joy and happiness. Love is radiant. Celebration of feelings.',
        'The Sun-Swords': 'Mental clarity and truth revealed. Understanding brings joy. Clear thinking wins.',
        'The Sun-Pentacles': 'Financial success and abundance. Material happiness. Career shining bright.',
        
        // Tower with suits
        'The Tower-Wands': 'Creative breakthrough through disruption. Sudden end to stagnant project. New inspiration emerges.',
        'The Tower-Cups': 'Emotional upheaval leads to clarity. Relationship shock brings truth. Hearts breaking open.',
        'The Tower-Swords': 'Mental breakthrough. False beliefs shattered. Truth emerges from chaos.',
        'The Tower-Pentacles': 'Financial or career shock leads to freedom. Material security disrupted for growth.',
        
        // Star with suits
        'The Star-Wands': 'Renewed creative inspiration. Hope returns to artistic pursuits. Dreams of expression manifesting.',
        'The Star-Cups': 'Emotional healing and renewal. Love returns after heartbreak. Wishes in relationships coming true.',
        'The Star-Swords': 'Mental clarity after confusion. New ideas and perspectives bring hope.',
        'The Star-Pentacles': 'Financial recovery and material hope. Practical dreams becoming reality.',
        
        // World with suits
        'The World-Wands': 'Creative mastery achieved. Artistic completion and recognition. Full self-expression.',
        'The World-Cups': 'Emotional fulfillment complete. Love reaches its highest form. Heart satisfied.',
        'The World-Swords': 'Mental achievement and understanding. Wisdom fully realized. Truth mastered.',
        'The World-Pentacles': 'Material success completed. Wealth and security achieved. Practical mastery.'
    };
    
    const key = `${major.name}-${minor.suit}`;
    return combinations[key] || null;
}

// Same suit interpretations
function interpretSameSuit(card1, card2) {
    if (card1.suit === 'Wands') {
        return '🔥 Strong creative and passionate energy flowing through your situation. Action, ambition, and drive dominate. Time to pursue your goals with fire and enthusiasm. This combination amplifies your personal power and ability to manifest.';
    }
    if (card1.suit === 'Cups') {
        return '💧 Deep emotional currents running through this reading. Feelings, relationships, and intuition are central. Listen to your heart and honor your emotions. This pairing speaks to matters of love, creativity, and spiritual connection.';
    }
    if (card1.suit === 'Swords') {
        return '💨 Mental activity and communication themes prominent. Thoughts, decisions, and clarity (or confusion) are key. Use your mind wisely. This combination highlights intellectual challenges and the power of clear thinking.';
    }
    if (card1.suit === 'Pentacles') {
        return '🌍 Material and practical matters highlighted. Money, career, health, and tangible results matter now. Focus on the physical realm. This pairing emphasizes building, growing, and creating lasting value.';
    }
    return null;
}

// Different suits interpretation
function interpretDifferentSuits(card1, card2) {
    const suits = [card1.suit, card2.suit].sort();
    const combo = suits.join('-');
    
    const combinations = {
        'Cups-Pentacles': '💧🌍 Heart meets practicality. Emotional desires need grounding in reality. Love and money seeking balance.',
        'Cups-Swords': '💧💨 Emotions meet intellect. Feel deeply but think clearly. Heart and mind must work together.',
        'Cups-Wands': '💧🔥 Passion meets emotion. Creative fire fueled by deep feeling. Love and inspiration unite.',
        'Pentacles-Swords': '🌍💨 Practical thinking and material focus. Mind applied to real-world problems. Strategy for success.',
        'Pentacles-Wands': '🌍🔥 Practical action and material passion. Building something real through creative energy.',
        'Swords-Wands': '💨🔥 Ideas meet action. Mental clarity driving passionate pursuit. Think fast, act faster.'
    };
    
    return combinations[combo] || 'Balanced energies from different life areas combining in your situation.';
}

// Analyze overall spread energy
function analyzeOverallEnergy(cards) {
    let majors = 0, wands = 0, cups = 0, swords = 0, pentacles = 0;
    let reversed = 0;
    
    cards.forEach(card => {
        if (card.suit === 'Major') majors++;
        else if (card.suit === 'Wands') wands++;
        else if (card.suit === 'Cups') cups++;
        else if (card.suit === 'Swords') swords++;
        else if (card.suit === 'Pentacles') pentacles++;
        
        if (card.isReversed) reversed++;
    });
    
    let energy = [];
    
    // High Major Arcana
    if (majors >= cards.length / 2) {
        energy.push('🌟 <strong>DESTINY ACTIVATED:</strong> Many Major Arcana indicate significant life events beyond your control. The universe is orchestrating major changes. Pay attention to signs and synchronicities.');
    }
    
    // Dominant suit
    if (wands > cards.length / 3) {
        energy.push('🔥 <strong>FIRE DOMINANT:</strong> Passion, creativity, and action are calling. Time to take bold steps. Your drive and ambition are your greatest assets now.');
    }
    if (cups > cards.length / 3) {
        energy.push('💧 <strong>WATER DOMINANT:</strong> Emotions and relationships take center stage. Trust your intuition. What does your heart truly want? Feel deeply.');
    }
    if (swords > cards.length / 3) {
        energy.push('💨 <strong>AIR DOMINANT:</strong> Mental clarity (or confusion) is the focus. Important decisions ahead. Think carefully but don\'t overthink. Communication matters.');
    }
    if (pentacles > cards.length / 3) {
        energy.push('🌍 <strong>EARTH DOMINANT:</strong> Practical matters need attention. Money, career, health are highlighted. Build something solid. Ground your dreams.');
    }
    
    // Many reversals
    if (reversed > cards.length / 2) {
        energy.push('⚠️ <strong>MANY REVERSALS:</strong> Blocked energy or internal challenges. Look inward for solutions. Delays or resistance present. Patience needed.');
    }
    
    return energy.length > 0 ? energy.join('<br><br>') : 'Balanced energy across all areas of life.';
}

// Analyze suit dominance
function analyzeSuitDominance(cards) {
    const suits = {Wands: 0, Cups: 0, Swords: 0, Pentacles: 0, Major: 0};
    cards.forEach(card => suits[card.suit]++);
    
    const dominant = Object.keys(suits).reduce((a, b) => 
        suits[a] > suits[b] ? a : b
    );
    
    const messages = {
        Wands: '🔥 Fire energy is strong. Focus on passion projects, creativity, and taking action. Your drive will lead you forward.',
        Cups: '💧 Water energy flows through this reading. Emotions, intuition, and relationships guide you. Trust your feelings.',
        Swords: '💨 Air energy dominates. Mental clarity, communication, and decisions are central. Think clearly and speak your truth.',
        Pentacles: '🌍 Earth energy grounds this reading. Practical matters, material concerns, and tangible results are key. Build steadily.',
        Major: '✨ Spiritual forces at work. Destiny is unfolding. Major life themes and soul lessons are active. This is significant.'
    };
    
    return {
        dominant: dominant,
        count: suits[dominant],
        message: messages[dominant]
    };
}

// Analyze elemental balance
function analyzeElements(cards) {
    const fire = cards.filter(c => c.suit === 'Wands').length;
    const water = cards.filter(c => c.suit === 'Cups').length;
    const air = cards.filter(c => c.suit === 'Swords').length;
    const earth = cards.filter(c => c.suit === 'Pentacles').length;
    
    let balance = [];
    
    if (fire === 0) balance.push('❌ <strong>NO FIRE:</strong> Lacking passion or drive. May feel unmotivated. Need to reignite enthusiasm.');
    if (water === 0) balance.push('❌ <strong>NO WATER:</strong> Disconnected from emotions. May feel cold or unfeeling. Need to reconnect with heart.');
    if (air === 0) balance.push('❌ <strong>NO AIR:</strong> Mental fog or lack of communication. Difficulty thinking clearly. Need perspective.');
    if (earth === 0) balance.push('❌ <strong>NO EARTH:</strong> Ungrounded or impractical. Lacking stability. Need to focus on tangible reality.');
    
    if (balance.length === 0) {
        return '✅ <strong>PERFECT BALANCE:</strong> All four elements present. You have passion, emotion, clarity, and practicality available. Use them wisely!';
    }
    
    return balance.join('<br>');
}

// Enhanced trajectory analysis for three-card spreads
function analyzeTrajectory(past, present, future) {
    function isPositive(card) {
        return ['Major', 'Cups', 'Wands'].includes(card.suit) || 
               card.name.includes('Ace') || 
               card.name.includes('Sun') || 
               card.name.includes('Star') || 
               card.name.includes('World');
    }
    
    // Improving trajectory
    if (isPositive(future) && !isPositive(past)) {
        return 'Your journey shows improvement and growth. Challenges from the past are transforming into opportunities. Keep moving forward with faith. The best is yet to come.';
    }
    
    // Declining trajectory
    if (!isPositive(future) && isPositive(past)) {
        return 'Warning: current path may lead to difficulties. Time to reassess and make changes now while you can. The future is not fixed - your choices matter.';
    }
    
    // Consistent positive
    if (isPositive(past) && isPositive(present) && isPositive(future)) {
        return 'You are in a blessed flow. Continue what you\'re doing. Success builds upon success. Enjoy this fortunate period and share your blessings.';
    }
    
    // Consistent challenging
    if (!isPositive(past) && !isPositive(present) && !isPositive(future)) {
        return 'You\'re in a difficult cycle that requires patience and resilience. This too shall pass. Focus on lessons being learned. Growth happens in darkness too.';
    }
    
    return 'Your path shows transformation and change. Neither purely positive nor negative, but rich with learning. Embrace the journey.';
}

// Update showTab function to handle new navigation
function showTab(tabName) {
    // Handle home navigation
    if (tabName === 'home') {
        // Show home section
        document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
        document.getElementById('home').classList.add('active');
        
        // Remove active from all nav tabs (no home tab in bottom nav)
        document.querySelectorAll('.nav-tab').forEach(btn => btn.classList.remove('active'));
    } else {
        // Hide all sections
        document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
        
        // Remove active from nav tabs
        document.querySelectorAll('.nav-tab').forEach(btn => btn.classList.remove('active'));
        
        // Show selected section
        document.getElementById(tabName).classList.add('active');
        
        // Highlight active tab if clicked from navigation
        if (event && event.target) {
            event.target.closest('.nav-tab').classList.add('active');
        }
    }
    
    // Scroll to top
    window.scrollTo({top: 0, behavior: 'smooth'});
}

// Auto-activate first tab on load
document.addEventListener('DOMContentLoaded', function() {
    // Show tarot as default active tab
    document.querySelector('.nav-tab').classList.add('active');
});

// COMPLETE KALI ORACLE SYSTEM - 44 CARDS OF FIERCE WISDOM

// Complete Kali Oracle Deck - Divine Feminine Power
const kaliOracleDeck = [
    // Kali's Aspects (10 cards)
    {id: 1, name: "Kali Ma", symbol: "🗡️", aspect: "Core", meaning: "The Dark Mother calls you to transformation. Destruction of ego and illusions. Face your shadow to find freedom.", guidance: "Embrace change fearlessly. What needs to die so you can be reborn?", keywords: "Transformation, Shadow, Liberation", mantra: "Om Krim Kalikayai Namaha", ritual: "Meditate in darkness, release what binds you"},
    
    {id: 2, name: "Durga", symbol: "🛡️", aspect: "Protection", meaning: "The Warrior Goddess protects you. You have the strength to overcome all obstacles. Stand in your power.", guidance: "Fight for what matters. You are stronger than any challenge.", keywords: "Strength, Protection, Victory", mantra: "Om Dum Durgayei Namaha", ritual: "Light a red candle, affirm your boundaries"},
    
    {id: 3, name: "Lakshmi", symbol: "💰", aspect: "Abundance", meaning: "The Goddess of prosperity blesses you. Abundance flows when you align with dharma.", guidance: "Open to receive. Prosperity is your birthright.", keywords: "Abundance, Wealth, Prosperity", mantra: "Om Shreem Mahalakshmiyei Namaha", ritual: "Offer flowers to water, welcome abundance"},
    
    {id: 4, name: "Saraswati", symbol: "📚", aspect: "Wisdom", meaning: "The Goddess of knowledge illuminates your path. Wisdom, creativity, and learning are highlighted.", guidance: "Study, create, and express your truth. Knowledge is power.", keywords: "Wisdom, Knowledge, Arts", mantra: "Om Aim Saraswatyei Namaha", ritual: "Read sacred texts, write your truth"},
    
    {id: 5, name: "Parvati", symbol: "💕", aspect: "Love", meaning: "The loving mother aspect. Devotion, nurturing, and unconditional love.", guidance: "Love deeply. Nurture yourself and others with compassion.", keywords: "Love, Devotion, Nurturing", mantra: "Om Hreem Parvatyei Namaha", ritual: "Practice self-love, nurture your inner child"},
    
    {id: 6, name: "Shakti", symbol: "⚡", aspect: "Power", meaning: "Pure divine feminine power awakens within you. Creative life force energy.", guidance: "Own your power. Your energy creates reality.", keywords: "Power, Energy, Creation", mantra: "Om Shakti Ma", ritual: "Dance wildly, feel your life force"},
    
    {id: 7, name: "Mahakali", symbol: "☠️", aspect: "Destruction", meaning: "The fierce destroyer of evil. Complete annihilation of what harms you.", guidance: "Cut away all that doesn't serve. Be ruthless with toxic patterns.", keywords: "Destruction, Endings, Purification", mantra: "Om Krim Mahakali Namaha", ritual: "Burn old photos/letters, release the past"},
    
    {id: 8, name: "Bhadrakali", symbol: "🔥", aspect: "Rage", meaning: "Righteous anger and fierce boundaries. Your rage is sacred when used wisely.", guidance: "Speak up. Set fierce boundaries. Your anger protects you.", keywords: "Boundaries, Anger, Protection", mantra: "Om Bhadrakali Namaha", ritual: "Scream into a pillow, express suppressed anger"},
    
    {id: 9, name: "Chamunda", symbol: "💀", aspect: "Death", meaning: "Death of the false self. Ego dissolution. Spiritual awakening through surrender.", guidance: "Die to your old self. Rebirth awaits on the other side.", keywords: "Death, Surrender, Awakening", ritual: "Meditate on impermanence, let go of identity"},
    
    {id: 10, name: "Tara", symbol: "⭐", aspect: "Guidance", meaning: "The guiding star. Navigation through darkness. Hope and direction.", guidance: "Trust your inner guidance. You know the way.", keywords: "Guidance, Hope, Navigation", mantra: "Om Tare Tuttare Ture Swaha", ritual: "Follow your intuition for one day completely"},
    
    // Sacred Weapons & Symbols (8 cards)
    {id: 11, name: "The Sword", symbol: "⚔️", meaning: "Cut through illusion. Discriminating wisdom. Sever toxic attachments.", guidance: "Use discernment. Cut away what no longer serves. Be decisive.", keywords: "Clarity, Discernment, Cutting", ritual: "Visualize cutting energetic cords"},
    
    {id: 12, name: "The Trident", symbol: "🔱", meaning: "Balance of three forces: creation, preservation, destruction. Trinity power.", guidance: "Balance all aspects of life. You contain multitudes.", keywords: "Balance, Trinity, Integration", ritual: "Honor your three aspects: creator, sustainer, destroyer"},
    
    {id: 13, name: "The Skull", symbol: "💀", meaning: "Memento mori - remember death. Impermanence and liberation from attachment.", guidance: "Nothing lasts forever. Live fully now. Let go of attachment.", keywords: "Impermanence, Freedom, Presence", ritual: "Contemplate death for 10 minutes daily"},
    
    {id: 14, name: "The Flame", symbol: "🔥", meaning: "Purifying fire. Transformation through burning away impurities.", guidance: "Let the fire transform you. What needs to burn away?", keywords: "Purification, Transformation, Fire", ritual: "Candle meditation, visualize burning away fears"},
    
    {id: 15, name: "The Lotus", symbol: "🌸", meaning: "Beauty rising from mud. Purity amid chaos. Enlightenment through adversity.", guidance: "Your struggles create beauty. Rise above circumstances.", keywords: "Purity, Beauty, Transcendence", ritual: "Find beauty in your pain, create art from suffering"},
    
    {id: 16, name: "The Drum", symbol: "🥁", meaning: "The cosmic rhythm. Dance to the beat of existence. Joy in destruction and creation.", guidance: "Dance with life's rhythm. Find joy in the cycles.", keywords: "Rhythm, Dance, Joy", ritual: "Drum or dance for 20 minutes"},
    
    {id: 17, name: "The Garland of Skulls", symbol: "💀💀💀", meaning: "Wearing your victories. Ego deaths conquered. Wisdom earned through trials.", guidance: "Honor your past selves. You've survived everything so far.", keywords: "Victory, Wisdom, Survival", ritual: "List all the versions of yourself you've outgrown"},
    
    {id: 18, name: "The Blood", symbol: "🩸", meaning: "Life force. Sacrifice. What you're willing to give for transformation.", guidance: "What sacrifice is required? Give fully of yourself to your path.", keywords: "Sacrifice, Life Force, Commitment", ritual: "Make a meaningful sacrifice for your growth"},
    
    // Tantric Wisdom (8 cards)
    {id: 19, name: "Embrace Your Shadow", symbol: "🌑", meaning: "Your darkness is not your enemy. Integration of all parts leads to wholeness.", guidance: "Look at what you've been avoiding. Your shadow holds power.", keywords: "Shadow Work, Integration, Wholeness", ritual: "Journal about your denied aspects"},
    
    {id: 20, name: "Divine Rage", symbol: "😤", meaning: "Your anger is sacred. Use it to protect and transform, not destroy.", guidance: "Channel your rage into positive change. Anger can fuel revolution.", keywords: "Sacred Anger, Transformation, Power", ritual: "Express anger through fierce movement"},
    
    {id: 21, name: "Radical Acceptance", symbol: "🙏", meaning: "Accept everything exactly as it is. Resistance creates suffering.", guidance: "Stop fighting reality. Acceptance is the first step to change.", keywords: "Acceptance, Surrender, Peace", ritual: "Practice saying 'yes' to what is"},
    
    {id: 22, name: "Fierce Compassion", symbol: "💜", meaning: "Sometimes love must be fierce. True compassion isn't always soft.", guidance: "Love fiercely. Sometimes the kindest thing is the hardest truth.", keywords: "Fierce Love, Truth, Compassion", ritual: "Speak difficult truths with love"},
    
    {id: 23, name: "Death Before Rebirth", symbol: "🦋", meaning: "You must die to be reborn. The caterpillar must dissolve completely.", guidance: "Trust the void. Dissolution precedes transformation.", keywords: "Death, Rebirth, Transformation", ritual: "Symbolic funeral for old self"},
    
    {id: 24, name: "Kundalini Rising", symbol: "🐍", meaning: "Life force energy awakening. Spiritual power rising through your being.", guidance: "Your spiritual power is awakening. Honor this sacred process.", keywords: "Awakening, Energy, Kundalini", ritual: "Breathwork and spinal movements"},
    
    {id: 25, name: "The Dance of Shiva", symbol: "💃", meaning: "Creation and destruction dance together. Life is movement and change.", guidance: "Dance with change. Creation and destruction are one.", keywords: "Dance, Change, Flow", ritual: "Dance the cycle of birth, life, death"},
    
    {id: 26, name: "Tantric Union", symbol: "☯️", meaning: "Integration of opposites. Sacred union within and without.", guidance: "Unite your inner masculine and feminine. Become whole.", keywords: "Union, Integration, Wholeness", ritual: "Visualize integrating your opposites"},
    
    // Spiritual Lessons (10 cards)
    {id: 27, name: "Surrender Control", symbol: "🕉️", meaning: "Your need for control is an illusion. True power comes from surrender.", guidance: "Let go. Flow with life instead of forcing outcomes.", keywords: "Surrender, Flow, Trust", ritual: "Practice letting others lead for a day"},
    
    {id: 28, name: "Face Your Fear", symbol: "😱", meaning: "Fear is the guardian of your growth. Face it to claim your power.", guidance: "Walk toward what scares you. Courage isn't absence of fear.", keywords: "Courage, Fear, Growth", ritual: "Do one thing that scares you daily"},
    
    {id: 29, name: "Burn the Past", symbol: "🔥", meaning: "Release what was. The past is dead. Don't carry corpses.", guidance: "Set fire to old stories. Free yourself from history.", keywords: "Release, Fire, Freedom", ritual: "Burn something representing your past"},
    
    {id: 30, name: "Radical Truth", symbol: "💎", meaning: "Speak your truth even when it shakes. Authenticity is liberation.", guidance: "Stop hiding. Your truth will set you free.", keywords: "Truth, Authenticity, Freedom", ritual: "Speak one difficult truth daily"},
    
    {id: 31, name: "Sacred Solitude", symbol: "🧘", meaning: "You must walk alone sometimes. Solitude reveals your true self.", guidance: "Embrace being alone. You are complete unto yourself.", keywords: "Solitude, Self, Meditation", ritual: "Spend 24 hours in complete solitude"},
    
    {id: 32, name: "Wild Woman", symbol: "🐺", meaning: "Reclaim your wild nature. Civilization has tamed you too much.", guidance: "Unleash your primal self. You are not meant to be tame.", keywords: "Wild, Primal, Freedom", ritual: "Howl at the moon, run barefoot"},
    
    {id: 33, name: "The Void", symbol: "⚫", meaning: "Emptiness is not nothing. The void is pregnant with possibility.", guidance: "Rest in emptiness. All creation emerges from the void.", keywords: "Void, Emptiness, Potential", ritual: "Meditate on nothingness for 30 minutes"},
    
    {id: 34, name: "Sacred Rebellion", symbol: "✊", meaning: "Rebel against what constrains your spirit. Liberation through defiance.", guidance: "Break the rules that cage you. True spirituality is rebellious.", keywords: "Rebellion, Freedom, Liberation", ritual: "Break one limiting rule or belief"},
    
    {id: 35, name: "Divine Timing", symbol: "⏰", meaning: "Everything unfolds in perfect time. Your impatience creates suffering.", guidance: "Trust the timing. The universe knows better than your ego.", keywords: "Timing, Trust, Patience", ritual: "Practice patience in all things"},
    
    {id: 36, name: "Spiritual Warrior", symbol: "🗡️🛡️", meaning: "Fight for your soul. Spiritual path requires courage and strength.", guidance: "Be a warrior for your truth. Fight for what matters.", keywords: "Warrior, Courage, Strength", ritual: "Define what you'll fight for"},
    
    // Blessings & Outcomes (8 cards)
    {id: 37, name: "Liberation Achieved", symbol: "🕊️", meaning: "Freedom attained. You've broken free from bondage. Celebrate your liberation.", guidance: "You are free. Enjoy the fruits of your spiritual work.", keywords: "Liberation, Freedom, Victory", ritual: "Celebrate your freedom with wild joy"},
    
    {id: 38, name: "Spiritual Awakening", symbol: "✨", meaning: "Consciousness expanding. You're seeing truth for the first time.", guidance: "You're waking up. Don't go back to sleep.", keywords: "Awakening, Consciousness, Truth", ritual: "Share your awakening insights with others"},
    
    {id: 39, name: "Divine Protection", symbol: "🛡️✨", meaning: "You are protected by divine forces. Walk fearlessly.", guidance: "Trust you're protected. The Goddess shields you.", keywords: "Protection, Safety, Trust", ritual: "Visualize Kali's protective energy around you"},
    
    {id: 40, name: "Miraculous Healing", symbol: "🌟", meaning: "Deep wounds are healing. Transformation is occurring at cellular level.", guidance: "Healing is happening. Trust the process.", keywords: "Healing, Transformation, Renewal", ritual: "Send healing energy to your deepest wound"},
    
    {id: 41, name: "Sacred Purpose Revealed", symbol: "🎯", meaning: "Your dharma is clear. You know why you're here.", guidance: "Live your purpose. Your path is illuminated.", keywords: "Purpose, Dharma, Clarity", ritual: "Write your sacred purpose and commit to it"},
    
    {id: 42, name: "Shakti Activated", symbol: "⚡💜", meaning: "Your divine feminine power is fully awakened and flowing.", guidance: "You are powerful beyond measure. Use this wisely.", keywords: "Power, Activation, Shakti", ritual: "Feel and direct your life force energy"},
    
    {id: 43, name: "Complete Transformation", symbol: "🦋✨", meaning: "You are not who you were. Complete metamorphosis achieved.", guidance: "Celebrate your transformation. You're reborn.", keywords: "Transformation, Rebirth, Success", ritual: "Ceremonially welcome your new self"},
    
    {id: 44, name: "Kali's Blessing", symbol: "🙏✨", meaning: "The Dark Mother blesses you. Her grace flows through destruction and creation.", guidance: "You are blessed. Walk your path with courage and trust.", keywords: "Blessing, Grace, Divine Love", ritual: "Offer gratitude to Kali for her fierce love"}
];

// Kali Oracle Functions
function drawKaliCards() {
    const spreadType = document.getElementById('kali-spread').value;
    
    // Show Kali shuffle animation
    showKaliShuffleAnimation(() => {
        createKaliSpread(spreadType);
    });
}

function showKaliShuffleAnimation(callback) {
    const shuffleArea = document.getElementById('kali-shuffle');
    shuffleArea.innerHTML = '';
    shuffleArea.style.display = 'flex';
    shuffleArea.style.flexWrap = 'wrap';
    shuffleArea.style.justifyContent = 'center';
    shuffleArea.style.gap = '10px';
    shuffleArea.style.padding = '30px 20px';
    shuffleArea.style.minHeight = '200px';
    shuffleArea.style.position = 'relative';
    
    // Create 8 Kali cards that shuffle
    for (let i = 0; i < 8; i++) {
        const cardBack = document.createElement('div');
        cardBack.className = 'kali-shuffle-card';
        cardBack.style.cssText = `
            width: 70px;
            height: 100px;
            background: linear-gradient(135deg, #1a0d1a 0%, #2d1b2d 100%);
            border: 2px solid #8B008B;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            animation: kali-shuffle 1.8s ease-in-out infinite;
            animation-delay: ${i * 0.15}s;
            box-shadow: 0 4px 15px rgba(139, 0, 139, 0.4);
            color: #DC143C;
        `;
        cardBack.textContent = '🗡️';
        shuffleArea.appendChild(cardBack);
    }
    
    // Add Kali animation CSS if not exists
    if (!document.getElementById('kali-shuffle-style')) {
        const style = document.createElement('style');
        style.id = 'kali-shuffle-style';
        style.textContent = `
            @keyframes kali-shuffle {
                0%, 100% { transform: translateY(0) rotate(0deg); opacity: 0.9; }
                50% { transform: translateY(-12px) rotate(${Math.random() * 8 - 4}deg); opacity: 1; }
            }
        `;
        document.head.appendChild(style);
    }
    
    // Show shuffling message
    const message = document.createElement('div');
    message.textContent = '🗡️ Channeling Kali\'s fierce wisdom...';
    message.style.cssText = 'width: 100%; text-align: center; font-size: 16px; color: #8B008B; margin-top: 20px; font-weight: 600;';
    shuffleArea.appendChild(message);
    
    // After 2.5 seconds, hide and call callback
    setTimeout(() => {
        shuffleArea.style.display = 'none';
        callback();
    }, 2500);
}

function createKaliSpread(spreadType) {
    // Shuffle Kali oracle deck
    const shuffledDeck = [...kaliOracleDeck].sort(() => Math.random() - 0.5);
    
    let html = '';
    
    switch(spreadType) {
        case 'daily':
            html = createDailyKaliMessage(shuffledDeck[0]);
            break;
        case 'shadow':
            html = createShadowWorkSpread(shuffledDeck.slice(0, 3));
            break;
        case 'transformation':
            html = createTransformationSpread(shuffledDeck.slice(0, 5));
            break;
        case 'warrior':
            html = createWarriorPathSpread(shuffledDeck.slice(0, 7));
            break;
        default:
            html = createDailyKaliMessage(shuffledDeck[0]);
    }
    
    document.getElementById('kali-result').classList.remove('hidden');
    document.getElementById('kali-output').innerHTML = html;
    document.getElementById('kali-result').scrollIntoView({behavior: 'smooth', block: 'start'});
}

function createDailyKaliMessage(card) {
    return `
        <h3 class="text-center mb-20">🗡️ Daily Kali Message</h3>
        <div class="kali-card">
            <div class="aspect">Aspect: ${card.aspect || 'Divine Feminine'}</div>
            <div class="symbol">${card.symbol}</div>
            <div class="name">${card.name}</div>
            <div class="meaning">${card.meaning}</div>
            <div class="guidance">${card.guidance}</div>
            <div class="keywords">Keywords: ${card.keywords}</div>
        </div>
        
        <div style="background: linear-gradient(135deg, #2D1B2D 0%, #4B0F4B 100%); padding: 20px; border-radius: 16px; margin: 20px 0; border-left: 6px solid #DC143C; color: white;">
            <h3 style="color: #FF69B4; margin-bottom: 12px; font-size: 18px;">🔥 Kali's Fire</h3>
            <p style="color: #DDA0DD; line-height: 1.6; margin-bottom: 8px;"><strong>Sacred Mantra:</strong> ${card.mantra || 'Om Krim Kalikayai Namaha'}</p>
            <p style="color: #DDA0DD; line-height: 1.6; margin: 0;"><strong>Ritual Action:</strong> ${card.ritual || 'Honor the fierce wisdom within you'}</p>
        </div>
        
        <div style="background: linear-gradient(135deg, #1A0D1A 0%, #8B008B 100%); padding: 20px; border-radius: 16px; margin: 20px 0; border-left: 6px solid #FF1493; color: white;">
            <h3 style="color: #FF1493; margin-bottom: 12px; font-size: 18px;">⚡ Fierce Guidance</h3>
            <p style="color: #F8F8FF; line-height: 1.6; margin-bottom: 8px;">Kali does not come gently. She arrives in storms to clear what blocks your power. Embrace her fierce love.</p>
            <p style="color: #F8F8FF; line-height: 1.6; margin: 0;">What must you destroy today to create space for your authentic self?</p>
        </div>
    `;
}

function createShadowWorkSpread(cards) {
    const positions = ['Shadow', 'Lesson', 'Integration'];
    
    let cardsHtml = '<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin: 24px 0;">';
    
    cards.forEach((card, index) => {
        const bgColors = [
            'linear-gradient(135deg, #1a0d1a 0%, #2d1b2d 100%)',
            'linear-gradient(135deg, #4B0082 0%, #8B008B 100%)', 
            'linear-gradient(135deg, #8B008B 0%, #DC143C 100%)'
        ];
        
        cardsHtml += `
            <div style="text-align: center; padding: 20px; background: ${bgColors[index]}; border-radius: 16px; color: white; border: 2px solid ${index === 0 ? '#DC143C' : index === 1 ? '#8B008B' : '#FF1493'};">
                <p style="font-weight: 600; margin-bottom: 12px; color: #DDA0DD; font-size: 14px;">${positions[index]}</p>
                <div style="font-size: 50px; margin: 16px 0;">${card.symbol}</div>
                <p style="font-size: 16px; font-weight: 600; margin: 12px 0; color: #FF69B4;">${card.name}</p>
                <p style="font-size: 13px; opacity: 0.9; line-height: 1.4;">${card.guidance}</p>
            </div>
        `;
    });
    
    cardsHtml += '</div>';
    
    return `
        <h3 class="text-center mb-20">🌑 Shadow Work Spread</h3>
        ${cardsHtml}
        
        <div style="background: linear-gradient(135deg, #2D1B2D 0%, #4B0082 100%); padding: 20px; border-radius: 16px; margin: 20px 0; border-left: 6px solid #DC143C; color: white;">
            <h3 style="color: #FF1493; margin-bottom: 12px; font-size: 20px;">🗡️ Shadow Integration</h3>
            <p style="color: #DDA0DD; line-height: 1.6; margin-bottom: 12px;"><strong>Your Shadow:</strong> ${cards[0].meaning}</p>
            <p style="color: #DDA0DD; line-height: 1.6; margin-bottom: 12px;"><strong>The Lesson:</strong> ${cards[1].meaning}</p>
            <p style="color: #DDA0DD; line-height: 1.6; margin: 0;"><strong>Integration Path:</strong> ${cards[2].meaning}</p>
        </div>
        
        <div style="background: linear-gradient(135deg, #1A0D1A 0%, #8B008B 100%); padding: 20px; border-radius: 16px; margin: 20px 0; border-left: 6px solid #FF69B4; color: white;">
            <h3 style="color: #FF69B4; margin-bottom: 12px; font-size: 20px;">💀 Kali's Shadow Teaching</h3>
            <p style="color: #F8F8FF; line-height: 1.6; margin: 0;">Your shadow is not your enemy - it is the compost from which your power grows. Kali teaches us that what we reject in ourselves holds our greatest gifts. Embrace your darkness to find your light.</p>
        </div>
    `;
}

function createTransformationSpread(cards) {
    const positions = ['What Dies', 'What is Born', 'Catalyst', 'Support', 'Outcome'];
    
    let cardsHtml = '<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 12px; margin: 20px 0;">';
    
    cards.forEach((card, index) => {
        cardsHtml += `
            <div style="text-align: center; padding: 16px; background: linear-gradient(135deg, #1a0d1a 0%, #2d1b2d 100%); border-radius: 12px; color: white; border: 2px solid #8B008B;">
                <p style="font-size: 11px; font-weight: 600; margin-bottom: 8px; color: #DDA0DD;">${positions[index]}</p>
                <div style="font-size: 40px; margin: 12px 0;">${card.symbol}</div>
                <p style="font-size: 12px; font-weight: 600; margin: 8px 0; color: #FF69B4;">${card.name}</p>
                <p style="font-size: 10px; color: #F8F8FF; margin-top: 6px;">${card.keywords}</p>
            </div>
        `;
    });
    
    cardsHtml += '</div>';
    
    return `
        <h3 class="text-center mb-20">🦋 Transformation Spread</h3>
        ${cardsHtml}
        
        <div style="background: linear-gradient(135deg, #2D1B2D 0%, #8B008B 100%); padding: 20px; border-radius: 16px; margin: 20px 0; border-left: 6px solid #DC143C; color: white;">
            <h3 style="color: #FF1493; margin-bottom: 12px; font-size: 20px;">🔥 Transformation Journey</h3>
            <p style="color: #DDA0DD; line-height: 1.6; margin-bottom: 12px;">This spread reveals your complete metamorphosis cycle. Like the butterfly emerging from its cocoon, you too must dissolve before you can fly.</p>
            <p style="color: #DDA0DD; line-height: 1.6; margin: 0;"><strong>Key Focus:</strong> The catalyst (${cards[2].name}) is your agent of change. Embrace this energy fully to complete your transformation.</p>
        </div>
        
        <div style="background: linear-gradient(135deg, #1A0D1A 0%, #4B0082 100%); padding: 20px; border-radius: 16px; margin: 20px 0; border-left: 6px solid #FF69B4; color: white;">
            <h3 style="color: #FF69B4; margin-bottom: 12px; font-size: 20px;">⚡ Death & Rebirth</h3>
            <p style="color: #F8F8FF; line-height: 1.6;">Release what dies to birth what emerges. Your support and catalyst will guide this sacred transformation. Trust Kali's process of creative destruction.</p>
        </div>
    `;
}

function createWarriorPathSpread(cards) {
    const positions = ['Challenge', 'Strength', 'Weapon', 'Ally', 'Obstacle', 'Victory', 'Blessing'];
    
    let cardsHtml = '<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 10px; margin: 20px 0;">';
    
    cards.forEach((card, index) => {
        const colors = ['#DC143C', '#8B008B', '#FF1493', '#DA70D6', '#9932CC', '#FFD700', '#FF69B4'];
        
        cardsHtml += `
            <div style="text-align: center; padding: 14px; background: linear-gradient(135deg, #1a0d1a 0%, #2d1b2d 100%); border-radius: 12px; color: white; border: 2px solid ${colors[index]};">
                <p style="font-weight: 600; margin-bottom: 8px; color: #DDA0DD; font-size: 11px;">${positions[index]}</p>
                <div style="font-size: 35px; margin: 10px 0;">${card.symbol}</div>
                <p style="font-size: 11px; font-weight: 600; margin: 6px 0; color: #FF69B4;">${card.name}</p>
                <p style="font-size: 9px; opacity: 0.8; color: #F8F8FF;">${card.keywords}</p>
            </div>
        `;
    });
    
    cardsHtml += '</div>';
    
    return `
        <h3 class="text-center mb-20">⚔️ Warrior Path Spread</h3>
        ${cardsHtml}
        
        <div style="background: linear-gradient(135deg, #2D1B2D 0%, #8B008B 100%); padding: 20px; border-radius: 16px; margin: 20px 0; border-left: 6px solid #DC143C; color: white;">
            <h3 style="color: #FF1493; margin-bottom: 12px; font-size: 20px;">⚔️ Warrior's Journey</h3>
            <p style="color: #DDA0DD; line-height: 1.6; margin-bottom: 12px;"><strong>Your Battle:</strong> ${cards[0].guidance}</p>
            <p style="color: #DDA0DD; line-height: 1.6; margin-bottom: 12px;"><strong>Your Weapon:</strong> ${cards[2].guidance}</p>
            <p style="color: #DDA0DD; line-height: 1.6; margin: 0;"><strong>Your Victory:</strong> ${cards[5].guidance}</p>
        </div>
        
        <div style="background: linear-gradient(135deg, #1A0D1A 0%, #4B0082 100%); padding: 20px; border-radius: 16px; margin: 20px 0; border-left: 6px solid #FF69B4; color: white;">
            <h3 style="color: #FF69B4; margin-bottom: 12px; font-size: 20px;">🗡️ Kali's Warrior Blessing</h3>
            <p style="color: #F8F8FF; line-height: 1.6; margin: 0;">You are a spiritual warrior in Kali's army. Your battles are sacred - you fight not just for yourself, but for all who will come after. Your courage liberates others. Fight with honor, fight with heart, fight with the Divine Mother's blessing.</p>
        </div>
    `;
}

console.log('✨ Mystic Divination App with Kali Oracle - Tarot, Numerology, Moonology & Fierce Divine Feminine Wisdom Ready');
</script>

</body>
</html>


















































































    </script>
</body>
</html>